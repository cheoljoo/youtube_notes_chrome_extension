var FirebaseBundle=(()=>{var Wc=Object.defineProperty;var lI=Object.getOwnPropertyDescriptor;var hI=Object.getOwnPropertyNames;var dI=Object.prototype.hasOwnProperty;var Vp=(n,e)=>{for(var t in e)Wc(n,t,{get:e[t],enumerable:!0})},fI=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of hI(e))!dI.call(n,i)&&i!==t&&Wc(n,i,{get:()=>e[i],enumerable:!(r=lI(e,i))||r.enumerable});return n};var pI=n=>fI(Wc({},"__esModule",{value:!0}),n);var dC={};Vp(dC,{default:()=>hC});var qp=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},mI=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],a=n[t++],c=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},jp={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,a=o?n[i+1]:0,c=i+2<n.length,u=c?n[i+2]:0,l=s>>2,h=(s&3)<<4|a>>4,d=(a&15)<<2|u>>6,m=u&63;c||(m=64,o||(d=64)),r.push(t[l],t[h],t[d],t[m])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(qp(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):mI(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;let u=i<n.length?t[n.charAt(i)]:64;++i;let h=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||a==null||u==null||h==null)throw new Qc;let d=s<<2|a>>4;if(r.push(d),u!==64){let m=a<<4&240|u>>2;if(r.push(m),h!==64){let w=u<<6&192|h;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},Qc=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},gI=function(n){let e=qp(n);return jp.encodeByteArray(e,!0)},vi=function(n){return gI(n).replace(/\./g,"")},Jc=function(n){try{return jp.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function wi(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:let t=e;return new Date(t.getTime());case Object:n===void 0&&(n={});break;case Array:n=[];break;default:return e}for(let t in e)!e.hasOwnProperty(t)||!yI(t)||(n[t]=wi(n[t],e[t]));return n}function yI(n){return n!=="__proto__"}function vI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var wI=()=>vI().__FIREBASE_DEFAULTS__,_I=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},II=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Jc(n[1]);return e&&JSON.parse(e)},Xc=()=>{try{return wI()||_I()||II()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}};var Zc=()=>{var n;return(n=Xc())===null||n===void 0?void 0:n.config},zp=n=>{var e;return(e=Xc())===null||e===void 0?void 0:e[`_${n}`]};var to=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Gp(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[vi(JSON.stringify(t)),vi(JSON.stringify(o)),""].join(".")}function z(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function $p(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(z())}function no(){var n;let e=(n=Xc())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Kp(){return typeof self=="object"&&self.self===self}function ro(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function _i(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function io(){let n=z();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Wp(){return!no()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function $t(){try{return typeof indexedDB=="object"}catch{return!1}}function Hp(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var EI="FirebaseError",oe=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=EI,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ze.prototype.create)}},ze=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?TI(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new oe(i,a,r)}};function TI(n,e){return n.replace(bI,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var bI=/\{\$([^}]+)}/g;function eu(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Qp(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function _r(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(Bp(s)&&Bp(o)){if(!_r(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Bp(n){return n!==null&&typeof n=="object"}function Nn(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Kt(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Ir(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function so(n,e){let t=new Yc(n,e);return t.subscribe.bind(t)}var Yc=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");SI(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Hc),i.error===void 0&&(i.error=Hc),i.complete===void 0&&(i.complete=Hc);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function SI(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Hc(){}var pC=4*60*60*1e3;function N(n){return n&&n._delegate?n._delegate:n}var me=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var kn="[DEFAULT]";var tu=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new to;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(CI(e))try{this.getOrInitializeService({instanceIdentifier:kn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=kn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=kn){return this.instances.has(e)}getOptions(e=kn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:AI(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=kn){return this.component?this.component.multipleInstances?e:kn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function AI(n){return n===kn?void 0:n}function CI(n){return n.instantiationMode==="EAGER"}var oo=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new tu(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var wu={};Vp(wu,{FirebaseError:()=>oe,SDK_VERSION:()=>Je,_DEFAULT_ENTRY_NAME:()=>lt,_addComponent:()=>Ti,_addOrOverwriteComponent:()=>pu,_apps:()=>Wt,_clearComponents:()=>fE,_components:()=>Ii,_getProvider:()=>co,_registerComponent:()=>Ye,_removeServiceInstance:()=>lm,deleteApp:()=>gu,getApp:()=>mu,getApps:()=>mE,initializeApp:()=>uo,onLog:()=>yu,registerVersion:()=>Le,setLogLevel:()=>vu});var nu=[],P;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(P||(P={}));var Yp={debug:P.DEBUG,verbose:P.VERBOSE,info:P.INFO,warn:P.WARN,error:P.ERROR,silent:P.SILENT},NI=P.INFO,kI={[P.DEBUG]:"log",[P.VERBOSE]:"log",[P.INFO]:"info",[P.WARN]:"warn",[P.ERROR]:"error"},DI=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=kI[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},ct=class{constructor(e){this.name=e,this._logLevel=NI,this._logHandler=DI,this._userLogHandler=null,nu.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in P))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Yp[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,P.DEBUG,...e),this._logHandler(this,P.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,P.VERBOSE,...e),this._logHandler(this,P.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,P.INFO,...e),this._logHandler(this,P.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,P.WARN,...e),this._logHandler(this,P.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,P.ERROR,...e),this._logHandler(this,P.ERROR,...e)}};function Jp(n){nu.forEach(e=>{e.setLogLevel(n)})}function Xp(n,e){for(let t of nu){let r=null;e&&e.level&&(r=Yp[e.level]),n===null?t.userLogHandler=null:t.userLogHandler=(i,s,...o)=>{let a=o.map(c=>{if(c==null)return null;if(typeof c=="string")return c;if(typeof c=="number"||typeof c=="boolean")return c.toString();if(c instanceof Error)return c.message;try{return JSON.stringify(c)}catch{return null}}).filter(c=>c).join(" ");s>=(r??i.logLevel)&&n({level:P[s].toLowerCase(),message:a,args:o,type:i.name})}}}var RI=(n,e)=>e.some(t=>n instanceof t),Zp,em;function xI(){return Zp||(Zp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function PI(){return em||(em=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var tm=new WeakMap,iu=new WeakMap,nm=new WeakMap,ru=new WeakMap,ou=new WeakMap;function OI(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(ut(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&tm.set(t,n)}).catch(()=>{}),ou.set(e,n),e}function LI(n){if(iu.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});iu.set(n,e)}var su={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return iu.get(n);if(e==="objectStoreNames")return n.objectStoreNames||nm.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ut(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function rm(n){su=n(su)}function MI(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(ao(this),e,...t);return nm.set(r,e.sort?e.sort():[e]),ut(r)}:PI().includes(n)?function(...e){return n.apply(ao(this),e),ut(tm.get(this))}:function(...e){return ut(n.apply(ao(this),e))}}function FI(n){return typeof n=="function"?MI(n):(n instanceof IDBTransaction&&LI(n),RI(n,xI())?new Proxy(n,su):n)}function ut(n){if(n instanceof IDBRequest)return OI(n);if(ru.has(n))return ru.get(n);let e=FI(n);return e!==n&&(ru.set(n,e),ou.set(e,n)),e}var ao=n=>ou.get(n);function sm(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),a=ut(o);return r&&o.addEventListener("upgradeneeded",c=>{r(ut(o.result),c.oldVersion,c.newVersion,ut(o.transaction),c)}),t&&o.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),a.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",u=>i(u.oldVersion,u.newVersion,u))}).catch(()=>{}),a}var UI=["get","getKey","getAll","getAllKeys","count"],VI=["put","add","delete","clear"],au=new Map;function im(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(au.get(e))return au.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=VI.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||UI.includes(t)))return;let s=async function(o,...a){let c=this.transaction(o,i?"readwrite":"readonly"),u=c.store;return r&&(u=u.index(a.shift())),(await Promise.all([u[t](...a),i&&c.done]))[0]};return au.set(e,s),s}rm(n=>({...n,get:(e,t,r)=>im(e,t)||n.get(e,t,r),has:(e,t)=>!!im(e,t)||n.has(e,t)}));var uu=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(BI(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function BI(n){let e=n.getComponent();return e?.type==="VERSION"}var lu="@firebase/app",om="0.9.13";var Dn=new ct("@firebase/app"),qI="@firebase/app-compat",jI="@firebase/analytics-compat",zI="@firebase/analytics",GI="@firebase/app-check-compat",$I="@firebase/app-check",KI="@firebase/auth",WI="@firebase/auth-compat",HI="@firebase/database",QI="@firebase/database-compat",YI="@firebase/functions",JI="@firebase/functions-compat",XI="@firebase/installations",ZI="@firebase/installations-compat",eE="@firebase/messaging",tE="@firebase/messaging-compat",nE="@firebase/performance",rE="@firebase/performance-compat",iE="@firebase/remote-config",sE="@firebase/remote-config-compat",oE="@firebase/storage",aE="@firebase/storage-compat",cE="@firebase/firestore",uE="@firebase/firestore-compat",lE="firebase",hE="9.23.0";var lt="[DEFAULT]",dE={[lu]:"fire-core",[qI]:"fire-core-compat",[zI]:"fire-analytics",[jI]:"fire-analytics-compat",[$I]:"fire-app-check",[GI]:"fire-app-check-compat",[KI]:"fire-auth",[WI]:"fire-auth-compat",[HI]:"fire-rtdb",[QI]:"fire-rtdb-compat",[YI]:"fire-fn",[JI]:"fire-fn-compat",[XI]:"fire-iid",[ZI]:"fire-iid-compat",[eE]:"fire-fcm",[tE]:"fire-fcm-compat",[nE]:"fire-perf",[rE]:"fire-perf-compat",[iE]:"fire-rc",[sE]:"fire-rc-compat",[oE]:"fire-gcs",[aE]:"fire-gcs-compat",[cE]:"fire-fst",[uE]:"fire-fst-compat","fire-js":"fire-js",[lE]:"fire-js-all"};var Wt=new Map,Ii=new Map;function Ti(n,e){try{n.container.addComponent(e)}catch(t){Dn.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function pu(n,e){n.container.addOrOverwriteComponent(e)}function Ye(n){let e=n.name;if(Ii.has(e))return Dn.debug(`There were multiple attempts to register component ${e}.`),!1;Ii.set(e,n);for(let t of Wt.values())Ti(t,n);return!0}function co(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function lm(n,e,t=lt){co(n,e).clearInstance(t)}function fE(){Ii.clear()}var pE={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},Rt=new ze("app","Firebase",pE);var hu=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new me("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Rt.create("app-deleted",{appName:this._name})}};var Je=hE;function uo(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:lt,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw Rt.create("bad-app-name",{appName:String(i)});if(t||(t=Zc()),!t)throw Rt.create("no-options");let s=Wt.get(i);if(s){if(_r(t,s.options)&&_r(r,s.config))return s;throw Rt.create("duplicate-app",{appName:i})}let o=new oo(i);for(let c of Ii.values())o.addComponent(c);let a=new hu(t,r,o);return Wt.set(i,a),a}function mu(n=lt){let e=Wt.get(n);if(!e&&n===lt&&Zc())return uo();if(!e)throw Rt.create("no-app",{appName:n});return e}function mE(){return Array.from(Wt.values())}async function gu(n){let e=n.name;Wt.has(e)&&(Wt.delete(e),await Promise.all(n.container.getProviders().map(t=>t.delete())),n.isDeleted=!0)}function Le(n,e,t){var r;let i=(r=dE[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){let a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Dn.warn(a.join(" "));return}Ye(new me(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}function yu(n,e){if(n!==null&&typeof n!="function")throw Rt.create("invalid-log-argument");Xp(n,e)}function vu(n){Jp(n)}var gE="firebase-heartbeat-database",yE=1,Ei="firebase-heartbeat-store",cu=null;function hm(){return cu||(cu=sm(gE,yE,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(Ei)}}}).catch(n=>{throw Rt.create("idb-open",{originalErrorMessage:n.message})})),cu}async function vE(n){try{return await(await hm()).transaction(Ei).objectStore(Ei).get(dm(n))}catch(e){if(e instanceof oe)Dn.warn(e.message);else{let t=Rt.create("idb-get",{originalErrorMessage:e?.message});Dn.warn(t.message)}}}async function am(n,e){try{let r=(await hm()).transaction(Ei,"readwrite");await r.objectStore(Ei).put(e,dm(n)),await r.done}catch(t){if(t instanceof oe)Dn.warn(t.message);else{let r=Rt.create("idb-set",{originalErrorMessage:t?.message});Dn.warn(r.message)}}}function dm(n){return`${n.name}!${n.options.appId}`}var wE=1024,_E=30*24*60*60*1e3,du=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new fu(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=cm();if(this._heartbeatsCache===null&&(this._heartbeatsCache=await this._heartbeatsCachePromise),!(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r)))return this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(i=>{let s=new Date(i.date).valueOf();return Date.now()-s<=_E}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache===null||this._heartbeatsCache.heartbeats.length===0)return"";let e=cm(),{heartbeatsToSend:t,unsentEntries:r}=IE(this._heartbeatsCache.heartbeats),i=vi(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}};function cm(){return new Date().toISOString().substring(0,10)}function IE(n,e=wE){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),um(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),um(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var fu=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return $t()?Hp().then(()=>!0).catch(()=>!1):!1}async read(){return await this._canUseIndexedDBPromise?await vE(this.app)||{heartbeats:[]}:{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return am(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){let i=await this.read();return am(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}};function um(n){return vi(JSON.stringify({version:2,heartbeats:n})).length}function EE(n){Ye(new me("platform-logger",e=>new uu(e),"PRIVATE")),Ye(new me("heartbeat",e=>new du(e),"PRIVATE")),Le(lu,om,n),Le(lu,om,"esm2017"),Le("fire-js","")}EE("");var _u=class{constructor(e,t){this._delegate=e,this.firebase=t,Ti(e,new me("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),gu(this._delegate)))}_getService(e,t=lt){var r;this._delegate.checkDestroyed();let i=this._delegate.container.getProvider(e);return!i.isInitialized()&&((r=i.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&i.initialize(),i.getImmediate({identifier:t})}_removeServiceInstance(e,t=lt){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){Ti(this._delegate,e)}_addOrOverwriteComponent(e){pu(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}};var TE={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},fm=new ze("app-compat","Firebase",TE);function bE(n){let e={},t={__esModule:!0,initializeApp:s,app:i,registerVersion:Le,setLogLevel:vu,onLog:yu,apps:null,SDK_VERSION:Je,INTERNAL:{registerComponent:a,removeApp:r,useAsService:c,modularAPIs:wu}};t.default=t,Object.defineProperty(t,"apps",{get:o});function r(u){delete e[u]}function i(u){if(u=u||lt,!eu(e,u))throw fm.create("no-app",{appName:u});return e[u]}i.App=n;function s(u,l={}){let h=uo(u,l);if(eu(e,h.name))return e[h.name];let d=new n(h,t);return e[h.name]=d,d}function o(){return Object.keys(e).map(u=>e[u])}function a(u){let l=u.name,h=l.replace("-compat","");if(Ye(u)&&u.type==="PUBLIC"){let d=(m=i())=>{if(typeof m[h]!="function")throw fm.create("invalid-app-argument",{appName:l});return m[h]()};u.serviceProps!==void 0&&wi(d,u.serviceProps),t[h]=d,n.prototype[h]=function(...m){return this._getService.bind(this,l).apply(this,u.multipleInstances?m:[])}}return u.type==="PUBLIC"?t[h]:null}function c(u,l){return l==="serverAuth"?null:l}return t}function mm(){let n=bE(_u);n.INTERNAL=Object.assign(Object.assign({},n.INTERNAL),{createFirebaseNamespace:mm,extendNamespace:e,createSubscribe:so,ErrorFactory:ze,deepExtend:wi});function e(t){wi(n,t)}return n}var SE=mm();var pm=new ct("@firebase/app-compat"),AE="@firebase/app-compat",CE="0.2.13";function NE(n){Le(AE,CE,n)}if(Kp()&&self.firebase!==void 0){pm.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);let n=self.firebase.SDK_VERSION;n&&n.indexOf("LITE")>=0&&pm.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}var Ve=SE;NE();var kE="firebase",DE="9.23.0";Ve.registerVersion(kE,DE,"app-compat");function lo(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}var Ln={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"};var rn={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function RE(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}}function km(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Yu=RE,Dm=km,Rm=new ze("auth","Firebase",km());var yo=new ct("@firebase/auth");function xE(n,...e){yo.logLevel<=P.WARN&&yo.warn(`Auth (${Je}): ${n}`,...e)}function po(n,...e){yo.logLevel<=P.ERROR&&yo.error(`Auth (${Je}): ${n}`,...e)}function ce(n,...e){throw Ju(n,...e)}function ge(n,...e){return Ju(n,...e)}function xm(n,e,t){let r=Object.assign(Object.assign({},Dm()),{[e]:t});return new ze("auth","Firebase",r).create(e,{appName:n.name})}function Nr(n,e,t){let r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&ce(n,"argument-error"),xm(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Ju(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Rm.create(n,...e)}function v(n,e,...t){if(!n)throw Ju(e,...t)}function ht(n){let e="INTERNAL ASSERTION FAILED: "+n;throw po(e),new Error(e)}function Ge(n,e){n||ht(e)}function Ci(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Xu(){return gm()==="http:"||gm()==="https:"}function gm(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function PE(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Xu()||ro()||"connection"in navigator)?navigator.onLine:!0}function OE(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Rn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ge(t>e,"Short delay should be less than long delay!"),this.isMobile=$p()||_i()}get(){return PE()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function Zu(n,e){Ge(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Ni=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;ht("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;ht("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;ht("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var LE={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var ME=new Rn(3e4,6e4);function J(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function ee(n,e,t,r,i={}){return Pm(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});let a=Nn(Object.assign({key:n.config.apiKey},o)).slice(1),c=await n._getAdditionalHeaders();return c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode),Ni.fetch()(Om(n,n.config.apiHost,t,a),Object.assign({method:e,headers:c,referrerPolicy:"no-referrer"},s))})}async function Pm(n,e,t){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},LE),e);try{let i=new Nu(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=await s.json();if("needConfirmation"in o)throw bi(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let a=s.ok?o.errorMessage:o.error.message,[c,u]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw bi(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw bi(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw bi(n,"user-disabled",o);let l=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw xm(n,l,u);ce(n,l)}}catch(i){if(i instanceof oe)throw i;ce(n,"network-request-failed",{message:String(i)})}}async function Ot(n,e,t,r,i={}){let s=await ee(n,e,t,r,i);return"mfaPendingCredential"in s&&ce(n,"multi-factor-auth-required",{_serverResponse:s}),s}function Om(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?Zu(n.config,i):`${n.config.apiScheme}://${i}`}var Nu=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ge(this.auth,"network-request-failed")),ME.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function bi(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=ge(n,e,r);return i.customData._tokenResponse=t,i}async function FE(n,e){return ee(n,"POST","/v1/accounts:delete",e)}async function UE(n,e){return ee(n,"POST","/v1/accounts:update",e)}async function VE(n,e){return ee(n,"POST","/v1/accounts:lookup",e)}function Si(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Lm(n,e=!1){let t=N(n),r=await t.getIdToken(e),i=qo(r);v(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Si(Iu(i.auth_time)),issuedAtTime:Si(Iu(i.iat)),expirationTime:Si(Iu(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function Iu(n){return Number(n)*1e3}function qo(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return po("JWT malformed, contained fewer than 3 sections"),null;try{let i=Jc(t);return i?JSON.parse(i):(po("Failed to decode base64 JWT payload"),null)}catch(i){return po("Caught error parsing JWT payload as JSON",i?.toString()),null}}function BE(n){let e=qo(n);return v(e,"internal-error"),v(typeof e.exp<"u","internal-error"),v(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Pt(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof oe&&qE(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function qE({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var ku=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var vo=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Si(this.lastLoginAt),this.creationTime=Si(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function ki(n){var e;let t=n.auth,r=await n.getIdToken(),i=await Pt(n,VE(t,{idToken:r}));v(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?zE(s.providerUserInfo):[],a=jE(n.providerData,o),c=n.isAnonymous,u=!(n.email&&s.passwordHash)&&!a?.length,l=c?u:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new vo(s.createdAt,s.lastLoginAt),isAnonymous:l};Object.assign(n,h)}async function Mm(n){let e=N(n);await ki(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function jE(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function zE(n){return n.map(e=>{var{providerId:t}=e,r=lo(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}async function GE(n,e){let t=await Pm(n,{},async()=>{let r=Nn({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=Om(n,i,"/v1/token",`key=${s}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Ni.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}var wo=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){v(e.idToken,"internal-error"),v(typeof e.idToken<"u","internal-error"),v(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):BE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return v(!this.accessToken||this.refreshToken,e,"user-token-expired"),!t&&this.accessToken&&!this.isExpired?this.accessToken:this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:s}=await GE(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(v(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(v(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(v(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return ht("not implemented")}};function Ht(n,e){v(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Tr=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=lo(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ku(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new vo(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){let t=await Pt(this,this.stsTokenManager.getToken(this.auth,e));return v(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Lm(this,e)}reload(){return Mm(this)}_assign(e){this!==e&&(v(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){v(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await ki(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){let e=await this.getIdToken();return await Pt(this,FE(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,a,c,u,l;let h=(r=t.displayName)!==null&&r!==void 0?r:void 0,d=(i=t.email)!==null&&i!==void 0?i:void 0,m=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,w=(o=t.photoURL)!==null&&o!==void 0?o:void 0,T=(a=t.tenantId)!==null&&a!==void 0?a:void 0,S=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,U=(u=t.createdAt)!==null&&u!==void 0?u:void 0,j=(l=t.lastLoginAt)!==null&&l!==void 0?l:void 0,{uid:x,emailVerified:Y,isAnonymous:Z,providerData:q,stsTokenManager:Ee}=t;v(x&&Ee,e,"internal-error");let Dt=wo.fromJSON(this.name,Ee);v(typeof x=="string",e,"internal-error"),Ht(h,e.name),Ht(d,e.name),v(typeof Y=="boolean",e,"internal-error"),v(typeof Z=="boolean",e,"internal-error"),Ht(m,e.name),Ht(w,e.name),Ht(T,e.name),Ht(S,e.name),Ht(U,e.name),Ht(j,e.name);let wr=new n({uid:x,auth:e,email:d,emailVerified:Y,displayName:h,isAnonymous:Z,photoURL:w,phoneNumber:m,tenantId:T,stsTokenManager:Dt,createdAt:U,lastLoginAt:j});return q&&Array.isArray(q)&&(wr.providerData=q.map(uI=>Object.assign({},uI))),S&&(wr._redirectEventId=S),wr}static async _fromIdTokenResponse(e,t,r=!1){let i=new wo;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await ki(s),s}};var ym=new Map;function Ae(n){Ge(n instanceof Function,"Expected a class definition");let e=ym.get(n);return e?(Ge(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,ym.set(n,e),e)}var _o=class{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}};_o.type="NONE";var Yt=_o;function dt(n,e,t){return`firebase:${n}:${e}:${t}`}var Io=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=dt(this.userKey,i.apiKey,s),this.fullPersistenceKey=dt("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);return e?Tr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(Ae(Yt),e,r);let i=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u),s=i[0]||Ae(Yt),o=dt(r,e.config.apiKey,e.name),a=null;for(let u of t)try{let l=await u._get(o);if(l){let h=Tr._fromJSON(e,l);u!==s&&(a=h),s=u;break}}catch{}let c=i.filter(u=>u._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],a&&await s._set(o,a.toJSON()),await Promise.all(t.map(async u=>{if(u!==s)try{await u._remove(o)}catch{}})),new n(s,e,r))}};function vm(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Vm(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Fm(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Bm(e))return"Blackberry";if(qm(e))return"Webos";if(el(e))return"Safari";if((e.includes("chrome/")||Um(e))&&!e.includes("edge/"))return"Chrome";if(kr(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function Fm(n=z()){return/firefox\//i.test(n)}function el(n=z()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Um(n=z()){return/crios\//i.test(n)}function Vm(n=z()){return/iemobile/i.test(n)}function kr(n=z()){return/android/i.test(n)}function Bm(n=z()){return/blackberry/i.test(n)}function qm(n=z()){return/webos/i.test(n)}function Mn(n=z()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function jm(n=z()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(n)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(n)}function $E(n=z()){var e;return Mn(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function KE(){return io()&&document.documentMode===10}function zm(n=z()){return Mn(n)||kr(n)||qm(n)||Bm(n)||/windows phone/i.test(n)||Vm(n)}function WE(){try{return!!(window&&window!==window.top)}catch{return!1}}function tl(n,e=[]){let t;switch(n){case"Browser":t=vm(z());break;case"Worker":t=`${vm(z())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Je}/${r}`}async function HE(n){return(await ee(n,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function Gm(n,e){return ee(n,"GET","/v2/recaptchaConfig",J(n,e))}function wm(n){return n!==void 0&&n.getResponse!==void 0}function _m(n){return n!==void 0&&n.enterprise!==void 0}var Eo=class{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(t=>t.provider==="EMAIL_PASSWORD_PROVIDER"&&t.enforcementState!=="OFF")}};function QE(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}function nl(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=ge("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",QE().appendChild(r)})}function $m(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var YE="https://www.google.com/recaptcha/enterprise.js?render=",JE="recaptcha-enterprise",XE="NO_RECAPTCHA",To=class{constructor(e){this.type=JE,this.auth=W(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{Gm(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{let u=new Eo(c);return s.tenantId==null?s._agentRecaptchaConfig=u:s._tenantRecaptchaConfigs[s.tenantId]=u,o(u.siteKey)}}).catch(c=>{a(c)})})}function i(s,o,a){let c=window.grecaptcha;_m(c)?c.enterprise.ready(()=>{c.enterprise.execute(s,{action:e}).then(u=>{o(u)}).catch(()=>{o(XE)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!t&&_m(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}nl(YE+a).then(()=>{i(a,s,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}};async function Jt(n,e,t,r=!1){let i=new To(n),s;try{s=await i.verify(t)}catch{s=await i.verify(t,!0)}let o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}var Du=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,a)=>{try{let c=e(s);o(c)}catch(c){a(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};var bo=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new So(this),this.idTokenSubscription=new So(this),this.beforeStateQueue=new Du(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Rm,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ae(t)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Io.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var t;let r=await this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=i?._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===a)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return v(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ki(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=OE()}async _delete(){this._deleted=!0}async updateCurrentUser(e){let t=e?N(e):null;return t&&v(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&v(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(Ae(e))})}async initializeRecaptchaConfig(){let e=await Gm(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new Eo(e);this.tenantId==null?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled&&new To(this).verify()}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ze("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&Ae(e)||this._popupRedirectResolver;v(t,this,"argument-error"),this.redirectPersistenceManager=await Io.create(this,[Ae(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return v(o,this,"internal-error"),o.then(()=>s(this.currentUser)),typeof t=="function"?e.addObserver(t,r,i):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return v(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tl(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);let i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;let t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t?.error&&xE(`Error while retrieving App Check token: ${t.error}`),t?.token}};function W(n){return N(n)}var So=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=so(t=>this.observer=t)}get next(){return v(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};function ZE(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Ae);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function rl(n,e,t){let r=W(n);v(r._canInitEmulator,r,"emulator-config-failed"),v(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=Km(e),{host:o,port:a}=eT(e),c=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||tT()}function Km(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function eT(n){let e=Km(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:Im(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:Im(o)}}}function Im(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function tT(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var ft=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ht("not implemented")}_getIdTokenResponse(e){return ht("not implemented")}_linkToIdToken(e,t){return ht("not implemented")}_getReauthenticationResolver(e){return ht("not implemented")}};async function Wm(n,e){return ee(n,"POST","/v1/accounts:resetPassword",J(n,e))}async function Hm(n,e){return ee(n,"POST","/v1/accounts:update",e)}async function nT(n,e){return ee(n,"POST","/v1/accounts:update",J(n,e))}async function Eu(n,e){return Ot(n,"POST","/v1/accounts:signInWithPassword",J(n,e))}async function jo(n,e){return ee(n,"POST","/v1/accounts:sendOobCode",J(n,e))}async function rT(n,e){return jo(n,e)}async function Tu(n,e){return jo(n,e)}async function bu(n,e){return jo(n,e)}async function iT(n,e){return jo(n,e)}async function sT(n,e){return Ot(n,"POST","/v1/accounts:signInWithEmailLink",J(n,e))}async function oT(n,e){return Ot(n,"POST","/v1/accounts:signInWithEmailLink",J(n,e))}var Di=class n extends ft{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":let r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(!((t=e._getRecaptchaConfig())===null||t===void 0)&&t.emailPasswordEnabled){let i=await Jt(e,r,"signInWithPassword");return Eu(e,i)}else return Eu(e,r).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");let s=await Jt(e,r,"signInWithPassword");return Eu(e,s)}else return Promise.reject(i)});case"emailLink":return sT(e,{email:this._email,oobCode:this._password});default:ce(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Hm(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return oT(e,{idToken:t,email:this._email,oobCode:this._password});default:ce(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};async function xt(n,e){return Ot(n,"POST","/v1/accounts:signInWithIdp",J(n,e))}var aT="http://localhost",Xe=class n extends ft{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ce("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=lo(t,["providerId","signInMethod"]);if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return xt(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,xt(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,xt(e,t)}buildRequest(){let e={requestUri:aT,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Nn(t)}return e}};async function cT(n,e){return ee(n,"POST","/v1/accounts:sendVerificationCode",J(n,e))}async function uT(n,e){return Ot(n,"POST","/v1/accounts:signInWithPhoneNumber",J(n,e))}async function lT(n,e){let t=await Ot(n,"POST","/v1/accounts:signInWithPhoneNumber",J(n,e));if(t.temporaryProof)throw bi(n,"account-exists-with-different-credential",t);return t}var hT={USER_NOT_FOUND:"user-not-found"};async function dT(n,e){let t=Object.assign(Object.assign({},e),{operation:"REAUTH"});return Ot(n,"POST","/v1/accounts:signInWithPhoneNumber",J(n,t),hT)}var br=class n extends ft{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new n({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new n({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return uT(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return lT(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return dT(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new n({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function fT(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function pT(n){let e=Kt(Ir(n)).link,t=e?Kt(Ir(e)).deep_link_id:null,r=Kt(Ir(n)).deep_link_id;return(r?Kt(Ir(r)).link:null)||r||t||e||n}var Ri=class n{constructor(e){var t,r,i,s,o,a;let c=Kt(Ir(e)),u=(t=c.apiKey)!==null&&t!==void 0?t:null,l=(r=c.oobCode)!==null&&r!==void 0?r:null,h=fT((i=c.mode)!==null&&i!==void 0?i:null);v(u&&l&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=l,this.continueUrl=(s=c.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=c.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){let t=pT(e);try{return new n(t)}catch{return null}}};var pt=class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(e,t){return Di._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let r=Ri.parseLink(t);return v(r,"argument-error"),Di._fromEmailAndCode(e,r.code,r.tenantId)}};pt.PROVIDER_ID="password";pt.EMAIL_PASSWORD_SIGN_IN_METHOD="password";pt.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var Ze=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var Xt=class extends Ze{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}},Sr=class n extends Xt{static credentialFromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;return v("providerId"in t&&"signInMethod"in t,"argument-error"),Xe._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return v(e.idToken||e.accessToken,"argument-error"),Xe._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return n.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return n.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=e;if(!r&&!i&&!t&&!s||!a)return null;try{return new n(a)._credential({idToken:t,accessToken:r,nonce:o,pendingToken:s})}catch{return null}}};var Zt=class n extends Xt{constructor(){super("facebook.com")}static credential(e){return Xe._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return n.credential(e.oauthAccessToken)}catch{return null}}};Zt.FACEBOOK_SIGN_IN_METHOD="facebook.com";Zt.PROVIDER_ID="facebook.com";var en=class n extends Xt{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Xe._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return n.credential(t,r)}catch{return null}}};en.GOOGLE_SIGN_IN_METHOD="google.com";en.PROVIDER_ID="google.com";var tn=class n extends Xt{constructor(){super("github.com")}static credential(e){return Xe._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return n.credential(e.oauthAccessToken)}catch{return null}}};tn.GITHUB_SIGN_IN_METHOD="github.com";tn.PROVIDER_ID="github.com";var mT="http://localhost",xn=class n extends ft{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){let t=this.buildRequest();return xt(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,xt(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,xt(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,pendingToken:s}=t;return!r||!i||!s||r!==i?null:new n(r,s)}static _create(e,t){return new n(e,t)}buildRequest(){return{requestUri:mT,returnSecureToken:!0,pendingToken:this.pendingToken}}};var gT="saml.",xi=class n extends Ze{constructor(e){v(e.startsWith(gT),"argument-error"),super(e)}static credentialFromResult(e){return n.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return n.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=xn.fromJSON(e);return v(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:r}=e;if(!t||!r)return null;try{return xn._create(r,t)}catch{return null}}};var nn=class n extends Xt{constructor(){super("twitter.com")}static credential(e,t){return Xe._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return n.credential(t,r)}catch{return null}}};nn.TWITTER_SIGN_IN_METHOD="twitter.com";nn.PROVIDER_ID="twitter.com";async function mo(n,e){return Ot(n,"POST","/v1/accounts:signUp",J(n,e))}var et=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){let s=await Tr._fromIdTokenResponse(e,r,i),o=Em(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);let i=Em(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})}};function Em(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}async function il(n){var e;let t=W(n);if(await t._initializationPromise,!((e=t.currentUser)===null||e===void 0)&&e.isAnonymous)return new et({user:t.currentUser,providerId:null,operationType:"signIn"});let r=await mo(t,{returnSecureToken:!0}),i=await et._fromIdTokenResponse(t,"signIn",r,!0);return await t._updateCurrentUser(i.user),i}var Ru=class n extends oe{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Qm(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Ru._fromErrorAndOperation(n,s,e,r):s})}function Ym(n){return new Set(n.map(({providerId:e})=>e).filter(e=>!!e))}async function sl(n,e){let t=N(n);await zo(!0,t,e);let{providerUserInfo:r}=await UE(t.auth,{idToken:await t.getIdToken(),deleteProvider:[e]}),i=Ym(r||[]);return t.providerData=t.providerData.filter(s=>i.has(s.providerId)),i.has("phone")||(t.phoneNumber=null),await t.auth._persistUserIfCurrent(t),t}async function ol(n,e,t=!1){let r=await Pt(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return et._forOperation(n,"link",r)}async function zo(n,e,t){await ki(e);let r=Ym(e.providerData),i=n===!1?"provider-already-linked":"no-such-provider";v(r.has(t)===n,e.auth,i)}async function Jm(n,e,t=!1){let{auth:r}=n,i="reauthenticate";try{let s=await Pt(n,Qm(r,i,e,n),t);v(s.idToken,r,"internal-error");let o=qo(s.idToken);v(o,r,"internal-error");let{sub:a}=o;return v(n.uid===a,r,"user-mismatch"),et._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&ce(r,"user-mismatch"),s}}async function Xm(n,e,t=!1){let r="signIn",i=await Qm(n,r,e),s=await et._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function Dr(n,e){return Xm(W(n),e)}async function Go(n,e){let t=N(n);return await zo(!1,t,e.providerId),ol(t,e)}async function $o(n,e){return Jm(N(n),e)}async function yT(n,e){return Ot(n,"POST","/v1/accounts:signInWithCustomToken",J(n,e))}async function al(n,e){let t=W(n),r=await yT(t,{token:e,returnSecureToken:!0}),i=await et._fromIdTokenResponse(t,"signIn",r);return await t._updateCurrentUser(i.user),i}var Pn=class{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?xu._fromServerResponse(e,t):"totpInfo"in t?Pu._fromServerResponse(e,t):ce(e,"internal-error")}},xu=class n extends Pn{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new n(t)}},Pu=class n extends Pn{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new n(t)}};function Er(n,e,t){var r;v(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),v(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(v(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(v(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}async function cl(n,e,t){var r;let i=W(n),s={requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"};if(!((r=i._getRecaptchaConfig())===null||r===void 0)&&r.emailPasswordEnabled){let o=await Jt(i,s,"getOobCode",!0);t&&Er(i,o,t),await Tu(i,o)}else t&&Er(i,s,t),await Tu(i,s).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");let a=await Jt(i,s,"getOobCode",!0);t&&Er(i,a,t),await Tu(i,a)}else return Promise.reject(o)})}async function ul(n,e,t){await Wm(N(n),{oobCode:e,newPassword:t})}async function ll(n,e){await nT(N(n),{oobCode:e})}async function Ko(n,e){let t=N(n),r=await Wm(t,{oobCode:e}),i=r.requestType;switch(v(i,t,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":v(r.newEmail,t,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":v(r.mfaInfo,t,"internal-error");default:v(r.email,t,"internal-error")}let s=null;return r.mfaInfo&&(s=Pn._fromServerResponse(W(t),r.mfaInfo)),{data:{email:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.newEmail:r.email)||null,previousEmail:(r.requestType==="VERIFY_AND_CHANGE_EMAIL"?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function hl(n,e){let{data:t}=await Ko(N(n),e);return t.email}async function dl(n,e,t){var r;let i=W(n),s={returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},o;if(!((r=i._getRecaptchaConfig())===null||r===void 0)&&r.emailPasswordEnabled){let u=await Jt(i,s,"signUpPassword");o=mo(i,u)}else o=mo(i,s).catch(async u=>{if(u.code==="auth/missing-recaptcha-token"){console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");let l=await Jt(i,s,"signUpPassword");return mo(i,l)}else return Promise.reject(u)});let a=await o.catch(u=>Promise.reject(u)),c=await et._fromIdTokenResponse(i,"signIn",a);return await i._updateCurrentUser(c.user),c}function fl(n,e,t){return Dr(N(n),pt.credential(e,t))}async function pl(n,e,t){var r;let i=W(n),s={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function o(a,c){v(c.handleCodeInApp,i,"argument-error"),c&&Er(i,a,c)}if(!((r=i._getRecaptchaConfig())===null||r===void 0)&&r.emailPasswordEnabled){let a=await Jt(i,s,"getOobCode",!0);o(a,t),await bu(i,a)}else o(s,t),await bu(i,s).catch(async a=>{if(a.code==="auth/missing-recaptcha-token"){console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");let c=await Jt(i,s,"getOobCode",!0);o(c,t),await bu(i,c)}else return Promise.reject(a)})}function ml(n,e){let t=Ri.parseLink(e);return t?.operation==="EMAIL_SIGNIN"}async function gl(n,e,t){let r=N(n),i=pt.credentialWithLink(e,t||Ci());return v(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),Dr(r,i)}async function vT(n,e){return ee(n,"POST","/v1/accounts:createAuthUri",J(n,e))}async function yl(n,e){let t=Xu()?Ci():"http://localhost",r={identifier:e,continueUri:t},{signinMethods:i}=await vT(N(n),r);return i||[]}async function vl(n,e){let t=N(n),i={requestType:"VERIFY_EMAIL",idToken:await n.getIdToken()};e&&Er(t.auth,i,e);let{email:s}=await rT(t.auth,i);s!==n.email&&await n.reload()}async function wl(n,e,t){let r=N(n),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await n.getIdToken(),newEmail:e};t&&Er(r.auth,s,t);let{email:o}=await iT(r.auth,s);o!==n.email&&await n.reload()}async function wT(n,e){return ee(n,"POST","/v1/accounts:update",e)}async function _l(n,{displayName:e,photoURL:t}){if(e===void 0&&t===void 0)return;let r=N(n),s={idToken:await r.getIdToken(),displayName:e,photoUrl:t,returnSecureToken:!0},o=await Pt(r,wT(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;let a=r.providerData.find(({providerId:c})=>c==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function Il(n,e){return Zm(N(n),e,null)}function El(n,e){return Zm(N(n),null,e)}async function Zm(n,e,t){let{auth:r}=n,s={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(s.email=e),t&&(s.password=t);let o=await Pt(n,Hm(r,s));await n._updateTokensIfNecessary(o,!0)}function _T(n){var e,t;if(!n)return null;let{providerId:r}=n,i=n.rawUserInfo?JSON.parse(n.rawUserInfo):{},s=n.isNewUser||n.kind==="identitytoolkit#SignupNewUserResponse";if(!r&&n?.idToken){let o=(t=(e=qo(n.idToken))===null||e===void 0?void 0:e.firebase)===null||t===void 0?void 0:t.sign_in_provider;if(o){let a=o!=="anonymous"&&o!=="custom"?o:null;return new Qt(s,a)}}if(!r)return null;switch(r){case"facebook.com":return new Ou(s,i);case"github.com":return new Lu(s,i);case"google.com":return new Mu(s,i);case"twitter.com":return new Fu(s,i,n.screenName||null);case"custom":case"anonymous":return new Qt(s,null);default:return new Qt(s,r,i)}}var Qt=class{constructor(e,t,r={}){this.isNewUser=e,this.providerId=t,this.profile=r}},Ao=class extends Qt{constructor(e,t,r,i){super(e,t,r),this.username=i}},Ou=class extends Qt{constructor(e,t){super(e,"facebook.com",t)}},Lu=class extends Ao{constructor(e,t){super(e,"github.com",t,typeof t?.login=="string"?t?.login:null)}},Mu=class extends Qt{constructor(e,t){super(e,"google.com",t)}},Fu=class extends Ao{constructor(e,t,r){super(e,"twitter.com",t,r)}};function Tl(n){let{user:e,_tokenResponse:t}=n;return e.isAnonymous&&!t?{providerId:null,isNewUser:!1,profile:null}:_T(t)}var Co=class n{constructor(e,t,r){this.type=e,this.credential=t,this.auth=r}static _fromIdtoken(e,t){return new n("enroll",e,t)}static _fromMfaPendingCredential(e){return new n("signin",e)}toJSON(){return{multiFactorSession:{[this.type==="enroll"?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,r;if(e?.multiFactorSession){if(!((t=e.multiFactorSession)===null||t===void 0)&&t.pendingCredential)return n._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(!((r=e.multiFactorSession)===null||r===void 0)&&r.idToken)return n._fromIdtoken(e.multiFactorSession.idToken)}return null}};var Uu=class n{constructor(e,t,r){this.session=e,this.hints=t,this.signInResolver=r}static _fromError(e,t){let r=W(e),i=t.customData._serverResponse,s=(i.mfaInfo||[]).map(a=>Pn._fromServerResponse(r,a));v(i.mfaPendingCredential,r,"internal-error");let o=Co._fromMfaPendingCredential(i.mfaPendingCredential);return new n(o,s,async a=>{let c=await a._process(r,o);delete i.mfaInfo,delete i.mfaPendingCredential;let u=Object.assign(Object.assign({},i),{idToken:c.idToken,refreshToken:c.refreshToken});switch(t.operationType){case"signIn":let l=await et._fromIdTokenResponse(r,t.operationType,u);return await r._updateCurrentUser(l.user),l;case"reauthenticate":return v(t.user,r,"internal-error"),et._forOperation(t.user,t.operationType,u);default:ce(r,"internal-error")}})}async resolveSignIn(e){let t=e;return this.signInResolver(t)}};function bl(n,e){var t;let r=N(n),i=e;return v(e.customData.operationType,r,"argument-error"),v((t=i.customData._serverResponse)===null||t===void 0?void 0:t.mfaPendingCredential,r,"argument-error"),Uu._fromError(r,i)}function IT(n,e){return ee(n,"POST","/v2/accounts/mfaEnrollment:start",J(n,e))}function ET(n,e){return ee(n,"POST","/v2/accounts/mfaEnrollment:finalize",J(n,e))}function TT(n,e){return ee(n,"POST","/v2/accounts/mfaEnrollment:start",J(n,e))}function bT(n,e){return ee(n,"POST","/v2/accounts/mfaEnrollment:finalize",J(n,e))}function ST(n,e){return ee(n,"POST","/v2/accounts/mfaEnrollment:withdraw",J(n,e))}var Vu=class n{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(r=>Pn._fromServerResponse(e.auth,r)))})}static _fromUser(e){return new n(e)}async getSession(){return Co._fromIdtoken(await this.user.getIdToken(),this.user.auth)}async enroll(e,t){let r=e,i=await this.getSession(),s=await Pt(this.user,r._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(s),this.user.reload()}async unenroll(e){let t=typeof e=="string"?e:e.uid,r=await this.user.getIdToken();try{let i=await Pt(this.user,ST(this.user.auth,{idToken:r,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:s})=>s!==t),await this.user._updateTokensIfNecessary(i),await this.user.reload()}catch(i){throw i}}},Su=new WeakMap;function Sl(n){let e=N(n);return Su.has(e)||Su.set(e,Vu._fromUser(e)),Su.get(e)}var No="__sak";var ko=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(No,"1"),this.storage.removeItem(No),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};function AT(){let n=z();return el(n)||Mn(n)}var CT=1e3,NT=10,Do=class extends ko{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=AT()&&WE(),this.fallbackToPolling=zm(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let t of Object.keys(this.listeners)){let r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}let r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}let i=()=>{let o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);KE()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,NT):i()}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},CT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){let t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}};Do.type="LOCAL";var Rr=Do;var Ro=class extends ko{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}};Ro.type="SESSION";var mt=Ro;function kT(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var xo=class n{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;let r=new n(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});let a=Array.from(o).map(async u=>u(t.origin,s)),c=await kT(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:c})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}};xo.receivers=[];function Fn(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var Bu=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,c)=>{let u=Fn("",20);i.port1.start();let l=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){let d=h;if(d.data.eventId===u)switch(d.data.status){case"ack":clearTimeout(l),s=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(d.data.response);break;default:clearTimeout(l),clearTimeout(s),c(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}};function ae(){return window}function DT(n){ae().location.href=n}function Al(){return typeof ae().WorkerGlobalScope<"u"&&typeof ae().importScripts=="function"}async function RT(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function xT(){var n;return((n=navigator?.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function PT(){return Al()?self:null}var eg="firebaseLocalStorageDb",OT=1,Po="firebaseLocalStorage",tg="fbase_key",On=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function Wo(n,e){return n.transaction([Po],e?"readwrite":"readonly").objectStore(Po)}function LT(){let n=indexedDB.deleteDatabase(eg);return new On(n).toPromise()}function qu(){let n=indexedDB.open(eg,OT);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(Po,{keyPath:tg})}catch(i){t(i)}}),n.addEventListener("success",async()=>{let r=n.result;r.objectStoreNames.contains(Po)?e(r):(r.close(),await LT(),e(await qu()))})})}async function Tm(n,e,t){let r=Wo(n,!0).put({[tg]:e,value:t});return new On(r).toPromise()}async function MT(n,e){let t=Wo(n,!1).get(e),r=await new On(t).toPromise();return r===void 0?null:r.value}function bm(n,e){let t=Wo(n,!0).delete(e);return new On(t).toPromise()}var FT=800,UT=3,Oo=class{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await qu(),this.db)}async _withRetries(e){let t=0;for(;;)try{let r=await this._openDb();return await e(r)}catch(r){if(t++>UT)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Al()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=xo._getInstance(PT()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await RT(),!this.activeServiceWorker)return;this.sender=new Bu(this.activeServiceWorker);let r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||xT()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await qu();return await Tm(e,No,"1"),await bm(e,No),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Tm(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){let t=await this._withRetries(r=>MT(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>bm(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(i=>{let s=Wo(i,!1).getAll();return new On(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];let t=[],r=new Set;for(let{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(let i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),FT)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}};Oo.type="LOCAL";var Un=Oo;function VT(n,e){return ee(n,"POST","/v2/accounts/mfaSignIn:start",J(n,e))}function BT(n,e){return ee(n,"POST","/v2/accounts/mfaSignIn:finalize",J(n,e))}function qT(n,e){return ee(n,"POST","/v2/accounts/mfaSignIn:finalize",J(n,e))}var jT=500,zT=6e4,ho=1e12,ju=class{constructor(e){this.auth=e,this.counter=ho,this._widgets=new Map}render(e,t){let r=this.counter;return this._widgets.set(r,new zu(e,this.auth.name,t||{})),this.counter++,r}reset(e){var t;let r=e||ho;(t=this._widgets.get(r))===null||t===void 0||t.delete(),this._widgets.delete(r)}getResponse(e){var t;let r=e||ho;return((t=this._widgets.get(r))===null||t===void 0?void 0:t.getResponse())||""}async execute(e){var t;let r=e||ho;return(t=this._widgets.get(r))===null||t===void 0||t.execute(),""}},zu=class{constructor(e,t,r){this.params=r,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};let i=typeof e=="string"?document.getElementById(e):e;v(i,"argument-error",{appName:t}),this.container=i,this.isVisible=this.params.size!=="invisible",this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=GT(50);let{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch{}this.isVisible&&this.execute()},zT)},jT))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}};function GT(n){let e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<n;r++)e.push(t.charAt(Math.floor(Math.random()*t.length)));return e.join("")}var Au=$m("rcb"),$T=new Rn(3e4,6e4),KT="https://www.google.com/recaptcha/api.js?",Gu=class{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(!((e=ae().grecaptcha)===null||e===void 0)&&e.render)}load(e,t=""){return v(WT(t),e,"argument-error"),this.shouldResolveImmediately(t)&&wm(ae().grecaptcha)?Promise.resolve(ae().grecaptcha):new Promise((r,i)=>{let s=ae().setTimeout(()=>{i(ge(e,"network-request-failed"))},$T.get());ae()[Au]=()=>{ae().clearTimeout(s),delete ae()[Au];let a=ae().grecaptcha;if(!a||!wm(a)){i(ge(e,"internal-error"));return}let c=a.render;a.render=(u,l)=>{let h=c(u,l);return this.counter++,h},this.hostLanguage=t,r(a)};let o=`${KT}?${Nn({onload:Au,render:"explicit",hl:t})}`;nl(o).catch(()=>{clearTimeout(s),i(ge(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(!((t=ae().grecaptcha)===null||t===void 0)&&t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}};function WT(n){return n.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(n)}var $u=class{async load(e){return new ju(e)}clearedOneInstance(){}};var ng="recaptcha",HT={theme:"light",type:"image"},Pi=class{constructor(e,t=Object.assign({},HT),r){this.parameters=t,this.type=ng,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=W(r),this.isInvisible=this.parameters.size==="invisible",v(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");let i=typeof e=="string"?document.getElementById(e):e;v(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new $u:new Gu,this.validateStartingState()}async verify(){this.assertNotDestroyed();let e=await this.render(),t=this.getAssertedRecaptcha(),r=t.getResponse(e);return r||new Promise(i=>{let s=o=>{o&&(this.tokenChangeListeners.delete(s),i(o))};this.tokenChangeListeners.add(s),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),this.widgetId!==null&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){v(!this.parameters.sitekey,this.auth,"argument-error"),v(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),v(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(r=>r(t)),typeof e=="function")e(t);else if(typeof e=="string"){let r=ae()[e];typeof r=="function"&&r(t)}}}assertNotDestroyed(){v(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){let t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){v(Xu()&&!Al(),this.auth,"internal-error"),await QT(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);let e=await HE(this.auth);v(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return v(this.recaptcha,this.auth,"internal-error"),this.recaptcha}};function QT(){let n=null;return new Promise(e=>{if(document.readyState==="complete"){e();return}n=()=>e(),window.addEventListener("load",n)}).catch(e=>{throw n&&window.removeEventListener("load",n),e})}var Oi=class{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){let t=br._fromVerification(this.verificationId,e);return this.onConfirmation(t)}};async function Cl(n,e,t){let r=W(n),i=await Ho(r,e,N(t));return new Oi(i,s=>Dr(r,s))}async function Nl(n,e,t){let r=N(n);await zo(!1,r,"phone");let i=await Ho(r.auth,e,N(t));return new Oi(i,s=>Go(r,s))}async function kl(n,e,t){let r=N(n),i=await Ho(r.auth,e,N(t));return new Oi(i,s=>$o(r,s))}async function Ho(n,e,t){var r;let i=await t.verify();try{v(typeof i=="string",n,"argument-error"),v(t.type===ng,n,"argument-error");let s;if(typeof e=="string"?s={phoneNumber:e}:s=e,"session"in s){let o=s.session;if("phoneNumber"in s)return v(o.type==="enroll",n,"internal-error"),(await IT(n,{idToken:o.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}})).phoneSessionInfo.sessionInfo;{v(o.type==="signin",n,"internal-error");let a=((r=s.multiFactorHint)===null||r===void 0?void 0:r.uid)||s.multiFactorUid;return v(a,n,"missing-multi-factor-info"),(await VT(n,{mfaPendingCredential:o.credential,mfaEnrollmentId:a,phoneSignInInfo:{recaptchaToken:i}})).phoneResponseInfo.sessionInfo}}else{let{sessionInfo:o}=await cT(n,{phoneNumber:s.phoneNumber,recaptchaToken:i});return o}}finally{t._reset()}}async function Dl(n,e){await ol(N(n),e)}var tt=class n{constructor(e){this.providerId=n.PROVIDER_ID,this.auth=W(e)}verifyPhoneNumber(e,t){return Ho(this.auth,e,N(t))}static credential(e,t){return br._fromVerification(e,t)}static credentialFromResult(e){let t=e;return n.credentialFromTaggedObject(t)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:t,temporaryProof:r}=e;return t&&r?br._fromTokenResponse(t,r):null}};tt.PROVIDER_ID="phone";tt.PHONE_SIGN_IN_METHOD="phone";function Vn(n,e){return e?Ae(e):(v(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var Li=class extends ft{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return xt(e,this._buildIdpRequest())}_linkToIdToken(e,t){return xt(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return xt(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function YT(n){return Xm(n.auth,new Li(n),n.bypassAuthState)}function JT(n){let{auth:e,user:t}=n;return v(t,e,"internal-error"),Jm(t,new Li(n),n.bypassAuthState)}async function XT(n){let{auth:e,user:t}=n;return v(t,e,"internal-error"),ol(t,new Li(n),n.bypassAuthState)}var Lo=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}let c={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return YT;case"linkViaPopup":case"linkViaRedirect":return XT;case"reauthViaPopup":case"reauthViaRedirect":return JT;default:ce(this.auth,"internal-error")}}resolve(e){Ge(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ge(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var ZT=new Rn(2e3,1e4);async function Rl(n,e,t){let r=W(n);Nr(n,e,Ze);let i=Vn(r,t);return new Ar(r,"signInViaPopup",e,i).executeNotNull()}async function xl(n,e,t){let r=N(n);Nr(r.auth,e,Ze);let i=Vn(r.auth,t);return new Ar(r.auth,"reauthViaPopup",e,i,r).executeNotNull()}async function Pl(n,e,t){let r=N(n);Nr(r.auth,e,Ze);let i=Vn(r.auth,t);return new Ar(r.auth,"linkViaPopup",e,i,r).executeNotNull()}var Ar=class n extends Lo{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return v(e,this.auth,"internal-error"),e}async onExecution(){Ge(this.filter.length===1,"Popup operations only handle one event");let e=Fn();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ge(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ge(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ge(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,ZT.get())};e()}};Ar.currentPopupAction=null;var e0="pendingRedirect",Ai=new Map,Ku=class extends Lo{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Ai.get(this.auth._key());if(!e){try{let r=await t0(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Ai.set(this.auth._key(),e)}return this.bypassAuthState||Ai.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function t0(n,e){let t=sg(e),r=ig(n);if(!await r._isAvailable())return!1;let i=await r._get(t)==="true";return await r._remove(t),i}async function Ol(n,e){return ig(n)._set(sg(e),"true")}function rg(){Ai.clear()}function xr(n,e){Ai.set(n._key(),e)}function ig(n){return Ae(n._redirectPersistence)}function sg(n){return dt(e0,n.config.apiKey,n.name)}function Ll(n,e,t){return n0(n,e,t)}async function n0(n,e,t){let r=W(n);Nr(n,e,Ze),await r._initializationPromise;let i=Vn(r,t);return await Ol(i,r),i._openRedirect(r,e,"signInViaRedirect")}function Ml(n,e,t){return r0(n,e,t)}async function r0(n,e,t){let r=N(n);Nr(r.auth,e,Ze),await r.auth._initializationPromise;let i=Vn(r.auth,t);await Ol(i,r.auth);let s=await og(r);return i._openRedirect(r.auth,e,"reauthViaRedirect",s)}function Fl(n,e,t){return i0(n,e,t)}async function i0(n,e,t){let r=N(n);Nr(r.auth,e,Ze),await r.auth._initializationPromise;let i=Vn(r.auth,t);await zo(!1,r,e.providerId),await Ol(i,r.auth);let s=await og(r);return i._openRedirect(r.auth,e,"linkViaRedirect",s)}async function Ul(n,e){return await W(n)._initializationPromise,Bn(n,e,!1)}async function Bn(n,e,t=!1){let r=W(n),i=Vn(r,e),o=await new Ku(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}async function og(n){let e=Fn(`${n.uid}:::`);return n._redirectEventId=e,await n.auth._setRedirectUser(n),await n.auth._persistUserIfCurrent(n),e}var s0=10*60*1e3,Mi=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!o0(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!ag(e)){let i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(ge(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=s0&&this.cachedEventUids.clear(),this.cachedEventUids.has(Sm(e))}saveEventToCache(e){this.cachedEventUids.add(Sm(e)),this.lastProcessedEventTime=Date.now()}};function Sm(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function ag({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function o0(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ag(n);default:return!1}}async function Vl(n,e={}){return ee(n,"GET","/v1/projects",e)}var a0=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,c0=/^https?/;async function u0(n){if(n.config.emulator)return;let{authorizedDomains:e}=await Vl(n);for(let t of e)try{if(l0(t))return}catch{}ce(n,"unauthorized-domain")}function l0(n){let e=Ci(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!c0.test(t))return!1;if(a0.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var h0=new Rn(3e4,6e4);function Am(){let n=ae().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function d0(n){return new Promise((e,t)=>{var r,i,s;function o(){Am(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Am(),t(ge(n,"network-request-failed"))},timeout:h0.get()})}if(!((i=(r=ae().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=ae().gapi)===null||s===void 0)&&s.load)o();else{let a=$m("iframefcb");return ae()[a]=()=>{gapi.load?o():t(ge(n,"network-request-failed"))},nl(`https://apis.google.com/js/api.js?onload=${a}`).catch(c=>t(c))}}).catch(e=>{throw go=null,e})}var go=null;function f0(n){return go=go||d0(n),go}var p0=new Rn(5e3,15e3),m0="__/auth/iframe",g0="emulator/auth/iframe",y0={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},v0=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function w0(n){let e=n.config;v(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?Zu(e,g0):`https://${n.config.authDomain}/${m0}`,r={apiKey:e.apiKey,appName:n.name,v:Je},i=v0.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Nn(r).slice(1)}`}async function _0(n){let e=await f0(n),t=ae().gapi;return v(t,n,"internal-error"),e.open({where:document.body,url:w0(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:y0,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});let o=ge(n,"network-request-failed"),a=ae().setTimeout(()=>{s(o)},p0.get());function c(){ae().clearTimeout(a),i(r)}r.ping(c).then(c,()=>{s(o)})}))}var I0={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},E0=500,T0=600,b0="_blank",S0="http://localhost",Fi=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function A0(n,e,t,r=E0,i=T0){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),a="",c=Object.assign(Object.assign({},I0),{width:r.toString(),height:i.toString(),top:s,left:o}),u=z().toLowerCase();t&&(a=Um(u)?b0:t),Fm(u)&&(e=e||S0,c.scrollbars="yes");let l=Object.entries(c).reduce((d,[m,w])=>`${d}${m}=${w},`,"");if($E(u)&&a!=="_self")return C0(e||"",a),new Fi(null);let h=window.open(e||"",a,l);v(h,n,"popup-blocked");try{h.focus()}catch{}return new Fi(h)}function C0(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var N0="__/auth/handler",k0="emulator/auth/handler",D0=encodeURIComponent("fac");async function Mo(n,e,t,r,i,s){v(n.config.authDomain,n,"auth-domain-config-required"),v(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Je,eventId:i};if(e instanceof Ze){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Qp(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[l,h]of Object.entries(s||{}))o[l]=h}if(e instanceof Xt){let l=e.getScopes().filter(h=>h!=="");l.length>0&&(o.scopes=l.join(","))}n.tenantId&&(o.tid=n.tenantId);let a=o;for(let l of Object.keys(a))a[l]===void 0&&delete a[l];let c=await n._getAppCheckToken(),u=c?`#${D0}=${encodeURIComponent(c)}`:"";return`${R0(n)}?${Nn(a).slice(1)}${u}`}function R0({config:n}){return n.emulator?Zu(n,k0):`https://${n.authDomain}/${N0}`}var Cu="webStorageSupport",Wu=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=mt,this._completeRedirectFn=Bn,this._overrideRedirectResult=xr}async _openPopup(e,t,r,i){var s;Ge((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");let o=await Mo(e,t,r,Ci(),i);return A0(e,o,Fn())}async _openRedirect(e,t,r,i){await this._originValidation(e);let s=await Mo(e,t,r,Ci(),i);return DT(s),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Ge(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){let t=await _0(e),r=new Mi(e);return t.register("authEvent",i=>(v(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Cu,{type:Cu},i=>{var s;let o=(s=i?.[0])===null||s===void 0?void 0:s[Cu];o!==void 0&&t(!!o),ce(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=u0(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return zm()||el()||Mn()}},Bl=Wu,Fo=class{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return ht("unexpected MultiFactorSessionType")}}},Hu=class n extends Fo{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new n(e)}_finalizeEnroll(e,t,r){return ET(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return BT(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},Cr=class{constructor(){}static assertion(e){return Hu._fromCredential(e)}};Cr.FACTOR_ID="phone";var Uo=class{static assertionForEnrollment(e,t){return Vo._fromSecret(e,t)}static assertionForSignIn(e,t){return Vo._fromEnrollmentId(e,t)}static async generateSecret(e){let t=e;v(typeof t.auth<"u","internal-error");let r=await TT(t.auth,{idToken:t.credential,totpEnrollmentInfo:{}});return Bo._fromStartTotpMfaEnrollmentResponse(r,t.auth)}};Uo.FACTOR_ID="totp";var Vo=class n extends Fo{constructor(e,t,r){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=r}static _fromSecret(e,t){return new n(t,void 0,e)}static _fromEnrollmentId(e,t){return new n(t,e)}async _finalizeEnroll(e,t,r){return v(typeof this.secret<"u",e,"argument-error"),bT(e,{idToken:t,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){v(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");let r={verificationCode:this.otp};return qT(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r})}},Bo=class n{constructor(e,t,r,i,s,o,a){this.sessionInfo=o,this.auth=a,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=r,this.codeIntervalSeconds=i,this.enrollmentCompletionDeadline=s}static _fromStartTotpMfaEnrollmentResponse(e,t){return new n(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var r;let i=!1;return(fo(e)||fo(t))&&(i=!0),i&&(fo(e)&&(e=((r=this.auth.currentUser)===null||r===void 0?void 0:r.email)||"unknownuser"),fo(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}};function fo(n){return typeof n>"u"||n?.length===0}var Cm="@firebase/auth",Nm="0.23.2";var Qu=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){v(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function x0(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}function P0(n){Ye(new me("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;v(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tl(n)},u=new bo(r,i,s,c);return ZE(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ye(new me("auth-internal",e=>{let t=W(e.getProvider("auth").getImmediate());return(r=>new Qu(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Le(Cm,Nm,x0(n)),Le(Cm,Nm,"esm2017")}var O0=5*60,zC=zp("authIdTokenMaxAge")||O0;P0("Browser");function qn(){return window}var L0=2e3;async function M0(n,e,t){var r;let{BuildInfo:i}=qn();Ge(e.sessionId,"AuthEvent did not contain a session ID");let s=await q0(e.sessionId),o={};return Mn()?o.ibi=i.packageName:kr()?o.apn=i.packageName:ce(n,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,Mo(n,t,e.type,void 0,(r=e.eventId)!==null&&r!==void 0?r:void 0,o)}async function F0(n){let{BuildInfo:e}=qn(),t={};Mn()?t.iosBundleId=e.packageName:kr()?t.androidPackageName=e.packageName:ce(n,"operation-not-supported-in-this-environment"),await Vl(n,t)}function U0(n){let{cordova:e}=qn();return new Promise(t=>{e.plugins.browsertab.isAvailable(r=>{let i=null;r?e.plugins.browsertab.openUrl(n):i=e.InAppBrowser.open(n,jm()?"_blank":"_system","location=yes"),t(i)})})}async function V0(n,e,t){let{cordova:r}=qn(),i=()=>{};try{await new Promise((s,o)=>{let a=null;function c(){var h;s();let d=(h=r.plugins.browsertab)===null||h===void 0?void 0:h.close;typeof d=="function"&&d(),typeof t?.close=="function"&&t.close()}function u(){a||(a=window.setTimeout(()=>{o(ge(n,"redirect-cancelled-by-user"))},L0))}function l(){document?.visibilityState==="visible"&&u()}e.addPassiveListener(c),document.addEventListener("resume",u,!1),kr()&&document.addEventListener("visibilitychange",l,!1),i=()=>{e.removePassiveListener(c),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",l,!1),a&&window.clearTimeout(a)}})}finally{i()}}function B0(n){var e,t,r,i,s,o,a,c,u,l;let h=qn();v(typeof((e=h?.universalLinks)===null||e===void 0?void 0:e.subscribe)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),v(typeof((t=h?.BuildInfo)===null||t===void 0?void 0:t.packageName)<"u",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),v(typeof((s=(i=(r=h?.cordova)===null||r===void 0?void 0:r.plugins)===null||i===void 0?void 0:i.browsertab)===null||s===void 0?void 0:s.openUrl)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),v(typeof((c=(a=(o=h?.cordova)===null||o===void 0?void 0:o.plugins)===null||a===void 0?void 0:a.browsertab)===null||c===void 0?void 0:c.isAvailable)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),v(typeof((l=(u=h?.cordova)===null||u===void 0?void 0:u.InAppBrowser)===null||l===void 0?void 0:l.open)=="function",n,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}async function q0(n){let e=j0(n),t=await crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(t)).map(i=>i.toString(16).padStart(2,"0")).join("")}function j0(n){if(Ge(/[0-9a-zA-Z]+/.test(n),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return new TextEncoder().encode(n);let e=new ArrayBuffer(n.length),t=new Uint8Array(e);for(let r=0;r<n.length;r++)t[r]=n.charCodeAt(r);return t}var z0=20,ql=class extends Mi{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}};function G0(n,e,t=null){return{type:e,eventId:t,urlResponse:null,sessionId:W0(),postBody:null,tenantId:n.tenantId,error:ge(n,"no-auth-event")}}function $0(n,e){return jl()._set(zl(n),e)}async function cg(n){let e=await jl()._get(zl(n));return e&&await jl()._remove(zl(n)),e}function K0(n,e){var t,r;let i=Q0(e);if(i.includes("/__/auth/callback")){let s=Qo(i),o=s.firebaseError?H0(decodeURIComponent(s.firebaseError)):null,a=(r=(t=o?.code)===null||t===void 0?void 0:t.split("auth/"))===null||r===void 0?void 0:r[1],c=a?ge(a):null;return c?{type:n.type,eventId:n.eventId,tenantId:n.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:n.type,eventId:n.eventId,tenantId:n.tenantId,sessionId:n.sessionId,urlResponse:i,postBody:null}}return null}function W0(){let n=[],e="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let t=0;t<z0;t++){let r=Math.floor(Math.random()*e.length);n.push(e.charAt(r))}return n.join("")}function jl(){return Ae(Rr)}function zl(n){return dt("authEvent",n.config.apiKey,n.name)}function H0(n){try{return JSON.parse(n)}catch{return null}}function Q0(n){let e=Qo(n),t=e.link?decodeURIComponent(e.link):void 0,r=Qo(t).link,i=e.deep_link_id?decodeURIComponent(e.deep_link_id):void 0;return Qo(i).link||i||r||t||n}function Qo(n){if(!n?.includes("?"))return{};let[e,...t]=n.split("?");return Kt(t.join("?"))}var Y0=500,Gl=class{constructor(){this._redirectPersistence=mt,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=Bn,this._overrideRedirectResult=xr}async _initialize(e){let t=e._key(),r=this.eventManagers.get(t);return r||(r=new ql(e),this.eventManagers.set(t,r),this.attachCallbackListeners(e,r)),r}_openPopup(e){ce(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,r,i){B0(e);let s=await this._initialize(e);await s.initialized(),s.resetRedirect(),rg(),await this._originValidation(e);let o=G0(e,r,i);await $0(e,o);let a=await M0(e,o,t),c=await U0(a);return V0(e,s,c)}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=F0(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){let{universalLinks:r,handleOpenURL:i,BuildInfo:s}=qn(),o=setTimeout(async()=>{await cg(e),t.onEvent(ug())},Y0),a=async l=>{clearTimeout(o);let h=await cg(e),d=null;h&&l?.url&&(d=K0(h,l.url)),t.onEvent(d||ug())};typeof r<"u"&&typeof r.subscribe=="function"&&r.subscribe(null,a);let c=i,u=`${s.packageName.toLowerCase()}://`;qn().handleOpenURL=async l=>{if(l.toLowerCase().startsWith(u)&&a({url:l}),typeof c=="function")try{c(l)}catch(h){console.error(h)}}}},lg=Gl;function ug(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:ge("no-auth-event")}}function hg(n,e){W(n)._logFramework(e)}var X0="@firebase/auth-compat",Z0="0.4.2";var eb=1e3;function Bi(){var n;return((n=self?.location)===null||n===void 0?void 0:n.protocol)||null}function tb(){return Bi()==="http:"||Bi()==="https:"}function fg(n=z()){return!!((Bi()==="file:"||Bi()==="ionic:"||Bi()==="capacitor:")&&n.toLowerCase().match(/iphone|ipad|ipod|android/))}function nb(){return _i()||no()}function rb(){return io()&&document?.documentMode===11}function ib(n=z()){return/Edge\/\d+/.test(n)}function sb(n=z()){return rb()||ib(n)}function pg(){try{let n=self.localStorage,e=Fn();if(n)return n.setItem(e,"1"),n.removeItem(e),sb()?$t():!0}catch{return Yl()&&$t()}return!1}function Yl(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function $l(){return(tb()||ro()||fg())&&!nb()&&pg()&&!Yl()}function mg(){return fg()&&typeof document<"u"}async function ob(){return mg()?new Promise(n=>{let e=setTimeout(()=>{n(!1)},eb);document.addEventListener("deviceready",()=>{clearTimeout(e),n(!0)})}):!1}function ab(){return typeof window<"u"?window:null}var Be={LOCAL:"local",NONE:"none",SESSION:"session"},Ui=v,gg="persistence";function cb(n,e){if(Ui(Object.values(Be).includes(e),n,"invalid-persistence-type"),_i()){Ui(e!==Be.SESSION,n,"unsupported-persistence-type");return}if(no()){Ui(e===Be.NONE,n,"unsupported-persistence-type");return}if(Yl()){Ui(e===Be.NONE||e===Be.LOCAL&&$t(),n,"unsupported-persistence-type");return}Ui(e===Be.NONE||pg(),n,"unsupported-persistence-type")}async function Kl(n){await n._initializationPromise;let e=yg(),t=dt(gg,n.config.apiKey,n.name);e&&e.setItem(t,n._getPersistence())}function ub(n,e){let t=yg();if(!t)return[];let r=dt(gg,n,e);switch(t.getItem(r)){case Be.NONE:return[Yt];case Be.LOCAL:return[Un,mt];case Be.SESSION:return[mt];default:return[]}}function yg(){var n;try{return((n=ab())===null||n===void 0?void 0:n.sessionStorage)||null}catch{return null}}var lb=v,gt=class{constructor(){this.browserResolver=Ae(Bl),this.cordovaResolver=Ae(lg),this.underlyingResolver=null,this._redirectPersistence=mt,this._completeRedirectFn=Bn,this._overrideRedirectResult=xr}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,r,i)}async _openRedirect(e,t,r,i){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,r,i)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return mg()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return lb(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;let e=await ob();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}};function vg(n){return n.unwrap()}function hb(n){return n.wrapped()}function db(n){return wg(n)}function fb(n,e){var t;let r=(t=e.customData)===null||t===void 0?void 0:t._tokenResponse;if(e?.code==="auth/multi-factor-auth-required"){let i=e;i.resolver=new Hl(n,bl(n,e))}else if(r){let i=wg(e),s=e;i&&(s.credential=i,s.tenantId=r.tenantId||void 0,s.email=r.email||void 0,s.phoneNumber=r.phoneNumber||void 0)}}function wg(n){let{_tokenResponse:e}=n instanceof oe?n.customData:n;if(!e)return null;if(!(n instanceof oe)&&"temporaryProof"in e&&"phoneNumber"in e)return tt.credentialFromResult(n);let t=e.providerId;if(!t||t===Ln.PASSWORD)return null;let r;switch(t){case Ln.GOOGLE:r=en;break;case Ln.FACEBOOK:r=Zt;break;case Ln.GITHUB:r=tn;break;case Ln.TWITTER:r=nn;break;default:let{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=e;return!s&&!o&&!i&&!a?null:a?t.startsWith("saml.")?xn._create(t,a):Xe._fromParams({providerId:t,signInMethod:t,pendingToken:a,idToken:i,accessToken:s}):new Sr(t).credential({idToken:i,accessToken:s,rawNonce:c})}return n instanceof oe?r.credentialFromError(n):r.credentialFromResult(n)}function Me(n,e){return e.catch(t=>{throw t instanceof oe&&fb(n,t),t}).then(t=>{let r=t.operationType,i=t.user;return{operationType:r,credential:db(t),additionalUserInfo:Tl(t),user:Pr.getOrCreate(i)}})}async function Wl(n,e){let t=await e;return{verificationId:t.verificationId,confirm:r=>Me(n,t.confirm(r))}}var Hl=class{constructor(e,t){this.resolver=t,this.auth=hb(e)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Me(vg(this.auth),this.resolver.resolveSignIn(e))}};var Pr=class n{constructor(e){this._delegate=e,this.multiFactor=Sl(e)}static getOrCreate(e){return n.USER_MAP.has(e)||n.USER_MAP.set(e,new n(e)),n.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Me(this.auth,Go(this._delegate,e))}async linkWithPhoneNumber(e,t){return Wl(this.auth,Nl(this._delegate,e,t))}async linkWithPopup(e){return Me(this.auth,Pl(this._delegate,e,gt))}async linkWithRedirect(e){return await Kl(W(this.auth)),Fl(this._delegate,e,gt)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Me(this.auth,$o(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Wl(this.auth,kl(this._delegate,e,t))}reauthenticateWithPopup(e){return Me(this.auth,xl(this._delegate,e,gt))}async reauthenticateWithRedirect(e){return await Kl(W(this.auth)),Ml(this._delegate,e,gt)}sendEmailVerification(e){return vl(this._delegate,e)}async unlink(e){return await sl(this._delegate,e),this}updateEmail(e){return Il(this._delegate,e)}updatePassword(e){return El(this._delegate,e)}updatePhoneNumber(e){return Dl(this._delegate,e)}updateProfile(e){return _l(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return wl(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}};Pr.USER_MAP=new WeakMap;var Vi=v,qi=class{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}let{apiKey:r}=e.options;Vi(r,"invalid-api-key",{appName:e.name}),Vi(r,"invalid-api-key",{appName:e.name});let i=typeof window<"u"?gt:void 0;this._delegate=t.initialize({options:{persistence:pb(r,e.name),popupRedirectResolver:i}}),this._delegate._updateErrorMap(Yu),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Pr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){rl(this._delegate,e,t)}applyActionCode(e){return ll(this._delegate,e)}checkActionCode(e){return Ko(this._delegate,e)}confirmPasswordReset(e,t){return ul(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Me(this._delegate,dl(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return yl(this._delegate,e)}isSignInWithEmailLink(e){return ml(this._delegate,e)}async getRedirectResult(){Vi($l(),this._delegate,"operation-not-supported-in-this-environment");let e=await Ul(this._delegate,gt);return e?Me(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){hg(this._delegate,e)}onAuthStateChanged(e,t,r){let{next:i,error:s,complete:o}=dg(e,t,r);return this._delegate.onAuthStateChanged(i,s,o)}onIdTokenChanged(e,t,r){let{next:i,error:s,complete:o}=dg(e,t,r);return this._delegate.onIdTokenChanged(i,s,o)}sendSignInLinkToEmail(e,t){return pl(this._delegate,e,t)}sendPasswordResetEmail(e,t){return cl(this._delegate,e,t||void 0)}async setPersistence(e){cb(this._delegate,e);let t;switch(e){case Be.SESSION:t=mt;break;case Be.LOCAL:t=await Ae(Un)._isAvailable()?Un:Rr;break;case Be.NONE:t=Yt;break;default:return ce("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Me(this._delegate,il(this._delegate))}signInWithCredential(e){return Me(this._delegate,Dr(this._delegate,e))}signInWithCustomToken(e){return Me(this._delegate,al(this._delegate,e))}signInWithEmailAndPassword(e,t){return Me(this._delegate,fl(this._delegate,e,t))}signInWithEmailLink(e,t){return Me(this._delegate,gl(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Wl(this._delegate,Cl(this._delegate,e,t))}async signInWithPopup(e){return Vi($l(),this._delegate,"operation-not-supported-in-this-environment"),Me(this._delegate,Rl(this._delegate,e,gt))}async signInWithRedirect(e){return Vi($l(),this._delegate,"operation-not-supported-in-this-environment"),await Kl(this._delegate),Ll(this._delegate,e,gt)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return hl(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}};qi.Persistence=Be;function dg(n,e,t){let r=n;typeof n!="function"&&({next:r,error:e,complete:t}=n);let i=r;return{next:o=>i(o&&Pr.getOrCreate(o)),error:e,complete:t}}function pb(n,e){let t=ub(n,e);if(typeof self<"u"&&!t.includes(Un)&&t.push(Un),typeof window<"u")for(let r of[Rr,mt])t.includes(r)||t.push(r);return t.includes(Yt)||t.push(Yt),t}var ji=class{constructor(){this.providerId="phone",this._delegate=new tt(vg(Ve.auth()))}static credential(e,t){return tt.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}};ji.PHONE_SIGN_IN_METHOD=tt.PHONE_SIGN_IN_METHOD;ji.PROVIDER_ID=tt.PROVIDER_ID;var mb=v,Ql=class{constructor(e,t,r=Ve.app()){var i;mb((i=r.options)===null||i===void 0?void 0:i.apiKey,"invalid-api-key",{appName:r.name}),this._delegate=new Pi(e,t,r.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}};var gb="auth-compat";function yb(n){n.INTERNAL.registerComponent(new me(gb,e=>{let t=e.getProvider("app-compat").getImmediate(),r=e.getProvider("auth");return new qi(t,r)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:rn.EMAIL_SIGNIN,PASSWORD_RESET:rn.PASSWORD_RESET,RECOVER_EMAIL:rn.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:rn.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:rn.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:rn.VERIFY_EMAIL}},EmailAuthProvider:pt,FacebookAuthProvider:Zt,GithubAuthProvider:tn,GoogleAuthProvider:en,OAuthProvider:Sr,SAMLAuthProvider:xi,PhoneAuthProvider:ji,PhoneMultiFactorGenerator:Cr,RecaptchaVerifier:Ql,TwitterAuthProvider:nn,Auth:qi,AuthCredential:ft,Error:oe}).setInstantiationMode("LAZY").setMultipleInstances(!1)),n.registerVersion(X0,Z0)}yb(Ve);var vb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},rt={},I,vh=vh||{},k=vb||self;function la(n){var e=typeof n;return e=e!="object"?e:n?Array.isArray(n)?"array":e:"null",e=="array"||e=="object"&&typeof n.length=="number"}function ns(n){var e=typeof n;return e=="object"&&n!=null||e=="function"}function wb(n){return Object.prototype.hasOwnProperty.call(n,Jl)&&n[Jl]||(n[Jl]=++_b)}var Jl="closure_uid_"+(1e9*Math.random()>>>0),_b=0;function Ib(n,e,t){return n.call.apply(n.bind,arguments)}function Eb(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function Ce(n,e,t){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Ce=Ib:Ce=Eb,Ce.apply(null,arguments)}function Yo(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function ve(n,e){function t(){}t.prototype=e.prototype,n.$=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function sn(){this.s=this.s,this.o=this.o}var Tb=0;sn.prototype.s=!1;sn.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),Tb!=0)&&wb(this)};sn.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var xg=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if(typeof n=="string")return typeof e!="string"||e.length!=1?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function wh(n){let e=n.length;if(0<e){let t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function _g(n,e){for(let t=1;t<arguments.length;t++){let r=arguments[t];if(la(r)){let i=n.length||0,s=r.length||0;n.length=i+s;for(let o=0;o<s;o++)n[i+o]=r[o]}else n.push(r)}}function Ne(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}Ne.prototype.h=function(){this.defaultPrevented=!0};var bb=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{k.addEventListener("test",()=>{},e),k.removeEventListener("test",()=>{},e)}catch{}return n}();function Hi(n){return/^[\s\xa0]*$/.test(n)}function ha(){var n=k.navigator;return n&&(n=n.userAgent)?n:""}function yt(n){return ha().indexOf(n)!=-1}function _h(n){return _h[" "](n),n}_h[" "]=function(){};function Sb(n,e){var t=fS;return Object.prototype.hasOwnProperty.call(t,n)?t[n]:t[n]=e(n)}var Ab=yt("Opera"),Fr=yt("Trident")||yt("MSIE"),Pg=yt("Edge"),nh=Pg||Fr,Og=yt("Gecko")&&!(ha().toLowerCase().indexOf("webkit")!=-1&&!yt("Edge"))&&!(yt("Trident")||yt("MSIE"))&&!yt("Edge"),Cb=ha().toLowerCase().indexOf("webkit")!=-1&&!yt("Edge");function Lg(){var n=k.document;return n?n.documentMode:void 0}var rh;e:{if(Jo="",Xo=function(){var n=ha();if(Og)return/rv:([^\);]+)(\)|;)/.exec(n);if(Pg)return/Edge\/([\d\.]+)/.exec(n);if(Fr)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n);if(Cb)return/WebKit\/(\S+)/.exec(n);if(Ab)return/(?:Version)[ \/]?(\S+)/.exec(n)}(),Xo&&(Jo=Xo?Xo[1]:""),Fr&&(Zo=Lg(),Zo!=null&&Zo>parseFloat(Jo))){rh=String(Zo);break e}rh=Jo}var Jo,Xo,Zo,ih;k.document&&Fr?(Xl=Lg(),ih=Xl||parseInt(rh,10)||void 0):ih=void 0;var Xl,Nb=ih;function Qi(n,e){if(Ne.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(Og){e:{try{_h(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else t=="mouseover"?e=n.fromElement:t=="mouseout"&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=n.clientX!==void 0?n.clientX:n.pageX,this.clientY=n.clientY!==void 0?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType=typeof n.pointerType=="string"?n.pointerType:kb[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&Qi.$.h.call(this)}}ve(Qi,Ne);var kb={2:"touch",3:"pen",4:"mouse"};Qi.prototype.h=function(){Qi.$.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var rs="closure_listenable_"+(1e6*Math.random()|0),Db=0;function Rb(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.la=i,this.key=++Db,this.fa=this.ia=!1}function da(n){n.fa=!0,n.listener=null,n.proxy=null,n.src=null,n.la=null}function Ih(n,e,t){for(let r in n)e.call(t,n[r],r,n)}function xb(n,e){for(let t in n)e.call(void 0,n[t],t,n)}function Mg(n){let e={};for(let t in n)e[t]=n[t];return e}var Ig="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Fg(n,e){let t,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(t in r)n[t]=r[t];for(let s=0;s<Ig.length;s++)t=Ig[s],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function fa(n){this.src=n,this.g={},this.h=0}fa.prototype.add=function(n,e,t,r,i){var s=n.toString();n=this.g[s],n||(n=this.g[s]=[],this.h++);var o=oh(n,e,r,i);return-1<o?(e=n[o],t||(e.ia=!1)):(e=new Rb(e,this.src,s,!!r,i),e.ia=t,n.push(e)),e};function sh(n,e){var t=e.type;if(t in n.g){var r=n.g[t],i=xg(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(da(e),n.g[t].length==0&&(delete n.g[t],n.h--))}}function oh(n,e,t,r){for(var i=0;i<n.length;++i){var s=n[i];if(!s.fa&&s.listener==e&&s.capture==!!t&&s.la==r)return i}return-1}var Eh="closure_lm_"+(1e6*Math.random()|0),Zl={};function Ug(n,e,t,r,i){if(r&&r.once)return Bg(n,e,t,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)Ug(n,e[s],t,r,i);return null}return t=Sh(t),n&&n[rs]?n.O(e,t,ns(r)?!!r.capture:!!r,i):Vg(n,e,t,!1,r,i)}function Vg(n,e,t,r,i,s){if(!e)throw Error("Invalid event type");var o=ns(i)?!!i.capture:!!i,a=bh(n);if(a||(n[Eh]=a=new fa(n)),t=a.add(e,t,r,o,s),t.proxy)return t;if(r=Pb(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)bb||(i=o),i===void 0&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(jg(e.toString()),r);else if(n.addListener&&n.removeListener)n.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return t}function Pb(){function n(t){return e.call(n.src,n.listener,t)}let e=Ob;return n}function Bg(n,e,t,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)Bg(n,e[s],t,r,i);return null}return t=Sh(t),n&&n[rs]?n.P(e,t,ns(r)?!!r.capture:!!r,i):Vg(n,e,t,!0,r,i)}function qg(n,e,t,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)qg(n,e[s],t,r,i);else r=ns(r)?!!r.capture:!!r,t=Sh(t),n&&n[rs]?(n=n.i,e=String(e).toString(),e in n.g&&(s=n.g[e],t=oh(s,t,r,i),-1<t&&(da(s[t]),Array.prototype.splice.call(s,t,1),s.length==0&&(delete n.g[e],n.h--)))):n&&(n=bh(n))&&(e=n.g[e.toString()],n=-1,e&&(n=oh(e,t,r,i)),(t=-1<n?e[n]:null)&&Th(t))}function Th(n){if(typeof n!="number"&&n&&!n.fa){var e=n.src;if(e&&e[rs])sh(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(jg(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=bh(e))?(sh(t,n),t.h==0&&(t.src=null,e[Eh]=null)):da(n)}}}function jg(n){return n in Zl?Zl[n]:Zl[n]="on"+n}function Ob(n,e){if(n.fa)n=!0;else{e=new Qi(e,this);var t=n.listener,r=n.la||n.src;n.ia&&Th(n),n=t.call(r,e)}return n}function bh(n){return n=n[Eh],n instanceof fa?n:null}var eh="__closure_events_fn_"+(1e9*Math.random()>>>0);function Sh(n){return typeof n=="function"?n:(n[eh]||(n[eh]=function(e){return n.handleEvent(e)}),n[eh])}function ye(){sn.call(this),this.i=new fa(this),this.S=this,this.J=null}ve(ye,sn);ye.prototype[rs]=!0;ye.prototype.removeEventListener=function(n,e,t,r){qg(this,n,e,t,r)};function be(n,e){var t,r=n.J;if(r)for(t=[];r;r=r.J)t.push(r);if(n=n.S,r=e.type||e,typeof e=="string")e=new Ne(e,n);else if(e instanceof Ne)e.target=e.target||n;else{var i=e;e=new Ne(r,n),Fg(e,i)}if(i=!0,t)for(var s=t.length-1;0<=s;s--){var o=e.g=t[s];i=ea(o,r,!0,e)&&i}if(o=e.g=n,i=ea(o,r,!0,e)&&i,i=ea(o,r,!1,e)&&i,t)for(s=0;s<t.length;s++)o=e.g=t[s],i=ea(o,r,!1,e)&&i}ye.prototype.N=function(){if(ye.$.N.call(this),this.i){var n=this.i,e;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)da(t[r]);delete n.g[e],n.h--}}this.J=null};ye.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)};ye.prototype.P=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};function ea(n,e,t,r){if(e=n.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==t){var a=o.listener,c=o.la||o.src;o.ia&&sh(n.i,o),i=a.call(c,r)!==!1&&i}}return i&&!r.defaultPrevented}var Ah=k.JSON.stringify,ah=class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function Lb(){var n=Ch;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var ch=class{constructor(){this.h=this.g=null}add(e,t){let r=zg.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},zg=new ah(()=>new uh,n=>n.reset()),uh=class{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}};function Mb(n){var e=1;n=n.split(":");let t=[];for(;0<e&&n.length;)t.push(n.shift()),e--;return n.length&&t.push(n.join(":")),t}function Fb(n){k.setTimeout(()=>{throw n},0)}var Yi,Ji=!1,Ch=new ch,Gg=()=>{let n=k.Promise.resolve(void 0);Yi=()=>{n.then(Ub)}},Ub=()=>{for(var n;n=Lb();){try{n.h.call(n.g)}catch(t){Fb(t)}var e=zg;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}Ji=!1};function pa(n,e){ye.call(this),this.h=n||1,this.g=e||k,this.j=Ce(this.qb,this),this.l=Date.now()}ve(pa,ye);I=pa.prototype;I.ga=!1;I.T=null;I.qb=function(){if(this.ga){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-n):(this.T&&(this.g.clearTimeout(this.T),this.T=null),be(this,"tick"),this.ga&&(Nh(this),this.start()))}};I.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Nh(n){n.ga=!1,n.T&&(n.g.clearTimeout(n.T),n.T=null)}I.N=function(){pa.$.N.call(this),Nh(this),delete this.g};function kh(n,e,t){if(typeof n=="function")t&&(n=Ce(n,t));else if(n&&typeof n.handleEvent=="function")n=Ce(n.handleEvent,n);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:k.setTimeout(n,e||0)}function $g(n){n.g=kh(()=>{n.g=null,n.i&&(n.i=!1,$g(n))},n.j);let e=n.h;n.h=null,n.m.apply(null,e)}var lh=class extends sn{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:$g(this)}N(){super.N(),this.g&&(k.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function Xi(n){sn.call(this),this.h=n,this.g={}}ve(Xi,sn);var Eg=[];function Kg(n,e,t,r){Array.isArray(t)||(t&&(Eg[0]=t.toString()),t=Eg);for(var i=0;i<t.length;i++){var s=Ug(e,t[i],r||n.handleEvent,!1,n.h||n);if(!s)break;n.g[s.key]=s}}function Wg(n){Ih(n.g,function(e,t){this.g.hasOwnProperty(t)&&Th(e)},n),n.g={}}Xi.prototype.N=function(){Xi.$.N.call(this),Wg(this)};Xi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function ma(){this.g=!0}ma.prototype.Ea=function(){this.g=!1};function Vb(n,e,t,r,i,s){n.info(function(){if(n.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&h[1]=="type"?o+(l+"="+u+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+t+`
`+o})}function Bb(n,e,t,r,i,s,o){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+t+`
`+s+" "+o})}function Lr(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+jb(n,t)+(r?" "+r:"")})}function qb(n,e){n.info(function(){return"TIMEOUT: "+e})}ma.prototype.info=function(){};function jb(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t){for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return Ah(t)}catch{return e}}var $n={},Tg=null;function ga(){return Tg=Tg||new ye}$n.Ta="serverreachability";function Hg(n){Ne.call(this,$n.Ta,n)}ve(Hg,Ne);function Zi(n){let e=ga();be(e,new Hg(e))}$n.STAT_EVENT="statevent";function Qg(n,e){Ne.call(this,$n.STAT_EVENT,n),this.stat=e}ve(Qg,Ne);function xe(n){let e=ga();be(e,new Qg(e,n))}$n.Ua="timingevent";function Yg(n,e){Ne.call(this,$n.Ua,n),this.size=e}ve(Yg,Ne);function is(n,e){if(typeof n!="function")throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){n()},e)}var ya={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},Jg={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Dh(){}Dh.prototype.h=null;function bg(n){return n.h||(n.h=n.i())}function Xg(){}var ss={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Rh(){Ne.call(this,"d")}ve(Rh,Ne);function xh(){Ne.call(this,"c")}ve(xh,Ne);var hh;function va(){}ve(va,Dh);va.prototype.g=function(){return new XMLHttpRequest};va.prototype.i=function(){return{}};hh=new va;function os(n,e,t,r){this.l=n,this.j=e,this.m=t,this.W=r||1,this.U=new Xi(this),this.P=zb,n=nh?125:void 0,this.V=new pa(n),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new Zg}function Zg(){this.i=null,this.g="",this.h=!1}var zb=45e3,dh={},ra={};I=os.prototype;I.setTimeout=function(n){this.P=n};function fh(n,e,t){n.L=1,n.v=_a(Mt(e)),n.s=t,n.S=!0,ey(n,null)}function ey(n,e){n.G=Date.now(),as(n),n.A=Mt(n.v);var t=n.A,r=n.W;Array.isArray(r)||(r=[String(r)]),cy(t.i,"t",r),n.C=0,t=n.l.J,n.h=new Zg,n.g=ky(n.l,t?e:null,!n.s),0<n.O&&(n.M=new lh(Ce(n.Pa,n,n.g),n.O)),Kg(n.U,n.g,"readystatechange",n.nb),e=n.I?Mg(n.I):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ha(n.A,n.u,n.s,e)):(n.u="GET",n.g.ha(n.A,n.u,null,e)),Zi(),Vb(n.j,n.u,n.A,n.m,n.W,n.s)}I.nb=function(n){n=n.target;let e=this.M;e&&vt(n)==3?e.l():this.Pa(n)};I.Pa=function(n){try{if(n==this.g)e:{let l=vt(this.g);var e=this.g.Ia();let h=this.g.da();if(!(3>l)&&(l!=3||nh||this.g&&(this.h.h||this.g.ja()||Ng(this.g)))){this.J||l!=4||e==7||(e==8||0>=h?Zi(3):Zi(2)),wa(this);var t=this.g.da();this.ca=t;t:if(ty(this)){var r=Ng(this.g);n="";var i=r.length,s=vt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){jn(this),Wi(this);var o="";break t}this.h.i=new k.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=t==200,Bb(this.j,this.u,this.A,this.m,this.W,l,t),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Hi(a)){var u=a;break t}}u=null}if(t=u)Lr(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ph(this,t);else{this.i=!1,this.o=3,xe(12),jn(this),Wi(this);break e}}this.S?(ny(this,l,o),nh&&this.i&&l==3&&(Kg(this.U,this.V,"tick",this.mb),this.V.start())):(Lr(this.j,this.m,o,null),ph(this,o)),l==4&&jn(this),this.i&&!this.J&&(l==4?Sy(this.l,this):(this.i=!1,as(this)))}else lS(this.g),t==400&&0<o.indexOf("Unknown SID")?(this.o=3,xe(12)):(this.o=0,xe(13)),jn(this),Wi(this)}}}catch{}finally{}};function ty(n){return n.g?n.u=="GET"&&n.L!=2&&n.l.Ha:!1}function ny(n,e,t){let r=!0,i;for(;!n.J&&n.C<t.length;)if(i=Gb(n,t),i==ra){e==4&&(n.o=4,xe(14),r=!1),Lr(n.j,n.m,null,"[Incomplete Response]");break}else if(i==dh){n.o=4,xe(15),Lr(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}else Lr(n.j,n.m,i,null),ph(n,i);ty(n)&&i!=ra&&i!=dh&&(n.h.g="",n.C=0),e!=4||t.length!=0||n.h.h||(n.o=1,xe(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.ba&&(n.ba=!0,e=n.l,e.g==n&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+t.length),Uh(e),e.M=!0,xe(11))):(Lr(n.j,n.m,t,"[Invalid Chunked Response]"),jn(n),Wi(n))}I.mb=function(){if(this.g){var n=vt(this.g),e=this.g.ja();this.C<e.length&&(wa(this),ny(this,n,e),this.i&&n!=4&&as(this))}};function Gb(n,e){var t=n.C,r=e.indexOf(`
`,t);return r==-1?ra:(t=Number(e.substring(t,r)),isNaN(t)?dh:(r+=1,r+t>e.length?ra:(e=e.slice(r,r+t),n.C=r+t,e)))}I.cancel=function(){this.J=!0,jn(this)};function as(n){n.Y=Date.now()+n.P,ry(n,n.P)}function ry(n,e){if(n.B!=null)throw Error("WatchDog timer not null");n.B=is(Ce(n.lb,n),e)}function wa(n){n.B&&(k.clearTimeout(n.B),n.B=null)}I.lb=function(){this.B=null;let n=Date.now();0<=n-this.Y?(qb(this.j,this.A),this.L!=2&&(Zi(),xe(17)),jn(this),this.o=2,Wi(this)):ry(this,this.Y-n)};function Wi(n){n.l.H==0||n.J||Sy(n.l,n)}function jn(n){wa(n);var e=n.M;e&&typeof e.sa=="function"&&e.sa(),n.M=null,Nh(n.V),Wg(n.U),n.g&&(e=n.g,n.g=null,e.abort(),e.sa())}function ph(n,e){try{var t=n.l;if(t.H!=0&&(t.g==n||mh(t.i,n))){if(!n.K&&mh(t.i,n)&&t.H==3){try{var r=t.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!t.u){if(t.g)if(t.g.G+3e3<n.G)oa(t),Ta(t);else break e;Fh(t),xe(18)}}else t.Fa=i[1],0<t.Fa-t.V&&37500>i[2]&&t.G&&t.A==0&&!t.v&&(t.v=is(Ce(t.ib,t),6e3));if(1>=hy(t.i)&&t.oa){try{t.oa()}catch{}t.oa=void 0}}else zn(t,11)}else if((n.K||t.g==n)&&oa(t),!Hi(e))for(i=t.Ja.g.parse(e),e=0;e<i.length;e++){let u=i[e];if(t.V=u[0],u=u[1],t.H==2)if(u[0]=="c"){t.K=u[1],t.pa=u[2];let l=u[3];l!=null&&(t.ra=l,t.l.info("VER="+t.ra));let h=u[4];h!=null&&(t.Ga=h,t.l.info("SVER="+t.Ga));let d=u[5];d!=null&&typeof d=="number"&&0<d&&(r=1.5*d,t.L=r,t.l.info("backChannelRequestTimeoutMs_="+r)),r=t;let m=n.g;if(m){let w=m.g?m.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(w){var s=r.i;s.g||w.indexOf("spdy")==-1&&w.indexOf("quic")==-1&&w.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Ph(s,s.h),s.h=null))}if(r.F){let T=m.g?m.g.getResponseHeader("X-HTTP-Session-Id"):null;T&&(r.Da=T,$(r.I,r.F,T))}}t.H=3,t.h&&t.h.Ba(),t.ca&&(t.S=Date.now()-n.G,t.l.info("Handshake RTT: "+t.S+"ms")),r=t;var o=n;if(r.wa=Ny(r,r.J?r.pa:null,r.Y),o.K){dy(r.i,o);var a=o,c=r.L;c&&a.setTimeout(c),a.B&&(wa(a),as(a)),r.g=o}else Ty(r);0<t.j.length&&ba(t)}else u[0]!="stop"&&u[0]!="close"||zn(t,7);else t.H==3&&(u[0]=="stop"||u[0]=="close"?u[0]=="stop"?zn(t,7):Mh(t):u[0]!="noop"&&t.h&&t.h.Aa(u),t.A=0)}}Zi(4)}catch{}}function $b(n){if(n.Z&&typeof n.Z=="function")return n.Z();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if(typeof n=="string")return n.split("");if(la(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}e=[],t=0;for(r in n)e[t++]=n[r];return e}function Kb(n){if(n.ta&&typeof n.ta=="function")return n.ta();if(!n.Z||typeof n.Z!="function"){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(la(n)||typeof n=="string"){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(let r in n)e[t++]=r;return e}}}function iy(n,e){if(n.forEach&&typeof n.forEach=="function")n.forEach(e,void 0);else if(la(n)||typeof n=="string")Array.prototype.forEach.call(n,e,void 0);else for(var t=Kb(n),r=$b(n),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],t&&t[s],n)}var sy=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wb(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var s=n[t].substring(0,r);i=n[t].substring(r+1)}else s=n[t];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Gn(n){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Gn){this.h=n.h,ia(this,n.j),this.s=n.s,this.g=n.g,sa(this,n.m),this.l=n.l;var e=n.i,t=new es;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),Sg(this,t),this.o=n.o}else n&&(e=String(n).match(sy))?(this.h=!1,ia(this,e[1]||"",!0),this.s=$i(e[2]||""),this.g=$i(e[3]||"",!0),sa(this,e[4]),this.l=$i(e[5]||"",!0),Sg(this,e[6]||"",!0),this.o=$i(e[7]||"")):(this.h=!1,this.i=new es(null,this.h))}Gn.prototype.toString=function(){var n=[],e=this.j;e&&n.push(Ki(e,Ag,!0),":");var t=this.g;return(t||e=="file")&&(n.push("//"),(e=this.s)&&n.push(Ki(e,Ag,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t=this.m,t!=null&&n.push(":",String(t))),(t=this.l)&&(this.g&&t.charAt(0)!="/"&&n.push("/"),n.push(Ki(t,t.charAt(0)=="/"?Yb:Qb,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",Ki(t,Xb)),n.join("")};function Mt(n){return new Gn(n)}function ia(n,e,t){n.j=t?$i(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function sa(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function Sg(n,e,t){e instanceof es?(n.i=e,Zb(n.i,n.h)):(t||(e=Ki(e,Jb)),n.i=new es(e,n.h))}function $(n,e,t){n.i.set(e,t)}function _a(n){return $(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function $i(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function Ki(n,e,t){return typeof n=="string"?(n=encodeURI(n).replace(e,Hb),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function Hb(n){return n=n.charCodeAt(0),"%"+(n>>4&15).toString(16)+(n&15).toString(16)}var Ag=/[#\/\?@]/g,Qb=/[#\?:]/g,Yb=/[#\?]/g,Jb=/[#\?@]/g,Xb=/#/g;function es(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function on(n){n.g||(n.g=new Map,n.h=0,n.i&&Wb(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}I=es.prototype;I.add=function(n,e){on(this),this.i=null,n=Ur(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this};function oy(n,e){on(n),e=Ur(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function ay(n,e){return on(n),e=Ur(n,e),n.g.has(e)}I.forEach=function(n,e){on(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)};I.ta=function(){on(this);let n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){let i=n[r];for(let s=0;s<i.length;s++)t.push(e[r])}return t};I.Z=function(n){on(this);let e=[];if(typeof n=="string")ay(this,n)&&(e=e.concat(this.g.get(Ur(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e};I.set=function(n,e){return on(this),this.i=null,n=Ur(this,n),ay(this,n)&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this};I.get=function(n,e){return n?(n=this.Z(n),0<n.length?String(n[0]):e):e};function cy(n,e,t){oy(n,e),0<t.length&&(n.i=null,n.g.set(Ur(n,e),wh(t)),n.h+=t.length)}I.toString=function(){if(this.i)return this.i;if(!this.g)return"";let n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),n.push(i)}}return this.i=n.join("&")};function Ur(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function Zb(n,e){e&&!n.j&&(on(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(oy(this,r),cy(this,i,t))},n)),n.j=e}var eS=class{constructor(n,e){this.g=n,this.map=e}};function uy(n){this.l=n||tS,k.PerformanceNavigationTiming?(n=k.performance.getEntriesByType("navigation"),n=0<n.length&&(n[0].nextHopProtocol=="hq"||n[0].nextHopProtocol=="h2")):n=!!(k.g&&k.g.Ka&&k.g.Ka()&&k.g.Ka().ec),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var tS=10;function ly(n){return n.h?!0:n.g?n.g.size>=n.j:!1}function hy(n){return n.h?1:n.g?n.g.size:0}function mh(n,e){return n.h?n.h==e:n.g?n.g.has(e):!1}function Ph(n,e){n.g?n.g.add(e):n.h=e}function dy(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}uy.prototype.cancel=function(){if(this.i=fy(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let n of this.g.values())n.cancel();this.g.clear()}};function fy(n){if(n.h!=null)return n.i.concat(n.h.F);if(n.g!=null&&n.g.size!==0){let e=n.i;for(let t of n.g.values())e=e.concat(t.F);return e}return wh(n.i)}var nS=class{stringify(n){return k.JSON.stringify(n,void 0)}parse(n){return k.JSON.parse(n,void 0)}};function rS(){this.g=new nS}function iS(n,e,t){let r=t||"";try{iy(n,function(i,s){let o=i;ns(i)&&(o=Ah(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function sS(n,e){let t=new ma;if(k.Image){let r=new Image;r.onload=Yo(ta,t,r,"TestLoadImage: loaded",!0,e),r.onerror=Yo(ta,t,r,"TestLoadImage: error",!1,e),r.onabort=Yo(ta,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=Yo(ta,t,r,"TestLoadImage: timeout",!1,e),k.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}function ta(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function cs(n){this.l=n.fc||null,this.j=n.ob||!1}ve(cs,Dh);cs.prototype.g=function(){return new Ia(this.l,this.j)};cs.prototype.i=function(n){return function(){return n}}({});function Ia(n,e){ye.call(this),this.F=n,this.u=e,this.m=void 0,this.readyState=Oh,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ve(Ia,ye);var Oh=0;I=Ia.prototype;I.open=function(n,e){if(this.readyState!=Oh)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,ts(this)};I.send=function(n){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.F||k).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};I.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,us(this)),this.readyState=Oh};I.$a=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,ts(this)),this.g&&(this.readyState=3,ts(this),this.g)))if(this.responseType==="arraybuffer")n.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof k.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;py(this)}else n.text().then(this.Za.bind(this),this.ka.bind(this))};function py(n){n.j.read().then(n.Xa.bind(n)).catch(n.ka.bind(n))}I.Xa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?us(this):ts(this),this.readyState==3&&py(this)}};I.Za=function(n){this.g&&(this.response=this.responseText=n,us(this))};I.Ya=function(n){this.g&&(this.response=n,us(this))};I.ka=function(){this.g&&us(this)};function us(n){n.readyState=4,n.l=null,n.j=null,n.A=null,ts(n)}I.setRequestHeader=function(n,e){this.v.append(n,e)};I.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""};I.getAllResponseHeaders=function(){if(!this.h)return"";let n=[],e=this.h.entries();for(var t=e.next();!t.done;)t=t.value,n.push(t[0]+": "+t[1]),t=e.next();return n.join(`\r
`)};function ts(n){n.onreadystatechange&&n.onreadystatechange.call(n)}Object.defineProperty(Ia.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(n){this.m=n?"include":"same-origin"}});var oS=k.JSON.parse;function te(n){ye.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=my,this.L=this.M=!1}ve(te,ye);var my="",aS=/^https?$/i,cS=["POST","PUT"];I=te.prototype;I.Oa=function(n){this.M=n};I.ha=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+n);e=e?e.toUpperCase():"GET",this.I=n,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():hh.g(),this.C=this.u?bg(this.u):bg(hh),this.g.onreadystatechange=Ce(this.La,this);try{this.G=!0,this.g.open(e,String(n),!0),this.G=!1}catch(s){Cg(this,s);return}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())t.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(t.keys()).find(s=>s.toLowerCase()=="content-type"),i=k.FormData&&n instanceof k.FormData,!(0<=xg(cS,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of t)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{vy(this),0<this.B&&((this.L=uS(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ce(this.ua,this)):this.A=kh(this.ua,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(s){Cg(this,s)}};function uS(n){return Fr&&typeof n.timeout=="number"&&n.ontimeout!==void 0}I.ua=function(){typeof vh<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,be(this,"timeout"),this.abort(8))};function Cg(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,gy(n),Ea(n)}function gy(n){n.F||(n.F=!0,be(n,"complete"),be(n,"error"))}I.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,be(this,"complete"),be(this,"abort"),Ea(this))};I.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ea(this,!0)),te.$.N.call(this)};I.La=function(){this.s||(this.G||this.v||this.l?yy(this):this.kb())};I.kb=function(){yy(this)};function yy(n){if(n.h&&typeof vh<"u"&&(!n.C[1]||vt(n)!=4||n.da()!=2)){if(n.v&&vt(n)==4)kh(n.La,0,n);else if(be(n,"readystatechange"),vt(n)==4){n.h=!1;try{let o=n.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=o===0){var i=String(n.I).match(sy)[1]||null;!i&&k.self&&k.self.location&&(i=k.self.location.protocol.slice(0,-1)),r=!aS.test(i?i.toLowerCase():"")}t=r}if(t)be(n,"complete"),be(n,"success");else{n.m=6;try{var s=2<vt(n)?n.g.statusText:""}catch{s=""}n.j=s+" ["+n.da()+"]",gy(n)}}finally{Ea(n)}}}}function Ea(n,e){if(n.g){vy(n);let t=n.g,r=n.C[0]?()=>{}:null;n.g=null,n.C=null,e||be(n,"ready");try{t.onreadystatechange=r}catch{}}}function vy(n){n.g&&n.L&&(n.g.ontimeout=null),n.A&&(k.clearTimeout(n.A),n.A=null)}I.isActive=function(){return!!this.g};function vt(n){return n.g?n.g.readyState:0}I.da=function(){try{return 2<vt(this)?this.g.status:-1}catch{return-1}};I.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};I.Wa=function(n){if(this.g){var e=this.g.responseText;return n&&e.indexOf(n)==0&&(e=e.substring(n.length)),oS(e)}};function Ng(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.K){case my:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function lS(n){let e={};n=(n.g&&2<=vt(n)&&n.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<n.length;r++){if(Hi(n[r]))continue;var t=Mb(n[r]);let i=t[0];if(t=t[1],typeof t!="string")continue;t=t.trim();let s=e[i]||[];e[i]=s,s.push(t)}xb(e,function(r){return r.join(", ")})}I.Ia=function(){return this.m};I.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function wy(n){let e="";return Ih(n,function(t,r){e+=r,e+=":",e+=t,e+=`\r
`}),e}function Lh(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=wy(t),typeof n=="string"?t!=null&&encodeURIComponent(String(t)):$(n,e,t))}function zi(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function _y(n){this.Ga=0,this.j=[],this.l=new ma,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=zi("failFast",!1,n),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=zi("baseRetryDelayMs",5e3,n),this.hb=zi("retryDelaySeedMs",1e4,n),this.eb=zi("forwardChannelMaxRetries",2,n),this.xa=zi("forwardChannelRequestTimeoutMs",2e4,n),this.va=n&&n.xmlHttpFactory||void 0,this.Ha=n&&n.dc||!1,this.L=void 0,this.J=n&&n.supportsCrossDomainXhr||!1,this.K="",this.i=new uy(n&&n.concurrentRequestLimit),this.Ja=new rS,this.P=n&&n.fastHandshake||!1,this.O=n&&n.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=n&&n.bc||!1,n&&n.Ea&&this.l.Ea(),n&&n.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&n&&n.detectBufferingProxy||!1,this.qa=void 0,n&&n.longPollingTimeout&&0<n.longPollingTimeout&&(this.qa=n.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}I=_y.prototype;I.ra=8;I.H=1;function Mh(n){if(Iy(n),n.H==3){var e=n.W++,t=Mt(n.I);if($(t,"SID",n.K),$(t,"RID",e),$(t,"TYPE","terminate"),ls(n,t),e=new os(n,n.l,e),e.L=2,e.v=_a(Mt(t)),t=!1,k.navigator&&k.navigator.sendBeacon)try{t=k.navigator.sendBeacon(e.v.toString(),"")}catch{}!t&&k.Image&&(new Image().src=e.v,t=!0),t||(e.g=ky(e.l,null),e.g.ha(e.v)),e.G=Date.now(),as(e)}Cy(n)}function Ta(n){n.g&&(Uh(n),n.g.cancel(),n.g=null)}function Iy(n){Ta(n),n.u&&(k.clearTimeout(n.u),n.u=null),oa(n),n.i.cancel(),n.m&&(typeof n.m=="number"&&k.clearTimeout(n.m),n.m=null)}function ba(n){if(!ly(n.i)&&!n.m){n.m=!0;var e=n.Na;Yi||Gg(),Ji||(Yi(),Ji=!0),Ch.add(e,n),n.C=0}}function hS(n,e){return hy(n.i)>=n.i.j-(n.m?1:0)?!1:n.m?(n.j=e.F.concat(n.j),!0):n.H==1||n.H==2||n.C>=(n.cb?0:n.eb)?!1:(n.m=is(Ce(n.Na,n,e),Ay(n,n.C)),n.C++,!0)}I.Na=function(n){if(this.m)if(this.m=null,this.H==1){if(!n){this.W=Math.floor(1e5*Math.random()),n=this.W++;let i=new os(this,this.l,n),s=this.s;if(this.U&&(s?(s=Mg(s),Fg(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,t=0;t<this.j.length;t++){t:{var r=this.j[t];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=t;break e}if(e===4096||t===this.j.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Ey(this,i,e),t=Mt(this.I),$(t,"RID",n),$(t,"CVER",22),this.F&&$(t,"X-HTTP-Session-Id",this.F),ls(this,t),s&&(this.O?e="headers="+encodeURIComponent(String(wy(s)))+"&"+e:this.o&&Lh(t,this.o,s)),Ph(this.i,i),this.bb&&$(t,"TYPE","init"),this.P?($(t,"$req",e),$(t,"SID","null"),i.aa=!0,fh(i,t,null)):fh(i,t,e),this.H=2}}else this.H==3&&(n?kg(this,n):this.j.length==0||ly(this.i)||kg(this))};function kg(n,e){var t;e?t=e.m:t=n.W++;let r=Mt(n.I);$(r,"SID",n.K),$(r,"RID",t),$(r,"AID",n.V),ls(n,r),n.o&&n.s&&Lh(r,n.o,n.s),t=new os(n,n.l,t,n.C+1),n.o===null&&(t.I=n.s),e&&(n.j=e.F.concat(n.j)),e=Ey(n,t,1e3),t.setTimeout(Math.round(.5*n.xa)+Math.round(.5*n.xa*Math.random())),Ph(n.i,t),fh(t,r,e)}function ls(n,e){n.na&&Ih(n.na,function(t,r){$(e,r,t)}),n.h&&iy({},function(t,r){$(e,r,t)})}function Ey(n,e,t){t=Math.min(n.j.length,t);var r=n.h?Ce(n.h.Va,n.h,n):null;e:{var i=n.j;let s=-1;for(;;){let o=["count="+t];s==-1?0<t?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let c=0;c<t;c++){let u=i[c].g,l=i[c].map;if(u-=s,0>u)s=Math.max(0,i[c].g-100),a=!1;else try{iS(l,o,"req"+u+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return n=n.j.splice(0,t),e.F=n,r}function Ty(n){if(!n.g&&!n.u){n.ba=1;var e=n.Ma;Yi||Gg(),Ji||(Yi(),Ji=!0),Ch.add(e,n),n.A=0}}function Fh(n){return n.g||n.u||3<=n.A?!1:(n.ba++,n.u=is(Ce(n.Ma,n),Ay(n,n.A)),n.A++,!0)}I.Ma=function(){if(this.u=null,by(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var n=2*this.S;this.l.info("BP detection timer enabled: "+n),this.B=is(Ce(this.jb,this),n)}};I.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,xe(10),Ta(this),by(this))};function Uh(n){n.B!=null&&(k.clearTimeout(n.B),n.B=null)}function by(n){n.g=new os(n,n.l,"rpc",n.ba),n.o===null&&(n.g.I=n.s),n.g.O=0;var e=Mt(n.wa);$(e,"RID","rpc"),$(e,"SID",n.K),$(e,"AID",n.V),$(e,"CI",n.G?"0":"1"),!n.G&&n.qa&&$(e,"TO",n.qa),$(e,"TYPE","xmlhttp"),ls(n,e),n.o&&n.s&&Lh(e,n.o,n.s),n.L&&n.g.setTimeout(n.L);var t=n.g;n=n.pa,t.L=1,t.v=_a(Mt(e)),t.s=null,t.S=!0,ey(t,n)}I.ib=function(){this.v!=null&&(this.v=null,Ta(this),Fh(this),xe(19))};function oa(n){n.v!=null&&(k.clearTimeout(n.v),n.v=null)}function Sy(n,e){var t=null;if(n.g==e){oa(n),Uh(n),n.g=null;var r=2}else if(mh(n.i,e))t=e.F,dy(n.i,e),r=1;else return;if(n.H!=0){if(e.i)if(r==1){t=e.s?e.s.length:0,e=Date.now()-e.G;var i=n.C;r=ga(),be(r,new Yg(r,t)),ba(n)}else Ty(n);else if(i=e.o,i==3||i==0&&0<e.ca||!(r==1&&hS(n,e)||r==2&&Fh(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),i){case 1:zn(n,5);break;case 4:zn(n,10);break;case 3:zn(n,6);break;default:zn(n,2)}}}function Ay(n,e){let t=n.ab+Math.floor(Math.random()*n.hb);return n.isActive()||(t*=2),t*e}function zn(n,e){if(n.l.info("Error code "+e),e==2){var t=null;n.h&&(t=null);var r=Ce(n.pb,n);t||(t=new Gn("//www.google.com/images/cleardot.gif"),k.location&&k.location.protocol=="http"||ia(t,"https"),_a(t)),sS(t.toString(),r)}else xe(2);n.H=0,n.h&&n.h.za(e),Cy(n),Iy(n)}I.pb=function(n){n?(this.l.info("Successfully pinged google.com"),xe(2)):(this.l.info("Failed to ping google.com"),xe(1))};function Cy(n){if(n.H=0,n.ma=[],n.h){let e=fy(n.i);(e.length!=0||n.j.length!=0)&&(_g(n.ma,e),_g(n.ma,n.j),n.i.i.length=0,wh(n.j),n.j.length=0),n.h.ya()}}function Ny(n,e,t){var r=t instanceof Gn?Mt(t):new Gn(t);if(r.g!="")e&&(r.g=e+"."+r.g),sa(r,r.m);else{var i=k.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Gn(null);r&&ia(s,r),e&&(s.g=e),i&&sa(s,i),t&&(s.l=t),r=s}return t=n.F,e=n.Da,t&&e&&$(r,t,e),$(r,"VER",n.ra),ls(n,r),r}function ky(n,e,t){if(e&&!n.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t&&n.Ha&&!n.va?new te(new cs({ob:!0})):new te(n.va),e.Oa(n.J),e}I.isActive=function(){return!!this.h&&this.h.isActive(this)};function Dy(){}I=Dy.prototype;I.Ba=function(){};I.Aa=function(){};I.za=function(){};I.ya=function(){};I.isActive=function(){return!0};I.Va=function(){};function aa(){if(Fr&&!(10<=Number(Nb)))throw Error("Environmental error: no available transport.")}aa.prototype.g=function(n,e){return new qe(n,e)};function qe(n,e){ye.call(this),this.g=new _y(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(n?n["X-WebChannel-Client-Profile"]=e.Ca:n={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=n,(n=e&&e.cc)&&!Hi(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Hi(e)&&(this.g.F=e,n=this.h,n!==null&&e in n&&(n=this.h,e in n&&delete n[e])),this.j=new Vr(this)}ve(qe,ye);qe.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var n=this.g,e=this.l,t=this.h||void 0;xe(0),n.Y=e,n.na=t||{},n.G=n.aa,n.I=Ny(n,null,n.Y),ba(n)};qe.prototype.close=function(){Mh(this.g)};qe.prototype.u=function(n){var e=this.g;if(typeof n=="string"){var t={};t.__data__=n,n=t}else this.v&&(t={},t.__data__=Ah(n),n=t);e.j.push(new eS(e.fb++,n)),e.H==3&&ba(e)};qe.prototype.N=function(){this.g.h=null,delete this.j,Mh(this.g),delete this.g,qe.$.N.call(this)};function Ry(n){Rh.call(this),n.__headers__&&(this.headers=n.__headers__,this.statusCode=n.__status__,delete n.__headers__,delete n.__status__);var e=n.__sm__;if(e){e:{for(let t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=e!==null&&n in e?e[n]:void 0),this.data=e}else this.data=n}ve(Ry,Rh);function xy(){xh.call(this),this.status=1}ve(xy,xh);function Vr(n){this.g=n}ve(Vr,Dy);Vr.prototype.Ba=function(){be(this.g,"a")};Vr.prototype.Aa=function(n){be(this.g,new Ry(n))};Vr.prototype.za=function(n){be(this.g,new xy)};Vr.prototype.ya=function(){be(this.g,"b")};function dS(){this.blockSize=-1}function nt(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}ve(nt,dS);nt.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function th(n,e,t){t||(t=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(t++)|e.charCodeAt(t++)<<8|e.charCodeAt(t++)<<16|e.charCodeAt(t++)<<24;else for(i=0;16>i;++i)r[i]=e[t++]|e[t++]<<8|e[t++]<<16|e[t++]<<24;e=n.g[0],t=n.g[1],i=n.g[2];var s=n.g[3],o=e+(s^t&(i^s))+r[0]+3614090360&4294967295;e=t+(o<<7&4294967295|o>>>25),o=s+(i^e&(t^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(t^s&(e^t))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=t+(e^i&(s^e))+r[3]+3250441966&4294967295,t=i+(o<<22&4294967295|o>>>10),o=e+(s^t&(i^s))+r[4]+4118548399&4294967295,e=t+(o<<7&4294967295|o>>>25),o=s+(i^e&(t^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(t^s&(e^t))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=t+(e^i&(s^e))+r[7]+4249261313&4294967295,t=i+(o<<22&4294967295|o>>>10),o=e+(s^t&(i^s))+r[8]+1770035416&4294967295,e=t+(o<<7&4294967295|o>>>25),o=s+(i^e&(t^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(t^s&(e^t))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=t+(e^i&(s^e))+r[11]+2304563134&4294967295,t=i+(o<<22&4294967295|o>>>10),o=e+(s^t&(i^s))+r[12]+1804603682&4294967295,e=t+(o<<7&4294967295|o>>>25),o=s+(i^e&(t^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(t^s&(e^t))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=t+(e^i&(s^e))+r[15]+1236535329&4294967295,t=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(t^i))+r[1]+4129170786&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^i&(e^t))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^t&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(i^s))+r[0]+3921069994&4294967295,t=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(t^i))+r[5]+3593408605&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^i&(e^t))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^t&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(i^s))+r[4]+3889429448&4294967295,t=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(t^i))+r[9]+568446438&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^i&(e^t))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^t&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(i^s))+r[8]+1163531501&4294967295,t=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(t^i))+r[13]+2850285829&4294967295,e=t+(o<<5&4294967295|o>>>27),o=s+(t^i&(e^t))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^t&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=t+(s^e&(i^s))+r[12]+2368359562&4294967295,t=i+(o<<20&4294967295|o>>>12),o=e+(t^i^s)+r[5]+4294588738&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^t)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=t+(i^s^e)+r[14]+4259657740&4294967295,t=i+(o<<23&4294967295|o>>>9),o=e+(t^i^s)+r[1]+2763975236&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^t)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=t+(i^s^e)+r[10]+3200236656&4294967295,t=i+(o<<23&4294967295|o>>>9),o=e+(t^i^s)+r[13]+681279174&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^t)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=t+(i^s^e)+r[6]+76029189&4294967295,t=i+(o<<23&4294967295|o>>>9),o=e+(t^i^s)+r[9]+3654602809&4294967295,e=t+(o<<4&4294967295|o>>>28),o=s+(e^t^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^t)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=t+(i^s^e)+r[2]+3299628645&4294967295,t=i+(o<<23&4294967295|o>>>9),o=e+(i^(t|~s))+r[0]+4096336452&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~t))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=t+(s^(i|~e))+r[5]+4237533241&4294967295,t=i+(o<<21&4294967295|o>>>11),o=e+(i^(t|~s))+r[12]+1700485571&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~t))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=t+(s^(i|~e))+r[1]+2240044497&4294967295,t=i+(o<<21&4294967295|o>>>11),o=e+(i^(t|~s))+r[8]+1873313359&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~t))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=t+(s^(i|~e))+r[13]+1309151649&4294967295,t=i+(o<<21&4294967295|o>>>11),o=e+(i^(t|~s))+r[4]+4149444226&4294967295,e=t+(o<<6&4294967295|o>>>26),o=s+(t^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~t))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=t+(s^(i|~e))+r[9]+3951481745&4294967295,n.g[0]=n.g[0]+e&4294967295,n.g[1]=n.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,n.g[2]=n.g[2]+i&4294967295,n.g[3]=n.g[3]+s&4294967295}nt.prototype.j=function(n,e){e===void 0&&(e=n.length);for(var t=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=t;)th(this,n,s),s+=this.blockSize;if(typeof n=="string"){for(;s<e;)if(r[i++]=n.charCodeAt(s++),i==this.blockSize){th(this,r),i=0;break}}else for(;s<e;)if(r[i++]=n[s++],i==this.blockSize){th(this,r),i=0;break}}this.h=i,this.i+=e};nt.prototype.l=function(){var n=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);n[0]=128;for(var e=1;e<n.length-8;++e)n[e]=0;var t=8*this.i;for(e=n.length-8;e<n.length;++e)n[e]=t&255,t/=256;for(this.j(n),n=Array(16),e=t=0;4>e;++e)for(var r=0;32>r;r+=8)n[t++]=this.g[e]>>>r&255;return n};function V(n,e){this.h=e;for(var t=[],r=!0,i=n.length-1;0<=i;i--){var s=n[i]|0;r&&s==e||(t[i]=s,r=!1)}this.g=t}var fS={};function Vh(n){return-128<=n&&128>n?Sb(n,function(e){return new V([e|0],0>e?-1:0)}):new V([n|0],0>n?-1:0)}function wt(n){if(isNaN(n)||!isFinite(n))return Mr;if(0>n)return Te(wt(-n));for(var e=[],t=1,r=0;n>=t;r++)e[r]=n/t|0,t*=gh;return new V(e,0)}function Py(n,e){if(n.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(n.charAt(0)=="-")return Te(Py(n.substring(1),e));if(0<=n.indexOf("-"))throw Error('number format error: interior "-" character');for(var t=wt(Math.pow(e,8)),r=Mr,i=0;i<n.length;i+=8){var s=Math.min(8,n.length-i),o=parseInt(n.substring(i,i+s),e);8>s?(s=wt(Math.pow(e,s)),r=r.R(s).add(wt(o))):(r=r.R(t),r=r.add(wt(o)))}return r}var gh=4294967296,Mr=Vh(0),yh=Vh(1),Dg=Vh(16777216);I=V.prototype;I.ea=function(){if($e(this))return-Te(this).ea();for(var n=0,e=1,t=0;t<this.g.length;t++){var r=this.D(t);n+=(0<=r?r:gh+r)*e,e*=gh}return n};I.toString=function(n){if(n=n||10,2>n||36<n)throw Error("radix out of range: "+n);if(Lt(this))return"0";if($e(this))return"-"+Te(this).toString(n);for(var e=wt(Math.pow(n,6)),t=this,r="";;){var i=ua(t,e).g;t=ca(t,i.R(e));var s=((0<t.g.length?t.g[0]:t.h)>>>0).toString(n);if(t=i,Lt(t))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};I.D=function(n){return 0>n?0:n<this.g.length?this.g[n]:this.h};function Lt(n){if(n.h!=0)return!1;for(var e=0;e<n.g.length;e++)if(n.g[e]!=0)return!1;return!0}function $e(n){return n.h==-1}I.X=function(n){return n=ca(this,n),$e(n)?-1:Lt(n)?0:1};function Te(n){for(var e=n.g.length,t=[],r=0;r<e;r++)t[r]=~n.g[r];return new V(t,~n.h).add(yh)}I.abs=function(){return $e(this)?Te(this):this};I.add=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(n.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(n.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,t[i]=o<<16|s}return new V(t,t[t.length-1]&-2147483648?-1:0)};function ca(n,e){return n.add(Te(e))}I.R=function(n){if(Lt(this)||Lt(n))return Mr;if($e(this))return $e(n)?Te(this).R(Te(n)):Te(Te(this).R(n));if($e(n))return Te(this.R(Te(n)));if(0>this.X(Dg)&&0>n.X(Dg))return wt(this.ea()*n.ea());for(var e=this.g.length+n.g.length,t=[],r=0;r<2*e;r++)t[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<n.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=n.D(i)>>>16,c=n.D(i)&65535;t[2*r+2*i]+=o*c,na(t,2*r+2*i),t[2*r+2*i+1]+=s*c,na(t,2*r+2*i+1),t[2*r+2*i+1]+=o*a,na(t,2*r+2*i+1),t[2*r+2*i+2]+=s*a,na(t,2*r+2*i+2)}for(r=0;r<e;r++)t[r]=t[2*r+1]<<16|t[2*r];for(r=e;r<2*e;r++)t[r]=0;return new V(t,0)};function na(n,e){for(;(n[e]&65535)!=n[e];)n[e+1]+=n[e]>>>16,n[e]&=65535,e++}function Gi(n,e){this.g=n,this.h=e}function ua(n,e){if(Lt(e))throw Error("division by zero");if(Lt(n))return new Gi(Mr,Mr);if($e(n))return e=ua(Te(n),e),new Gi(Te(e.g),Te(e.h));if($e(e))return e=ua(n,Te(e)),new Gi(Te(e.g),e.h);if(30<n.g.length){if($e(n)||$e(e))throw Error("slowDivide_ only works with positive integers.");for(var t=yh,r=e;0>=r.X(n);)t=Rg(t),r=Rg(r);var i=Or(t,1),s=Or(r,1);for(r=Or(r,2),t=Or(t,2);!Lt(r);){var o=s.add(r);0>=o.X(n)&&(i=i.add(t),s=o),r=Or(r,1),t=Or(t,1)}return e=ca(n,i.R(e)),new Gi(i,e)}for(i=Mr;0<=n.X(e);){for(t=Math.max(1,Math.floor(n.ea()/e.ea())),r=Math.ceil(Math.log(t)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=wt(t),o=s.R(e);$e(o)||0<o.X(n);)t-=r,s=wt(t),o=s.R(e);Lt(s)&&(s=yh),i=i.add(s),n=ca(n,o)}return new Gi(i,n)}I.gb=function(n){return ua(this,n).h};I.and=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)&n.D(r);return new V(t,this.h&n.h)};I.or=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)|n.D(r);return new V(t,this.h|n.h)};I.xor=function(n){for(var e=Math.max(this.g.length,n.g.length),t=[],r=0;r<e;r++)t[r]=this.D(r)^n.D(r);return new V(t,this.h^n.h)};function Rg(n){for(var e=n.g.length+1,t=[],r=0;r<e;r++)t[r]=n.D(r)<<1|n.D(r-1)>>>31;return new V(t,n.h)}function Or(n,e){var t=e>>5;e%=32;for(var r=n.g.length-t,i=[],s=0;s<r;s++)i[s]=0<e?n.D(s+t)>>>e|n.D(s+t+1)<<32-e:n.D(s+t);return new V(i,n.h)}aa.prototype.createWebChannel=aa.prototype.g;qe.prototype.send=qe.prototype.u;qe.prototype.open=qe.prototype.m;qe.prototype.close=qe.prototype.close;ya.NO_ERROR=0;ya.TIMEOUT=8;ya.HTTP_ERROR=6;Jg.COMPLETE="complete";Xg.EventType=ss;ss.OPEN="a";ss.CLOSE="b";ss.ERROR="c";ss.MESSAGE="d";ye.prototype.listen=ye.prototype.O;te.prototype.listenOnce=te.prototype.P;te.prototype.getLastError=te.prototype.Sa;te.prototype.getLastErrorCode=te.prototype.Ia;te.prototype.getStatus=te.prototype.da;te.prototype.getResponseJson=te.prototype.Wa;te.prototype.getResponseText=te.prototype.ja;te.prototype.send=te.prototype.ha;te.prototype.setWithCredentials=te.prototype.Oa;nt.prototype.digest=nt.prototype.l;nt.prototype.reset=nt.prototype.reset;nt.prototype.update=nt.prototype.j;V.prototype.add=V.prototype.add;V.prototype.multiply=V.prototype.R;V.prototype.modulo=V.prototype.gb;V.prototype.compare=V.prototype.X;V.prototype.toNumber=V.prototype.ea;V.prototype.toString=V.prototype.toString;V.prototype.getBits=V.prototype.D;V.fromNumber=wt;V.fromString=Py;var Oy=rt.createWebChannelTransport=function(){return new aa},Ly=rt.getStatEventTarget=function(){return ga()},Sa=rt.ErrorCode=ya,My=rt.EventType=Jg,Fy=rt.Event=$n,Bh=rt.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Uy=rt.FetchXmlHttpFactory=cs,hs=rt.WebChannel=Xg,Vy=rt.XhrIo=te,By=rt.Md5=nt,Kn=rt.Integer=V;var qy="@firebase/firestore";var he=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};he.UNAUTHENTICATED=new he(null),he.GOOGLE_CREDENTIALS=new he("google-credentials-uid"),he.FIRST_PARTY=new he("first-party-uid"),he.MOCK_USER=new he("mock-user");var ci="9.23.0";var pn=new ct("@firebase/firestore");function $h(){return pn.logLevel}function Vv(n){pn.setLogLevel(n)}function y(n,...e){if(pn.logLevel<=P.DEBUG){let t=e.map(Kf);pn.debug(`Firestore (${ci}): ${n}`,...t)}}function ie(n,...e){if(pn.logLevel<=P.ERROR){let t=e.map(Kf);pn.error(`Firestore (${ci}): ${n}`,...t)}}function We(n,...e){if(pn.logLevel<=P.WARN){let t=e.map(Kf);pn.warn(`Firestore (${ci}): ${n}`,...t)}}function Kf(n){if(typeof n=="string")return n;try{return e=n,JSON.stringify(e)}catch{return n}var e}function b(n="Unexpected state"){let e=`FIRESTORE (${ci}) INTERNAL ASSERTION FAILED: `+n;throw ie(e),new Error(e)}function A(n,e){n||b()}function Bv(n,e){n||b()}function E(n,e){return n}var f={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},g=class extends oe{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var de=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var Ua=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Kh=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(he.UNAUTHENTICATED))}shutdown(){}},Wh=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Hh=class{constructor(e){this.t=e,this.currentUser=he.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new de;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new de,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let c=s;e.enqueueRetryable(async()=>{await c.promise,await i(this.currentUser)})},a=c=>{y("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(y("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new de)}},0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(y("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(A(typeof r.accessToken=="string"),new Ua(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return A(e===null||typeof e=="string"),new he(e)}},Qh=class{constructor(e,t,r){this.h=e,this.l=t,this.m=r,this.type="FirstParty",this.user=he.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);let e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}},Yh=class{constructor(e,t,r){this.h=e,this.l=t,this.m=r}getToken(){return Promise.resolve(new Qh(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(he.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Jh=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Xh=class{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){let r=s=>{s.error!=null&&y("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.T;return this.T=s.token,y("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{y("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.I.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.I.getImmediate({optional:!0});s?i(s):y("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(A(typeof t.token=="string"),this.T=t.token,new Jh(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function pS(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var Va=class{static A(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=pS(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function D(n,e){return n<e?-1:n>e?1:0}function Wr(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function qv(n){return n+"\0"}var X=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new g(f.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new g(f.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new g(f.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new g(f.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?D(this.nanoseconds,e.nanoseconds):D(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var C=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new X(0,0))}static max(){return new n(new X(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Ba=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&b(),r===void 0?r=e.length-t:r>e.length-t&&b(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},F=class n extends Ba{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new g(f.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},mS=/^[_a-zA-Z][_a-zA-Z0-9]*$/,we=class n extends Ba{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return mS.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new g(f.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new g(f.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new g(f.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new g(f.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var _=class n{constructor(e){this.path=e}static fromPath(e){return new n(F.fromString(e))}static fromName(e){return new n(F.fromString(e).popFirst(5))}static empty(){return new n(F.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&F.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return F.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new F(e.slice()))}};var qa=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function Zh(n){return n.fields.find(e=>e.kind===2)}function Hn(n){return n.fields.filter(e=>e.kind!==2)}qa.UNKNOWN_ID=-1;var ed=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var ja=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,He.min())}};function jv(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=C.fromTimestamp(r===1e9?new X(t+1,0):new X(t,r));return new He(i,_.empty(),e)}function zv(n){return new He(n.readTime,n.key,-1)}var He=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(C.min(),_.empty(),-1)}static max(){return new n(C.max(),_.empty(),-1)}};function Wf(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=_.comparator(n.documentKey,e.documentKey),t!==0?t:D(n.largestBatchId,e.largestBatchId))}var Gv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",za=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};async function Sn(n){if(n.code!==f.FAILED_PRECONDITION||n.message!==Gv)throw n;y("LocalStore","Unexpectedly lost primary lease")}var p=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&b(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},c=>r(c))}),o=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let u=c;t(e[u]).next(l=>{o[u]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};var Ga=class n{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.v=new de,this.transaction.oncomplete=()=>{this.v.resolve()},this.transaction.onabort=()=>{t.error?this.v.reject(new er(e,t.error)):this.v.resolve()},this.transaction.onerror=r=>{let i=Hf(r.target.error);this.v.reject(new er(e,i))}}static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new er(t,s)}}get R(){return this.v.promise}abort(e){e&&this.v.reject(e),this.aborted||(y("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new nd(t)}},mn=class n{constructor(e,t,r){this.name=e,this.version=t,this.V=r,n.S(z())===12.2&&ie("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return y("SimpleDb","Removing database:",e),Qn(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!$t())return!1;if(n.C())return!0;let e=z(),t=n.S(e),r=0<t&&t<10,i=n.N(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.env)===null||e===void 0?void 0:e.k)==="YES"}static M(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static N(e){let t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}async $(e){return this.db||(y("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new er(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new g(f.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new g(f.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new er(e,o))},i.onupgradeneeded=s=>{y("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.V.O(o,i.transaction,s.oldVersion,this.version).next(()=>{y("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.F&&(this.db.onversionchange=t=>this.F(t)),this.db}B(e){this.F=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){let s=t==="readonly",o=0;for(;;){++o;try{this.db=await this.$(e);let a=Ga.open(this.db,e,s?"readonly":"readwrite",r),c=i(a).next(u=>(a.P(),u)).catch(u=>(a.abort(u),p.reject(u))).toPromise();return c.catch(()=>{}),await a.R,c}catch(a){let c=a,u=c.name!=="FirebaseError"&&o<3;if(y("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}},td=class{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return Qn(this.L.delete())}},er=class extends g{constructor(e,t){super(f.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function An(n){return n.name==="IndexedDbTransactionError"}var nd=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(y("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(y("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Qn(r)}add(e){return y("SimpleDb","ADD",this.store.name,e,e),Qn(this.store.add(e))}get(e){return Qn(this.store.get(e)).next(t=>(t===void 0&&(t=null),y("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return y("SimpleDb","DELETE",this.store.name,e),Qn(this.store.delete(e))}count(){return y("SimpleDb","COUNT",this.store.name),Qn(this.store.count())}j(e,t){let r=this.options(e,t);if(r.index||typeof this.store.getAll!="function"){let i=this.cursor(r),s=[];return this.W(i,(o,a)=>{s.push(a)}).next(()=>s)}{let i=this.store.getAll(r.range);return new p((s,o)=>{i.onerror=a=>{o(a.target.error)},i.onsuccess=a=>{s(a.target.result)}})}}H(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new p((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}J(e,t){y("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,t);r.Y=!1;let i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}X(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.W(i,t)}Z(e){let t=this.cursor({});return new p((r,i)=>{t.onerror=s=>{let o=Hf(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){let r=[];return new p((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let c=new td(a),u=t(a.primaryKey,a.value,c);if(u instanceof p){let l=u.catch(h=>(c.done(),p.reject(h)));r.push(l)}c.isDone?i():c.K===null?a.continue():a.continue(c.K)}}).next(()=>p.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.Y?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function Qn(n){return new p((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=Hf(r.target.error);t(i)}})}var jy=!1;function Hf(n){let e=mn.S(z());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new g("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return jy||(jy=!0,setTimeout(()=>{throw r},0)),r}}return n}var rd=class{constructor(e,t){this.asyncQueue=e,this.tt=t,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}et(e){y("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{y("IndexBackiller",`Documents written: ${await this.tt.nt()}`)}catch(t){An(t)?y("IndexBackiller","Ignoring IndexedDB error during index backfill: ",t):await Sn(t)}await this.et(6e4)})}},id=class{constructor(e,t){this.localStore=e,this.persistence=t}async nt(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.st(t,e))}st(e,t){let r=new Set,i=t,s=!0;return p.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return y("IndexBackiller",`Processing collection: ${o}`),this.it(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}it(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.rt(i,s)).next(a=>(y("IndexBackiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}rt(e,t){let r=e;return t.changes.forEach((i,s)=>{let o=zv(s);Wf(o,r)>0&&(r=o)}),new He(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Re=class{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ot(r),this.ut=r=>t.writeSequenceNumber(r))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ut&&this.ut(e),e}};Re.ct=-1;function Ws(n){return n==null}function bs(n){return n===0&&1/n==-1/0}function $v(n){return typeof n=="number"&&Number.isInteger(n)&&!bs(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Pe(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=zy(e)),e=gS(n.get(t),e);return zy(e)}function gS(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case"":t+="";break;default:t+=s}}return t}function zy(n){return n+""}function _t(n){let e=n.length;if(A(e>=2),e===2)return A(n.charAt(0)===""&&n.charAt(1)===""),F.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf("",s);switch((o<0||o>t)&&b(),n.charAt(o+1)){case"":let a=n.substring(s,o),c;i.length===0?c=a:(i+=a,c=i,i=""),r.push(c);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:b()}s=o+2}return new F(r)}var Gy=["userId","batchId"];function xa(n,e){return[n,Pe(e)]}function Kv(n,e,t){return[n,Pe(e),t]}var yS={},vS=["prefixPath","collectionGroup","readTime","documentId"],wS=["prefixPath","collectionGroup","documentId"],_S=["collectionGroup","readTime","prefixPath","documentId"],IS=["canonicalId","targetId"],ES=["targetId","path"],TS=["path","targetId"],bS=["collectionId","parent"],SS=["indexId","uid"],AS=["uid","sequenceNumber"],CS=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],NS=["indexId","uid","orderedDocumentKey"],kS=["userId","collectionPath","documentId"],DS=["userId","collectionPath","largestBatchId"],RS=["userId","collectionGroup","largestBatchId"],Wv=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],xS=[...Wv,"documentOverlays"],Hv=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Qv=Hv,PS=[...Qv,"indexConfiguration","indexState","indexEntries"];var Ss=class extends za{constructor(e,t){super(),this.ht=e,this.currentSequenceNumber=t}};function Ie(n,e){let t=E(n);return mn.M(t.ht,e)}function $y(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function dr(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Yv(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var K=class n{constructor(e,t){this.comparator=e,this.root=t||Et.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Et.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Et.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $r(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $r(this.root,e,this.comparator,!1)}getReverseIterator(){return new $r(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $r(this.root,e,this.comparator,!0)}},$r=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Et=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw b();let e=this.left.check();if(e!==this.right.check())throw b();return e+(this.isRed()?0:1)}};Et.EMPTY=null,Et.RED=!0,Et.BLACK=!1;Et.EMPTY=new class{constructor(){this.size=0}get key(){throw b()}get value(){throw b()}get color(){throw b()}get left(){throw b()}get right(){throw b()}copy(n,e,t,r,i){return this}insert(n,e,t){return new Et(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var H=class n{constructor(e){this.comparator=e,this.data=new K(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new $a(this.data.getIterator())}getIteratorFrom(e){return new $a(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},$a=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function Br(n){return n.hasNext()?n.getNext():void 0}var je=class n{constructor(e){this.fields=e,e.sort(we.comparator)}static empty(){return new n([])}unionWith(e){let t=new H(we.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Wr(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Ka=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function Jv(){return typeof atob<"u"}var _e=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new Ka("Invalid base64 string: "+i):i}}(e);return new n(t)}static fromUint8Array(e){let t=function(r){let i="";for(let s=0;s<r.length;++s)i+=String.fromCharCode(r[s]);return i}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return D(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};_e.EMPTY_BYTE_STRING=new _e("");var OS=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function gn(n){if(A(!!n),typeof n=="string"){let e=0,t=OS.exec(n);if(A(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ne(n.seconds),nanos:ne(n.nanos)}}function ne(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function yn(n){return typeof n=="string"?_e.fromBase64String(n):_e.fromUint8Array(n)}function Lc(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Qf(n){let e=n.mapValue.fields.__previous_value__;return Lc(e)?Qf(e):e}function As(n){let e=gn(n.mapValue.fields.__local_write_time__.timestampValue);return new X(e.seconds,e.nanos)}var sd=class{constructor(e,t,r,i,s,o,a,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=u}},vn=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var hn={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Pa={nullValue:"NULL_VALUE"};function nr(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Lc(n)?4:Xv(n)?9007199254740991:10:b()}function St(n,e){if(n===e)return!0;let t=nr(n);if(t!==nr(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return As(n).isEqual(As(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;let s=gn(r.timestampValue),o=gn(i.timestampValue);return s.seconds===o.seconds&&s.nanos===o.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(r,i){return yn(r.bytesValue).isEqual(yn(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return ne(r.geoPointValue.latitude)===ne(i.geoPointValue.latitude)&&ne(r.geoPointValue.longitude)===ne(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return ne(r.integerValue)===ne(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){let s=ne(r.doubleValue),o=ne(i.doubleValue);return s===o?bs(s)===bs(o):isNaN(s)&&isNaN(o)}return!1}(n,e);case 9:return Wr(n.arrayValue.values||[],e.arrayValue.values||[],St);case 10:return function(r,i){let s=r.mapValue.fields||{},o=i.mapValue.fields||{};if($y(s)!==$y(o))return!1;for(let a in s)if(s.hasOwnProperty(a)&&(o[a]===void 0||!St(s[a],o[a])))return!1;return!0}(n,e);default:return b()}}function Cs(n,e){return(n.values||[]).find(t=>St(t,e))!==void 0}function wn(n,e){if(n===e)return 0;let t=nr(n),r=nr(e);if(t!==r)return D(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return D(n.booleanValue,e.booleanValue);case 2:return function(i,s){let o=ne(i.integerValue||i.doubleValue),a=ne(s.integerValue||s.doubleValue);return o<a?-1:o>a?1:o===a?0:isNaN(o)?isNaN(a)?0:-1:1}(n,e);case 3:return Ky(n.timestampValue,e.timestampValue);case 4:return Ky(As(n),As(e));case 5:return D(n.stringValue,e.stringValue);case 6:return function(i,s){let o=yn(i),a=yn(s);return o.compareTo(a)}(n.bytesValue,e.bytesValue);case 7:return function(i,s){let o=i.split("/"),a=s.split("/");for(let c=0;c<o.length&&c<a.length;c++){let u=D(o[c],a[c]);if(u!==0)return u}return D(o.length,a.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,s){let o=D(ne(i.latitude),ne(s.latitude));return o!==0?o:D(ne(i.longitude),ne(s.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,s){let o=i.values||[],a=s.values||[];for(let c=0;c<o.length&&c<a.length;++c){let u=wn(o[c],a[c]);if(u)return u}return D(o.length,a.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,s){if(i===hn.mapValue&&s===hn.mapValue)return 0;if(i===hn.mapValue)return 1;if(s===hn.mapValue)return-1;let o=i.fields||{},a=Object.keys(o),c=s.fields||{},u=Object.keys(c);a.sort(),u.sort();for(let l=0;l<a.length&&l<u.length;++l){let h=D(a[l],u[l]);if(h!==0)return h;let d=wn(o[a[l]],c[u[l]]);if(d!==0)return d}return D(a.length,u.length)}(n.mapValue,e.mapValue);default:throw b()}}function Ky(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return D(n,e);let t=gn(n),r=gn(e),i=D(t.seconds,r.seconds);return i!==0?i:D(t.nanos,r.nanos)}function Hr(n){return od(n)}function od(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){let i=gn(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?yn(n.bytesValue).toBase64():"referenceValue"in n?(t=n.referenceValue,_.fromName(t).toString()):"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",s=!0;for(let o of r.values||[])s?s=!1:i+=",",i+=od(o);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){let i=Object.keys(r.fields||{}).sort(),s="{",o=!0;for(let a of i)o?o=!1:s+=",",s+=`${a}:${od(r.fields[a])}`;return s+"}"}(n.mapValue):b();var e,t}function rr(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ad(n){return!!n&&"integerValue"in n}function Ns(n){return!!n&&"arrayValue"in n}function Wy(n){return!!n&&"nullValue"in n}function Hy(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Oa(n){return!!n&&"mapValue"in n}function ws(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return dr(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ws(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ws(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Xv(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function LS(n){return"nullValue"in n?Pa:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?rr(vn.empty(),_.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:b()}function MS(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?rr(vn.empty(),_.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?hn:b()}function Qy(n,e){let t=wn(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Yy(n,e){let t=wn(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var De=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Oa(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ws(t)}setAll(e){let t=we.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=ws(o):i.push(a.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Oa(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return St(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Oa(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){dr(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(ws(this.value))}};function Zv(n){let e=[];return dr(n.fields,(t,r)=>{let i=new we([t]);if(Oa(r)){let s=Zv(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new je(e)}var fe=class n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new n(e,0,C.min(),C.min(),C.min(),De.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,C.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,C.min(),C.min(),De.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,C.min(),C.min(),De.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(C.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=De.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=De.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=C.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var At=class{constructor(e,t){this.position=e,this.inclusive=t}};function Jy(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=_.comparator(_.fromName(o.referenceValue),t.key):r=wn(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Xy(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!St(n.position[t],e.position[t]))return!1;return!0}var dn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function FS(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Wa=class{},O=class n extends Wa{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new ld(e,t,r):t==="array-contains"?new fd(e,r):t==="in"?new Ha(e,r):t==="not-in"?new pd(e,r):t==="array-contains-any"?new md(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new hd(e,r):new dd(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(wn(t,this.value)):t!==null&&nr(this.value)===nr(t)&&this.matchesComparison(wn(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return b()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}},B=class n extends Wa{constructor(e,t){super(),this.filters=e,this.op=t,this.lt=null}static create(e,t){return new n(e,t)}matches(e){return Qr(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.lt!==null||(this.lt=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.lt}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){let e=this.ft(t=>t.isInequality());return e!==null?e.field:null}ft(e){for(let t of this.getFlattenedFilters())if(e(t))return t;return null}};function Qr(n){return n.op==="and"}function cd(n){return n.op==="or"}function Yf(n){return ew(n)&&Qr(n)}function ew(n){for(let e of n.filters)if(e instanceof B)return!1;return!0}function ud(n){if(n instanceof O)return n.field.canonicalString()+n.op.toString()+Hr(n.value);if(Yf(n))return n.filters.map(e=>ud(e)).join(",");{let e=n.filters.map(t=>ud(t)).join(",");return`${n.op}(${e})`}}function tw(n,e){return n instanceof O?function(t,r){return r instanceof O&&t.op===r.op&&t.field.isEqual(r.field)&&St(t.value,r.value)}(n,e):n instanceof B?function(t,r){return r instanceof B&&t.op===r.op&&t.filters.length===r.filters.length?t.filters.reduce((i,s,o)=>i&&tw(s,r.filters[o]),!0):!1}(n,e):void b()}function nw(n,e){let t=n.filters.concat(e);return B.create(t,n.op)}function rw(n){return n instanceof O?function(e){return`${e.field.canonicalString()} ${e.op} ${Hr(e.value)}`}(n):n instanceof B?function(e){return e.op.toString()+" {"+e.getFilters().map(rw).join(" ,")+"}"}(n):"Filter"}var ld=class extends O{constructor(e,t,r){super(e,t,r),this.key=_.fromName(r.referenceValue)}matches(e){let t=_.comparator(e.key,this.key);return this.matchesComparison(t)}},hd=class extends O{constructor(e,t){super(e,"in",t),this.keys=iw("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},dd=class extends O{constructor(e,t){super(e,"not-in",t),this.keys=iw("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function iw(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>_.fromName(r.referenceValue))}var fd=class extends O{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ns(t)&&Cs(t.arrayValue,this.value)}},Ha=class extends O{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Cs(this.value.arrayValue,t)}},pd=class extends O{constructor(e,t){super(e,"not-in",t)}matches(e){if(Cs(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Cs(this.value.arrayValue,t)}},md=class extends O{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ns(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Cs(this.value.arrayValue,r))}};var gd=class{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.dt=null}};function yd(n,e=null,t=[],r=[],i=null,s=null,o=null){return new gd(n,e,t,r,i,s,o)}function ir(n){let e=E(n);if(e.dt===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>ud(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Ws(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Hr(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Hr(r)).join(",")),e.dt=t}return e.dt}function Hs(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!FS(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!tw(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Xy(n.startAt,e.startAt)&&Xy(n.endAt,e.endAt)}function Qa(n){return _.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Ya(n,e){return n.filters.filter(t=>t instanceof O&&t.field.isEqual(e))}function Zy(n,e,t){let r=Pa,i=!0;for(let s of Ya(n,e)){let o=Pa,a=!0;switch(s.op){case"<":case"<=":o=LS(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Pa}Qy({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];Qy({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function ev(n,e,t){let r=hn,i=!0;for(let s of Ya(n,e)){let o=hn,a=!0;switch(s.op){case">=":case">":o=MS(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=hn}Yy({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];Yy({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var it=class{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.wt=null,this._t=null,this.startAt,this.endAt}};function sw(n,e,t,r,i,s,o,a){return new it(n,e,t,r,i,s,o,a)}function ui(n){return new it(n)}function tv(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Jf(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function Mc(n){for(let e of n.filters){let t=e.getFirstInequalityField();if(t!==null)return t}return null}function Xf(n){return n.collectionGroup!==null}function tr(n){let e=E(n);if(e.wt===null){e.wt=[];let t=Mc(e),r=Jf(e);if(t!==null&&r===null)t.isKeyField()||e.wt.push(new dn(t)),e.wt.push(new dn(we.keyField(),"asc"));else{let i=!1;for(let s of e.explicitOrderBy)e.wt.push(s),s.field.isKeyField()&&(i=!0);if(!i){let s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.wt.push(new dn(we.keyField(),s))}}}return e.wt}function Ue(n){let e=E(n);if(!e._t)if(e.limitType==="F")e._t=yd(e.path,e.collectionGroup,tr(e),e.filters,e.limit,e.startAt,e.endAt);else{let t=[];for(let s of tr(e)){let o=s.dir==="desc"?"asc":"desc";t.push(new dn(s.field,o))}let r=e.endAt?new At(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new At(e.startAt.position,e.startAt.inclusive):null;e._t=yd(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e._t}function vd(n,e){e.getFirstInequalityField(),Mc(n);let t=n.filters.concat([e]);return new it(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Ja(n,e,t){return new it(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Qs(n,e){return Hs(Ue(n),Ue(e))&&n.limitType===e.limitType}function ow(n){return`${ir(Ue(n))}|lt:${n.limitType}`}function wd(n){return`Query(target=${function(e){let t=e.path.canonicalString();return e.collectionGroup!==null&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(r=>rw(r)).join(", ")}]`),Ws(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(r=>function(i){return`${i.field.canonicalString()} (${i.dir})`}(r)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Hr(r)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Hr(r)).join(",")),`Target(${t})`}(Ue(n))}; limitType=${n.limitType})`}function Ys(n,e){return e.isFoundDocument()&&function(t,r){let i=r.key.path;return t.collectionGroup!==null?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):_.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(let i of tr(t))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(n,e)&&function(t,r){for(let i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&function(t,r){return!(t.startAt&&!function(i,s,o){let a=Jy(i,s,o);return i.inclusive?a<=0:a<0}(t.startAt,tr(t),r)||t.endAt&&!function(i,s,o){let a=Jy(i,s,o);return i.inclusive?a>=0:a>0}(t.endAt,tr(t),r))}(n,e)}function aw(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function cw(n){return(e,t)=>{let r=!1;for(let i of tr(n)){let s=US(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function US(n,e,t){let r=n.field.isKeyField()?_.comparator(e.key,t.key):function(i,s,o){let a=s.data.field(i),c=o.data.field(i);return a!==null&&c!==null?wn(a,c):b()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return b()}}var Ct=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){dr(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return Yv(this.inner)}size(){return this.innerSize}};var VS=new K(_.comparator);function Fe(){return VS}var uw=new K(_.comparator);function ys(...n){let e=uw;for(let t of n)e=e.insert(t.key,t);return e}function lw(n){let e=uw;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function It(){return _s()}function hw(){return _s()}function _s(){return new Ct(n=>n.toString(),(n,e)=>n.isEqual(e))}var BS=new K(_.comparator),qS=new H(_.comparator);function R(...n){let e=qS;for(let t of n)e=e.add(t);return e}var jS=new H(D);function Zf(){return jS}function dw(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:bs(e)?"-0":e}}function fw(n){return{integerValue:""+n}}function pw(n,e){return $v(e)?fw(e):dw(n,e)}var Yr=class{constructor(){this._=void 0}};function zS(n,e,t){return n instanceof _n?function(r,i){let s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&Lc(i)&&(i=Qf(i)),i&&(s.fields.__previous_value__=i),{mapValue:s}}(t,e):n instanceof Vt?gw(n,e):n instanceof Bt?yw(n,e):function(r,i){let s=mw(r,i),o=nv(s)+nv(r.gt);return ad(s)&&ad(r.gt)?fw(o):dw(r.serializer,o)}(n,e)}function GS(n,e,t){return n instanceof Vt?gw(n,e):n instanceof Bt?yw(n,e):t}function mw(n,e){return n instanceof In?ad(t=e)||function(r){return!!r&&"doubleValue"in r}(t)?e:{integerValue:0}:null;var t}var _n=class extends Yr{},Vt=class extends Yr{constructor(e){super(),this.elements=e}};function gw(n,e){let t=vw(e);for(let r of n.elements)t.some(i=>St(i,r))||t.push(r);return{arrayValue:{values:t}}}var Bt=class extends Yr{constructor(e){super(),this.elements=e}};function yw(n,e){let t=vw(e);for(let r of n.elements)t=t.filter(i=>!St(i,r));return{arrayValue:{values:t}}}var In=class extends Yr{constructor(e,t){super(),this.serializer=e,this.gt=t}};function nv(n){return ne(n.integerValue||n.doubleValue)}function vw(n){return Ns(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var sr=class{constructor(e,t){this.field=e,this.transform=t}};function $S(n,e){return n.field.isEqual(e.field)&&function(t,r){return t instanceof Vt&&r instanceof Vt||t instanceof Bt&&r instanceof Bt?Wr(t.elements,r.elements,St):t instanceof In&&r instanceof In?St(t.gt,r.gt):t instanceof _n&&r instanceof _n}(n.transform,e.transform)}var _d=class{constructor(e,t){this.version=e,this.transformResults=t}},re=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function La(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Jr=class{};function ww(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Tn(n.key,re.none()):new En(n.key,n.data,re.none());{let t=n.data,r=De.empty(),i=new H(we.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new st(n.key,r,new je(i.toArray()),re.none())}}function KS(n,e,t){n instanceof En?function(r,i,s){let o=r.value.clone(),a=iv(r.fieldTransforms,i,s.transformResults);o.setAll(a),i.convertToFoundDocument(s.version,o).setHasCommittedMutations()}(n,e,t):n instanceof st?function(r,i,s){if(!La(r.precondition,i))return void i.convertToUnknownDocument(s.version);let o=iv(r.fieldTransforms,i,s.transformResults),a=i.data;a.setAll(_w(r)),a.setAll(o),i.convertToFoundDocument(s.version,a).setHasCommittedMutations()}(n,e,t):function(r,i,s){i.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,t)}function Is(n,e,t,r){return n instanceof En?function(i,s,o,a){if(!La(i.precondition,s))return o;let c=i.value.clone(),u=sv(i.fieldTransforms,a,s);return c.setAll(u),s.convertToFoundDocument(s.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof st?function(i,s,o,a){if(!La(i.precondition,s))return o;let c=sv(i.fieldTransforms,a,s),u=s.data;return u.setAll(_w(i)),u.setAll(c),s.convertToFoundDocument(s.version,u).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(l=>l.field))}(n,e,t,r):function(i,s,o){return La(i.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):o}(n,e,t)}function WS(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=mw(r.transform,i||null);s!=null&&(t===null&&(t=De.empty()),t.set(r.field,s))}return t||null}function rv(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(t,r){return t===void 0&&r===void 0||!(!t||!r)&&Wr(t,r,(i,s)=>$S(i,s))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var En=class extends Jr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},st=class extends Jr{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function _w(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function iv(n,e,t){let r=new Map;A(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,GS(o,a,t[i]))}return r}function sv(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,zS(s,o,e))}return r}var Tn=class extends Jr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ks=class extends Jr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Ds=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&KS(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Is(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Is(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=hw();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;let c=ww(o,a);c!==null&&r.set(i.key,c),o.isValidDocument()||o.convertToNoDocument(C.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),R())}isEqual(e){return this.batchId===e.batchId&&Wr(this.mutations,e.mutations,(t,r)=>rv(t,r))&&Wr(this.baseMutations,e.baseMutations,(t,r)=>rv(t,r))}},Id=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){A(e.mutations.length===r.length);let i=BS,s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Rs=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Ed=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ue,L;function Iw(n){switch(n){default:return b();case f.CANCELLED:case f.UNKNOWN:case f.DEADLINE_EXCEEDED:case f.RESOURCE_EXHAUSTED:case f.INTERNAL:case f.UNAVAILABLE:case f.UNAUTHENTICATED:return!1;case f.INVALID_ARGUMENT:case f.NOT_FOUND:case f.ALREADY_EXISTS:case f.PERMISSION_DENIED:case f.FAILED_PRECONDITION:case f.ABORTED:case f.OUT_OF_RANGE:case f.UNIMPLEMENTED:case f.DATA_LOSS:return!0}}function Ew(n){if(n===void 0)return ie("GRPC error has no .code"),f.UNKNOWN;switch(n){case ue.OK:return f.OK;case ue.CANCELLED:return f.CANCELLED;case ue.UNKNOWN:return f.UNKNOWN;case ue.DEADLINE_EXCEEDED:return f.DEADLINE_EXCEEDED;case ue.RESOURCE_EXHAUSTED:return f.RESOURCE_EXHAUSTED;case ue.INTERNAL:return f.INTERNAL;case ue.UNAVAILABLE:return f.UNAVAILABLE;case ue.UNAUTHENTICATED:return f.UNAUTHENTICATED;case ue.INVALID_ARGUMENT:return f.INVALID_ARGUMENT;case ue.NOT_FOUND:return f.NOT_FOUND;case ue.ALREADY_EXISTS:return f.ALREADY_EXISTS;case ue.PERMISSION_DENIED:return f.PERMISSION_DENIED;case ue.FAILED_PRECONDITION:return f.FAILED_PRECONDITION;case ue.ABORTED:return f.ABORTED;case ue.OUT_OF_RANGE:return f.OUT_OF_RANGE;case ue.UNIMPLEMENTED:return f.UNIMPLEMENTED;case ue.DATA_LOSS:return f.DATA_LOSS;default:return b()}}(L=ue||(ue={}))[L.OK=0]="OK",L[L.CANCELLED=1]="CANCELLED",L[L.UNKNOWN=2]="UNKNOWN",L[L.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",L[L.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",L[L.NOT_FOUND=5]="NOT_FOUND",L[L.ALREADY_EXISTS=6]="ALREADY_EXISTS",L[L.PERMISSION_DENIED=7]="PERMISSION_DENIED",L[L.UNAUTHENTICATED=16]="UNAUTHENTICATED",L[L.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",L[L.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",L[L.ABORTED=10]="ABORTED",L[L.OUT_OF_RANGE=11]="OUT_OF_RANGE",L[L.UNIMPLEMENTED=12]="UNIMPLEMENTED",L[L.INTERNAL=13]="INTERNAL",L[L.UNAVAILABLE=14]="UNAVAILABLE",L[L.DATA_LOSS=15]="DATA_LOSS";var Td=class n{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return Aa}static getOrCreateInstance(){return Aa===null&&(Aa=new n),Aa}onExistenceFilterMismatch(e){let t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}},Aa=null;function Tw(){return new TextEncoder}var HS=new Kn([4294967295,4294967295],0);function ov(n){let e=Tw().encode(n),t=new By;return t.update(e),new Uint8Array(t.digest())}function av(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Kn([t,r],0),new Kn([i,s],0)]}var bd=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Zn(`Invalid padding: ${t}`);if(r<0)throw new Zn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Zn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Zn(`Invalid padding when bitmap length is 0: ${t}`);this.It=8*e.length-t,this.Tt=Kn.fromNumber(this.It)}Et(e,t,r){let i=e.add(t.multiply(Kn.fromNumber(r)));return i.compare(HS)===1&&(i=new Kn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Tt).toNumber()}At(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}vt(e){if(this.It===0)return!1;let t=ov(e),[r,i]=av(t);for(let s=0;s<this.hashCount;s++){let o=this.Et(r,i,s);if(!this.At(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.It===0)return;let t=ov(e),[r,i]=av(t);for(let s=0;s<this.hashCount;s++){let o=this.Et(r,i,s);this.Rt(o)}}Rt(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},Zn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var xs=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Ps.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(C.min(),i,new K(D),Fe(),R())}},Ps=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,R(),R(),R())}};var Kr=class{constructor(e,t,r,i){this.Pt=e,this.removedTargetIds=t,this.key=r,this.bt=i}},Xa=class{constructor(e,t){this.targetId=e,this.Vt=t}},Za=class{constructor(e,t,r=_e.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},ec=class{constructor(){this.St=0,this.Dt=uv(),this.Ct=_e.EMPTY_BYTE_STRING,this.xt=!1,this.Nt=!0}get current(){return this.xt}get resumeToken(){return this.Ct}get kt(){return this.St!==0}get Mt(){return this.Nt}$t(e){e.approximateByteSize()>0&&(this.Nt=!0,this.Ct=e)}Ot(){let e=R(),t=R(),r=R();return this.Dt.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:b()}}),new Ps(this.Ct,this.xt,e,t,r)}Ft(){this.Nt=!1,this.Dt=uv()}Bt(e,t){this.Nt=!0,this.Dt=this.Dt.insert(e,t)}Lt(e){this.Nt=!0,this.Dt=this.Dt.remove(e)}qt(){this.St+=1}Ut(){this.St-=1}Kt(){this.Nt=!0,this.xt=!0}},Sd=class{constructor(e){this.Gt=e,this.Qt=new Map,this.jt=Fe(),this.zt=cv(),this.Wt=new K(D)}Ht(e){for(let t of e.Pt)e.bt&&e.bt.isFoundDocument()?this.Jt(t,e.bt):this.Yt(t,e.key,e.bt);for(let t of e.removedTargetIds)this.Yt(t,e.key,e.bt)}Xt(e){this.forEachTarget(e,t=>{let r=this.Zt(t);switch(e.state){case 0:this.te(t)&&r.$t(e.resumeToken);break;case 1:r.Ut(),r.kt||r.Ft(),r.$t(e.resumeToken);break;case 2:r.Ut(),r.kt||this.removeTarget(t);break;case 3:this.te(t)&&(r.Kt(),r.$t(e.resumeToken));break;case 4:this.te(t)&&(this.ee(t),r.$t(e.resumeToken));break;default:b()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Qt.forEach((r,i)=>{this.te(i)&&t(i)})}ne(e){var t;let r=e.targetId,i=e.Vt.count,s=this.se(r);if(s){let o=s.target;if(Qa(o))if(i===0){let a=new _(o.path);this.Yt(r,a,fe.newNoDocument(a,C.min()))}else A(i===1);else{let a=this.ie(r);if(a!==i){let c=this.re(e,a);if(c!==0){this.ee(r);let u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Wt=this.Wt.insert(r,u)}(t=Td.instance)===null||t===void 0||t.notifyOnExistenceFilterMismatch(function(u,l,h){var d,m,w,T,S,U;let j={localCacheCount:l,existenceFilterCount:h.count},x=h.unchangedNames;return x&&(j.bloomFilter={applied:u===0,hashCount:(d=x?.hashCount)!==null&&d!==void 0?d:0,bitmapLength:(T=(w=(m=x?.bits)===null||m===void 0?void 0:m.bitmap)===null||w===void 0?void 0:w.length)!==null&&T!==void 0?T:0,padding:(U=(S=x?.bits)===null||S===void 0?void 0:S.padding)!==null&&U!==void 0?U:0}),j}(c,a,e.Vt))}}}}re(e,t){let{unchangedNames:r,count:i}=e.Vt;if(!r||!r.bits)return 1;let{bits:{bitmap:s="",padding:o=0},hashCount:a=0}=r,c,u;try{c=yn(s).toUint8Array()}catch(l){if(l instanceof Ka)return We("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw l}try{u=new bd(c,o,a)}catch(l){return We(l instanceof Zn?"BloomFilter error: ":"Applying bloom filter failed: ",l),1}return u.It===0?1:i!==t-this.oe(e.targetId,u)?2:0}oe(e,t){let r=this.Gt.getRemoteKeysForTarget(e),i=0;return r.forEach(s=>{let o=this.Gt.ue(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.vt(a)||(this.Yt(e,s,null),i++)}),i}ce(e){let t=new Map;this.Qt.forEach((s,o)=>{let a=this.se(o);if(a){if(s.current&&Qa(a.target)){let c=new _(a.target.path);this.jt.get(c)!==null||this.ae(o,c)||this.Yt(o,c,fe.newNoDocument(c,e))}s.Mt&&(t.set(o,s.Ot()),s.Ft())}});let r=R();this.zt.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let u=this.se(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.jt.forEach((s,o)=>o.setReadTime(e));let i=new xs(e,t,this.Wt,this.jt,r);return this.jt=Fe(),this.zt=cv(),this.Wt=new K(D),i}Jt(e,t){if(!this.te(e))return;let r=this.ae(e,t.key)?2:0;this.Zt(e).Bt(t.key,r),this.jt=this.jt.insert(t.key,t),this.zt=this.zt.insert(t.key,this.he(t.key).add(e))}Yt(e,t,r){if(!this.te(e))return;let i=this.Zt(e);this.ae(e,t)?i.Bt(t,1):i.Lt(t),this.zt=this.zt.insert(t,this.he(t).delete(e)),r&&(this.jt=this.jt.insert(t,r))}removeTarget(e){this.Qt.delete(e)}ie(e){let t=this.Zt(e).Ot();return this.Gt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}qt(e){this.Zt(e).qt()}Zt(e){let t=this.Qt.get(e);return t||(t=new ec,this.Qt.set(e,t)),t}he(e){let t=this.zt.get(e);return t||(t=new H(D),this.zt=this.zt.insert(e,t)),t}te(e){let t=this.se(e)!==null;return t||y("WatchChangeAggregator","Detected inactive target",e),t}se(e){let t=this.Qt.get(e);return t&&t.kt?null:this.Gt.le(e)}ee(e){this.Qt.set(e,new ec),this.Gt.getRemoteKeysForTarget(e).forEach(t=>{this.Yt(e,t,null)})}ae(e,t){return this.Gt.getRemoteKeysForTarget(e).has(t)}};function cv(){return new K(_.comparator)}function uv(){return new K(_.comparator)}var QS={asc:"ASCENDING",desc:"DESCENDING"},YS={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},JS={and:"AND",or:"OR"},Ad=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Cd(n,e){return n.useProto3Json||Ws(e)?e:{value:e}}function Xr(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function bw(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function XS(n,e){return Xr(n,e.toTimestamp())}function se(n){return A(!!n),C.fromTimestamp(function(e){let t=gn(e);return new X(t.seconds,t.nanos)}(n))}function ep(n,e){return function(t){return new F(["projects",t.projectId,"databases",t.database])}(n).child("documents").child(e).canonicalString()}function Sw(n){let e=F.fromString(n);return A(Ow(e)),e}function Os(n,e){return ep(n.databaseId,e.path)}function Tt(n,e){let t=Sw(e);if(t.get(1)!==n.databaseId.projectId)throw new g(f.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new g(f.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new _(Cw(t))}function Nd(n,e){return ep(n.databaseId,e)}function Aw(n){let e=Sw(n);return e.length===4?F.emptyPath():Cw(e)}function Ls(n){return new F(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Cw(n){return A(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function lv(n,e,t){return{name:Os(n,e),fields:t.value.mapValue.fields}}function Nw(n,e,t){let r=Tt(n,e.name),i=se(e.updateTime),s=e.createTime?se(e.createTime):C.min(),o=new De({mapValue:{fields:e.fields}}),a=fe.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function ZS(n,e){return"found"in e?function(t,r){A(!!r.found),r.found.name,r.found.updateTime;let i=Tt(t,r.found.name),s=se(r.found.updateTime),o=r.found.createTime?se(r.found.createTime):C.min(),a=new De({mapValue:{fields:r.found.fields}});return fe.newFoundDocument(i,s,o,a)}(n,e):"missing"in e?function(t,r){A(!!r.missing),A(!!r.readTime);let i=Tt(t,r.missing),s=se(r.readTime);return fe.newNoDocument(i,s)}(n,e):b()}function eA(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:b()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,u){return c.useProto3Json?(A(u===void 0||typeof u=="string"),_e.fromBase64String(u||"")):(A(u===void 0||u instanceof Uint8Array),_e.fromUint8Array(u||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){let u=c.code===void 0?f.UNKNOWN:Ew(c.code);return new g(u,c.message||"")}(o);t=new Za(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Tt(n,r.document.name),s=se(r.document.updateTime),o=r.document.createTime?se(r.document.createTime):C.min(),a=new De({mapValue:{fields:r.document.fields}}),c=fe.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];t=new Kr(u,l,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Tt(n,r.document),s=r.readTime?se(r.readTime):C.min(),o=fe.newNoDocument(i,s),a=r.removedTargetIds||[];t=new Kr([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Tt(n,r.document),s=r.removedTargetIds||[];t=new Kr([],s,i,null)}else{if(!("filter"in e))return b();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new Ed(i,s),a=r.targetId;t=new Xa(a,o)}}return t}function Ms(n,e){let t;if(e instanceof En)t={update:lv(n,e.key,e.value)};else if(e instanceof Tn)t={delete:Os(n,e.key)};else if(e instanceof st)t={update:lv(n,e.key,e.data),updateMask:oA(e.fieldMask)};else{if(!(e instanceof ks))return b();t={verify:Os(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,s){let o=s.transform;if(o instanceof _n)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Vt)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Bt)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof In)return{fieldPath:s.field.canonicalString(),increment:o.gt};throw b()}(0,r))),e.precondition.isNone||(t.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:XS(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:b()}(n,e.precondition)),t}function kd(n,e){let t=e.currentDocument?function(i){return i.updateTime!==void 0?re.updateTime(se(i.updateTime)):i.exists!==void 0?re.exists(i.exists):re.none()}(e.currentDocument):re.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(s,o){let a=null;if("setToServerValue"in o)A(o.setToServerValue==="REQUEST_TIME"),a=new _n;else if("appendMissingElements"in o){let u=o.appendMissingElements.values||[];a=new Vt(u)}else if("removeAllFromArray"in o){let u=o.removeAllFromArray.values||[];a=new Bt(u)}else"increment"in o?a=new In(s,o.increment):b();let c=we.fromServerFormat(o.fieldPath);return new sr(c,a)}(n,i)):[];if(e.update){e.update.name;let i=Tt(n,e.update.name),s=new De({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(a){let c=a.fieldPaths||[];return new je(c.map(u=>we.fromServerFormat(u)))}(e.updateMask);return new st(i,s,o,t,r)}return new En(i,s,t,r)}if(e.delete){let i=Tt(n,e.delete);return new Tn(i,t)}if(e.verify){let i=Tt(n,e.verify);return new ks(i,t)}return b()}function tA(n,e){return n&&n.length>0?(A(e!==void 0),n.map(t=>function(r,i){let s=r.updateTime?se(r.updateTime):se(i);return s.isEqual(C.min())&&(s=se(i)),new _d(s,r.transformResults||[])}(t,e))):[]}function kw(n,e){return{documents:[Nd(n,e.path)]}}function Dw(n,e){let t={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(t.parent=Nd(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=Nd(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);let i=function(c){if(c.length!==0)return Pw(B.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);let s=function(c){if(c.length!==0)return c.map(u=>function(l){return{field:jr(l.field),direction:rA(l.dir)}}(u))}(e.orderBy);s&&(t.structuredQuery.orderBy=s);let o=Cd(n,e.limit);var a;return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt={before:(a=e.startAt).inclusive,values:a.position}),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),t}function Rw(n){let e=Aw(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){A(r===1);let l=t.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];t.where&&(s=function(l){let h=xw(l);return h instanceof B&&Yf(h)?h.getFilters():[h]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(l=>function(h){return new dn(zr(h.field),function(d){switch(d){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(h.direction))}(l)));let a=null;t.limit&&(a=function(l){let h;return h=typeof l=="object"?l.value:l,Ws(h)?null:h}(t.limit));let c=null;t.startAt&&(c=function(l){let h=!!l.before,d=l.values||[];return new At(d,h)}(t.startAt));let u=null;return t.endAt&&(u=function(l){let h=!l.before,d=l.values||[];return new At(d,h)}(t.endAt)),sw(e,i,o,s,a,"F",c,u)}function nA(n,e){let t=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return b()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function xw(n){return n.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":let t=zr(e.unaryFilter.field);return O.create(t,"==",{doubleValue:NaN});case"IS_NULL":let r=zr(e.unaryFilter.field);return O.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let i=zr(e.unaryFilter.field);return O.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let s=zr(e.unaryFilter.field);return O.create(s,"!=",{nullValue:"NULL_VALUE"});default:return b()}}(n):n.fieldFilter!==void 0?function(e){return O.create(zr(e.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return b()}}(e.fieldFilter.op),e.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(e){return B.create(e.compositeFilter.filters.map(t=>xw(t)),function(t){switch(t){case"AND":return"and";case"OR":return"or";default:return b()}}(e.compositeFilter.op))}(n):b()}function rA(n){return QS[n]}function iA(n){return YS[n]}function sA(n){return JS[n]}function jr(n){return{fieldPath:n.canonicalString()}}function zr(n){return we.fromServerFormat(n.fieldPath)}function Pw(n){return n instanceof O?function(e){if(e.op==="=="){if(Hy(e.value))return{unaryFilter:{field:jr(e.field),op:"IS_NAN"}};if(Wy(e.value))return{unaryFilter:{field:jr(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(Hy(e.value))return{unaryFilter:{field:jr(e.field),op:"IS_NOT_NAN"}};if(Wy(e.value))return{unaryFilter:{field:jr(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:jr(e.field),op:iA(e.op),value:e.value}}}(n):n instanceof B?function(e){let t=e.getFilters().map(r=>Pw(r));return t.length===1?t[0]:{compositeFilter:{op:sA(e.op),filters:t}}}(n):b()}function oA(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Ow(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Zr=class n{constructor(e,t,r,i,s=C.min(),o=C.min(),a=_e.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var tc=class{constructor(e){this.fe=e}};function aA(n,e){let t;if(e.document)t=Nw(n.fe,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=_.fromSegments(e.noDocument.path),i=ar(e.noDocument.readTime);t=fe.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return b();{let r=_.fromSegments(e.unknownDocument.path),i=ar(e.unknownDocument.version);t=fe.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(r){let i=new X(r[0],r[1]);return C.fromTimestamp(i)}(e.readTime)),t}function hv(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:nc(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,s){return{name:Os(i,s.key),fields:s.data.value.mapValue.fields,updateTime:Xr(i,s.version.toTimestamp()),createTime:Xr(i,s.createTime.toTimestamp())}}(n.fe,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:or(e.version)};else{if(!e.isUnknownDocument())return b();r.unknownDocument={path:t.path.toArray(),version:or(e.version)}}return r}function nc(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function or(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ar(n){let e=new X(n.seconds,n.nanoseconds);return C.fromTimestamp(e)}function Yn(n,e){let t=(e.baseMutations||[]).map(s=>kd(n.fe,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>kd(n.fe,s)),i=X.fromMillis(e.localWriteTimeMs);return new Ds(e.batchId,i,t,r)}function vs(n){let e=ar(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ar(n.lastLimboFreeSnapshotVersion):C.min(),r;var i;return n.query.documents!==void 0?(A((i=n.query).documents.length===1),r=Ue(ui(Aw(i.documents[0])))):r=function(s){return Ue(Rw(s))}(n.query),new Zr(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,_e.fromBase64String(n.resumeToken))}function Lw(n,e){let t=or(e.snapshotVersion),r=or(e.lastLimboFreeSnapshotVersion),i;i=Qa(e.target)?kw(n.fe,e.target):Dw(n.fe,e.target);let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ir(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function tp(n){let e=Rw({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ja(e,e.limit,"L"):e}function qh(n,e){return new Rs(e.largestBatchId,kd(n.fe,e.overlayMutation))}function dv(n,e){let t=e.path.lastSegment();return[n,Pe(e.path.popLast()),t]}function fv(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:or(r.readTime),documentKey:Pe(r.documentKey.path),largestBatchId:r.largestBatchId}}var Dd=class{getBundleMetadata(e,t){return pv(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:ar(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return pv(e).put({bundleId:(r=t).id,createTime:or(se(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return mv(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:tp(i.bundledQuery),readTime:ar(i.readTime)};var i})}saveNamedQuery(e,t){return mv(e).put(function(r){return{name:r.name,readTime:or(se(r.readTime)),bundledQuery:r.bundledQuery}}(t))}};function pv(n){return Ie(n,"bundles")}function mv(n){return Ie(n,"namedQueries")}var rc=class n{constructor(e,t){this.serializer=e,this.userId=t}static de(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return ds(e).get(dv(this.userId,t)).next(r=>r?qh(this.serializer,r):null)}getOverlays(e,t){let r=It();return p.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){let i=[];return r.forEach((s,o)=>{let a=new Rs(t,o);i.push(this.we(e,a))}),p.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach(o=>i.add(Pe(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(ds(e).J("collectionPathOverlayIndex",a))}),p.waitFor(s)}getOverlaysForCollection(e,t,r){let i=It(),s=Pe(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return ds(e).j("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let u=qh(this.serializer,c);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,t,r,i){let s=It(),o,a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ds(e).X({index:"collectionGroupOverlayIndex",range:a},(c,u,l)=>{let h=qh(this.serializer,u);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):l.done()}).next(()=>s)}we(e,t){return ds(e).put(function(r,i,s){let[o,a,c]=dv(i,s.mutation.key);return{userId:i,collectionPath:a,documentId:c,collectionGroup:s.mutation.key.getCollectionGroup(),largestBatchId:s.largestBatchId,overlayMutation:Ms(r.fe,s.mutation)}}(this.serializer,this.userId,t))}};function ds(n){return Ie(n,"documentOverlays")}var Ft=class{constructor(){}_e(e,t){this.me(e,t),t.ge()}me(e,t){if("nullValue"in e)this.ye(t,5);else if("booleanValue"in e)this.ye(t,10),t.pe(e.booleanValue?1:0);else if("integerValue"in e)this.ye(t,15),t.pe(ne(e.integerValue));else if("doubleValue"in e){let r=ne(e.doubleValue);isNaN(r)?this.ye(t,13):(this.ye(t,15),bs(r)?t.pe(0):t.pe(r))}else if("timestampValue"in e){let r=e.timestampValue;this.ye(t,20),typeof r=="string"?t.Ie(r):(t.Ie(`${r.seconds||""}`),t.pe(r.nanos||0))}else if("stringValue"in e)this.Te(e.stringValue,t),this.Ee(t);else if("bytesValue"in e)this.ye(t,30),t.Ae(yn(e.bytesValue)),this.Ee(t);else if("referenceValue"in e)this.ve(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.ye(t,45),t.pe(r.latitude||0),t.pe(r.longitude||0)}else"mapValue"in e?Xv(e)?this.ye(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Ee(t)):"arrayValue"in e?(this.Pe(e.arrayValue,t),this.Ee(t)):b()}Te(e,t){this.ye(t,25),this.be(e,t)}be(e,t){t.Ie(e)}Re(e,t){let r=e.fields||{};this.ye(t,55);for(let i of Object.keys(r))this.Te(i,t),this.me(r[i],t)}Pe(e,t){let r=e.values||[];this.ye(t,50);for(let i of r)this.me(i,t)}ve(e,t){this.ye(t,37),_.fromName(e).path.forEach(r=>{this.ye(t,60),this.be(r,t)})}ye(e,t){e.pe(t)}Ee(e){e.pe(2)}};Ft.Ve=new Ft;function cA(n){if(n===0)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function gv(n){let e=64-function(t){let r=0;for(let i=0;i<8;++i){let s=cA(255&t[i]);if(r+=s,s!==8)break}return r}(n);return Math.ceil(e/8)}var Rd=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Se(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.De(r.value),r=t.next();this.Ce()}xe(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Ne(r.value),r=t.next();this.ke()}Me(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.De(r);else if(r<2048)this.De(960|r>>>6),this.De(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.De(480|r>>>12),this.De(128|63&r>>>6),this.De(128|63&r);else{let i=t.codePointAt(0);this.De(240|i>>>18),this.De(128|63&i>>>12),this.De(128|63&i>>>6),this.De(128|63&i)}}this.Ce()}$e(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Ne(r);else if(r<2048)this.Ne(960|r>>>6),this.Ne(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Ne(480|r>>>12),this.Ne(128|63&r>>>6),this.Ne(128|63&r);else{let i=t.codePointAt(0);this.Ne(240|i>>>18),this.Ne(128|63&i>>>12),this.Ne(128|63&i>>>6),this.Ne(128|63&i)}}this.ke()}Oe(e){let t=this.Fe(e),r=gv(t);this.Be(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Le(e){let t=this.Fe(e),r=gv(t);this.Be(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}qe(){this.Ue(255),this.Ue(255)}Ke(){this.Ge(255),this.Ge(255)}reset(){this.position=0}seed(e){this.Be(e.length),this.buffer.set(e,this.position),this.position+=e.length}Qe(){return this.buffer.slice(0,this.position)}Fe(e){let t=function(i){let s=new DataView(new ArrayBuffer(8));return s.setFloat64(0,i,!1),new Uint8Array(s.buffer)}(e),r=(128&t[0])!=0;t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}De(e){let t=255&e;t===0?(this.Ue(0),this.Ue(255)):t===255?(this.Ue(255),this.Ue(0)):this.Ue(t)}Ne(e){let t=255&e;t===0?(this.Ge(0),this.Ge(255)):t===255?(this.Ge(255),this.Ge(0)):this.Ge(e)}Ce(){this.Ue(0),this.Ue(1)}ke(){this.Ge(0),this.Ge(1)}Ue(e){this.Be(1),this.buffer[this.position++]=e}Ge(e){this.Be(1),this.buffer[this.position++]=~e}Be(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},xd=class{constructor(e){this.je=e}Ae(e){this.je.Se(e)}Ie(e){this.je.Me(e)}pe(e){this.je.Oe(e)}ge(){this.je.qe()}},Pd=class{constructor(e){this.je=e}Ae(e){this.je.xe(e)}Ie(e){this.je.$e(e)}pe(e){this.je.Le(e)}ge(){this.je.Ke()}},Jn=class{constructor(){this.je=new Rd,this.ze=new xd(this.je),this.We=new Pd(this.je)}seed(e){this.je.seed(e)}He(e){return e===0?this.ze:this.We}Qe(){return this.je.Qe()}reset(){this.je.reset()}};var Xn=class n{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Je(){let e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new n(this.indexId,this.documentKey,this.arrayValue,r)}};function an(n,e){let t=n.indexId-e.indexId;return t!==0?t:(t=yv(n.arrayValue,e.arrayValue),t!==0?t:(t=yv(n.directionalValue,e.directionalValue),t!==0?t:_.comparator(n.documentKey,e.documentKey)))}function yv(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}var Od=class{constructor(e){this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Ye=e.orderBy,this.Xe=[];for(let t of e.filters){let r=t;r.isInequality()?this.Ze=r:this.Xe.push(r)}}tn(e){A(e.collectionGroup===this.collectionId);let t=Zh(e);if(t!==void 0&&!this.en(t))return!1;let r=Hn(e),i=new Set,s=0,o=0;for(;s<r.length&&this.en(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Ze!==void 0){if(!i.has(this.Ze.field.canonicalString())){let a=r[s];if(!this.nn(this.Ze,a)||!this.sn(this.Ye[o++],a))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Ye.length||!this.sn(this.Ye[o++],a))return!1}return!0}en(e){for(let t of this.Xe)if(this.nn(t,e))return!0;return!1}nn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function Mw(n){var e,t;if(A(n instanceof O||n instanceof B),n instanceof O){if(n instanceof Ha){let i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>O.create(n.field,"==",s)))||[];return B.create(i,"or")}return n}let r=n.filters.map(i=>Mw(i));return B.create(r,n.op)}function uA(n){if(n.getFilters().length===0)return[];let e=Fd(Mw(n));return A(Fw(e)),Ld(e)||Md(e)?[e]:e.getFilters()}function Ld(n){return n instanceof O}function Md(n){return n instanceof B&&Yf(n)}function Fw(n){return Ld(n)||Md(n)||function(e){if(e instanceof B&&cd(e)){for(let t of e.getFilters())if(!Ld(t)&&!Md(t))return!1;return!0}return!1}(n)}function Fd(n){if(A(n instanceof O||n instanceof B),n instanceof O)return n;if(n.filters.length===1)return Fd(n.filters[0]);let e=n.filters.map(r=>Fd(r)),t=B.create(e,n.op);return t=ic(t),Fw(t)?t:(A(t instanceof B),A(Qr(t)),A(t.filters.length>1),t.filters.reduce((r,i)=>np(r,i)))}function np(n,e){let t;return A(n instanceof O||n instanceof B),A(e instanceof O||e instanceof B),t=n instanceof O?e instanceof O?function(r,i){return B.create([r,i],"and")}(n,e):vv(n,e):e instanceof O?vv(e,n):function(r,i){if(A(r.filters.length>0&&i.filters.length>0),Qr(r)&&Qr(i))return nw(r,i.getFilters());let s=cd(r)?r:i,o=cd(r)?i:r,a=s.filters.map(c=>np(c,o));return B.create(a,"or")}(n,e),ic(t)}function vv(n,e){if(Qr(e))return nw(e,n.getFilters());{let t=e.filters.map(r=>np(n,r));return B.create(t,"or")}}function ic(n){if(A(n instanceof O||n instanceof B),n instanceof O)return n;let e=n.getFilters();if(e.length===1)return ic(e[0]);if(ew(n))return n;let t=e.map(i=>ic(i)),r=[];return t.forEach(i=>{i instanceof O?r.push(i):i instanceof B&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:B.create(r,n.op)}var Ud=class{constructor(){this.rn=new Fs}addToCollectionParentIndex(e,t){return this.rn.add(t),p.resolve()}getCollectionParents(e,t){return p.resolve(this.rn.getEntries(t))}addFieldIndex(e,t){return p.resolve()}deleteFieldIndex(e,t){return p.resolve()}getDocumentsMatchingTarget(e,t){return p.resolve(null)}getIndexType(e,t){return p.resolve(0)}getFieldIndexes(e,t){return p.resolve([])}getNextCollectionGroupToUpdate(e){return p.resolve(null)}getMinOffset(e,t){return p.resolve(He.min())}getMinOffsetFromCollectionGroup(e,t){return p.resolve(He.min())}updateCollectionGroup(e,t,r){return p.resolve()}updateIndexEntries(e,t){return p.resolve()}},Fs=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new H(F.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new H(F.comparator)).toArray()}};var Ca=new Uint8Array(0),Vd=class{constructor(e,t){this.user=e,this.databaseId=t,this.on=new Fs,this.un=new Ct(r=>ir(r),(r,i)=>Hs(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.on.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.on.add(t)});let s={collectionId:r,parent:Pe(i)};return wv(e).put(s)}return p.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[qv(t),""],!1,!0);return wv(e).j(i).next(s=>{for(let o of s){if(o.collectionId!==t)break;r.push(_t(o.parent))}return r})}addFieldIndex(e,t){let r=Na(e),i=function(o){return{indexId:o.indexId,collectionGroup:o.collectionGroup,fields:o.fields.map(a=>[a.fieldPath.canonicalString(),a.kind])}}(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=ps(e);return s.next(a=>{o.put(fv(a,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){let r=Na(e),i=ps(e),s=fs(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){let r=fs(e),i=!0,s=new Map;return p.forEach(this.cn(t),o=>this.an(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=R(),a=[];return p.forEach(s,(c,u)=>{var l;y("IndexedDbIndexManager",`Using index ${l=c,`id=${l.indexId}|cg=${l.collectionGroup}|f=${l.fields.map(x=>`${x.fieldPath}:${x.kind}`).join(",")}`} to execute ${ir(t)}`);let h=function(x,Y){let Z=Zh(Y);if(Z===void 0)return null;for(let q of Ya(x,Z.fieldPath))switch(q.op){case"array-contains-any":return q.value.arrayValue.values||[];case"array-contains":return[q.value]}return null}(u,c),d=function(x,Y){let Z=new Map;for(let q of Hn(Y))for(let Ee of Ya(x,q.fieldPath))switch(Ee.op){case"==":case"in":Z.set(q.fieldPath.canonicalString(),Ee.value);break;case"not-in":case"!=":return Z.set(q.fieldPath.canonicalString(),Ee.value),Array.from(Z.values())}return null}(u,c),m=function(x,Y){let Z=[],q=!0;for(let Ee of Hn(Y)){let Dt=Ee.kind===0?Zy(x,Ee.fieldPath,x.startAt):ev(x,Ee.fieldPath,x.startAt);Z.push(Dt.value),q&&(q=Dt.inclusive)}return new At(Z,q)}(u,c),w=function(x,Y){let Z=[],q=!0;for(let Ee of Hn(Y)){let Dt=Ee.kind===0?ev(x,Ee.fieldPath,x.endAt):Zy(x,Ee.fieldPath,x.endAt);Z.push(Dt.value),q&&(q=Dt.inclusive)}return new At(Z,q)}(u,c),T=this.hn(c,u,m),S=this.hn(c,u,w),U=this.ln(c,u,d),j=this.fn(c.indexId,h,T,m.inclusive,S,w.inclusive,U);return p.forEach(j,x=>r.H(x,t.limit).next(Y=>{Y.forEach(Z=>{let q=_.fromSegments(Z.documentKey);o.has(q)||(o=o.add(q),a.push(q))})}))}).next(()=>a)}return p.resolve(null)})}cn(e){let t=this.un.get(e);return t||(e.filters.length===0?t=[e]:t=uA(B.create(e.filters,"and")).map(r=>yd(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}fn(e,t,r,i,s,o,a){let c=(t!=null?t.length:1)*Math.max(r.length,s.length),u=c/(t!=null?t.length:1),l=[];for(let h=0;h<c;++h){let d=t?this.dn(t[h/u]):Ca,m=this.wn(e,d,r[h%u],i),w=this._n(e,d,s[h%u],o),T=a.map(S=>this.wn(e,d,S,!0));l.push(...this.createRange(m,w,T))}return l}wn(e,t,r,i){let s=new Xn(e,_.empty(),t,r);return i?s:s.Je()}_n(e,t,r,i){let s=new Xn(e,_.empty(),t,r);return i?s.Je():s}an(e,t){let r=new Od(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2,i=this.cn(t);return p.forEach(i,s=>this.an(e,s).next(o=>{o?r!==0&&o.fields.length<function(a){let c=new H(we.comparator),u=!1;for(let l of a.filters)for(let h of l.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?u=!0:c=c.add(h.field));for(let l of a.orderBy)l.field.isKeyField()||(c=c.add(l.field));return c.size+(u?1:0)}(s)&&(r=1):r=0})).next(()=>function(s){return s.limit!==null}(t)&&i.length>1&&r===2?1:r)}mn(e,t){let r=new Jn;for(let i of Hn(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.He(i.kind);Ft.Ve._e(s,o)}return r.Qe()}dn(e){let t=new Jn;return Ft.Ve._e(e,t.He(0)),t.Qe()}gn(e,t){let r=new Jn;return Ft.Ve._e(rr(this.databaseId,t),r.He(function(i){let s=Hn(i);return s.length===0?0:s[s.length-1].kind}(e))),r.Qe()}ln(e,t,r){if(r===null)return[];let i=[];i.push(new Jn);let s=0;for(let o of Hn(e)){let a=r[s++];for(let c of i)if(this.yn(t,o.fieldPath)&&Ns(a))i=this.pn(i,o,a);else{let u=c.He(o.kind);Ft.Ve._e(a,u)}}return this.In(i)}hn(e,t,r){return this.ln(e,t,r.position)}In(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].Qe();return t}pn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let c=new Jn;c.seed(a.Qe()),Ft.Ve._e(o,c.He(t.kind)),s.push(c)}return s}yn(e,t){return!!e.filters.find(r=>r instanceof O&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){let r=Na(e),i=ps(e);return(t?r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.j()).next(s=>{let o=[];return p.forEach(s,a=>i.get([a.indexId,this.uid]).next(c=>{o.push(function(u,l){let h=l?new ja(l.sequenceNumber,new He(ar(l.readTime),new _(_t(l.documentKey)),l.largestBatchId)):ja.empty(),d=u.fields.map(([m,w])=>new ed(we.fromServerFormat(m),w));return new qa(u.indexId,u.collectionGroup,d,h)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:D(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){let i=Na(e),s=ps(e);return this.Tn(e).next(o=>i.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>p.forEach(a,c=>s.put(fv(c.indexId,this.user,o,r)))))}updateIndexEntries(e,t){let r=new Map;return p.forEach(t,(i,s)=>{let o=r.get(i.collectionGroup);return(o?p.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),p.forEach(a,c=>this.En(e,i,c).next(u=>{let l=this.An(s,c);return u.isEqual(l)?p.resolve():this.vn(e,s,c,u,l)}))))})}Rn(e,t,r,i){return fs(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.gn(r,t.key),documentKey:t.key.path.toArray()})}Pn(e,t,r,i){return fs(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.gn(r,t.key),t.key.path.toArray()])}En(e,t,r){let i=fs(e),s=new H(an);return i.X({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.gn(r,t)])},(o,a)=>{s=s.add(new Xn(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}An(e,t){let r=new H(an),i=this.mn(t,e);if(i==null)return r;let s=Zh(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Ns(o))for(let a of o.arrayValue.values||[])r=r.add(new Xn(t.indexId,e.key,this.dn(a),i))}else r=r.add(new Xn(t.indexId,e.key,Ca,i));return r}vn(e,t,r,i,s){y("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let o=[];return function(a,c,u,l,h){let d=a.getIterator(),m=c.getIterator(),w=Br(d),T=Br(m);for(;w||T;){let S=!1,U=!1;if(w&&T){let j=u(w,T);j<0?U=!0:j>0&&(S=!0)}else w!=null?U=!0:S=!0;S?(l(T),T=Br(m)):U?(h(w),w=Br(d)):(w=Br(d),T=Br(m))}}(i,s,an,a=>{o.push(this.Rn(e,t,r,a))},a=>{o.push(this.Pn(e,t,r,a))}),p.waitFor(o)}Tn(e){let t=1;return ps(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>an(o,a)).filter((o,a,c)=>!a||an(o,c[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=an(o,e),c=an(o,t);if(a===0)i[0]=e.Je();else if(a>0&&c<0)i.push(o),i.push(o.Je());else if(c>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.bn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Ca,[]],c=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Ca,[]];s.push(IDBKeyRange.bound(a,c))}return s}bn(e,t){return an(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(_v)}getMinOffset(e,t){return p.mapArray(this.cn(t),r=>this.an(e,r).next(i=>i||b())).next(_v)}};function wv(n){return Ie(n,"collectionParents")}function fs(n){return Ie(n,"indexEntries")}function Na(n){return Ie(n,"indexConfiguration")}function ps(n){return Ie(n,"indexState")}function _v(n){A(n.length!==0);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;Wf(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new He(e.readTime,e.documentKey,t)}var Iv={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Ke=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function Uw(n,e,t){let r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId),a=0,c=r.X({range:o},(l,h,d)=>(a++,d.delete()));s.push(c.next(()=>{A(a===1)}));let u=[];for(let l of t.mutations){let h=Kv(e,l.key.path,t.batchId);s.push(i.delete(h)),u.push(l.key)}return p.waitFor(s).next(()=>u)}function sc(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw b();e=n.noDocument}return JSON.stringify(e).length}Ke.DEFAULT_COLLECTION_PERCENTILE=10,Ke.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ke.DEFAULT=new Ke(41943040,Ke.DEFAULT_COLLECTION_PERCENTILE,Ke.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ke.DISABLED=new Ke(-1,0,0);var oc=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Vn={}}static de(e,t,r,i){A(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return cn(e).X({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){let s=Gr(e),o=cn(e);return o.add({}).next(a=>{A(typeof a=="number");let c=new Ds(a,t,r,i),u=function(d,m,w){let T=w.baseMutations.map(U=>Ms(d.fe,U)),S=w.mutations.map(U=>Ms(d.fe,U));return{userId:m,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:T,mutations:S}}(this.serializer,this.userId,c),l=[],h=new H((d,m)=>D(d.canonicalString(),m.canonicalString()));for(let d of i){let m=Kv(this.userId,d.key.path,a);h=h.add(d.key.path.popLast()),l.push(o.put(u)),l.push(s.put(m,yS))}return h.forEach(d=>{l.push(this.indexManager.addToCollectionParentIndex(e,d))}),e.addOnCommittedListener(()=>{this.Vn[a]=c.keys()}),p.waitFor(l).next(()=>c)})}lookupMutationBatch(e,t){return cn(e).get(t).next(r=>r?(A(r.userId===this.userId),Yn(this.serializer,r)):null)}Sn(e,t){return this.Vn[t]?p.resolve(this.Vn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){let i=r.keys();return this.Vn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return cn(e).X({index:"userMutationsIndex",range:i},(o,a,c)=>{a.userId===this.userId&&(A(a.batchId>=r),s=Yn(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return cn(e).X({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return cn(e).j("userMutationsIndex",t).next(r=>r.map(i=>Yn(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=xa(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return Gr(e).X({range:i},(o,a,c)=>{let[u,l,h]=o,d=_t(l);if(u===this.userId&&t.path.isEqual(d))return cn(e).get(h).next(m=>{if(!m)throw b();A(m.userId===this.userId),s.push(Yn(this.serializer,m))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new H(D),i=[];return t.forEach(s=>{let o=xa(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=Gr(e).X({range:a},(u,l,h)=>{let[d,m,w]=u,T=_t(m);d===this.userId&&s.path.isEqual(T)?r=r.add(w):h.done()});i.push(c)}),p.waitFor(i).next(()=>this.Dn(e,r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=xa(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new H(D);return Gr(e).X({range:o},(c,u,l)=>{let[h,d,m]=c,w=_t(d);h===this.userId&&r.isPrefixOf(w)?w.length===i&&(a=a.add(m)):l.done()}).next(()=>this.Dn(e,a))}Dn(e,t){let r=[],i=[];return t.forEach(s=>{i.push(cn(e).get(s).next(o=>{if(o===null)throw b();A(o.userId===this.userId),r.push(Yn(this.serializer,o))}))}),p.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return Uw(e.ht,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.Cn(t.batchId)}),p.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Cn(e){delete this.Vn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return p.resolve();let r=IDBKeyRange.lowerBound([this.userId]),i=[];return Gr(e).X({range:r},(s,o,a)=>{if(s[0]===this.userId){let c=_t(s[1]);i.push(c)}else a.done()}).next(()=>{A(i.length===0)})})}containsKey(e,t){return Vw(e,this.userId,t)}xn(e){return Bw(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function Vw(n,e,t){let r=xa(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return Gr(n).X({range:s,Y:!0},(a,c,u)=>{let[l,h,d]=a;l===e&&h===i&&(o=!0),u.done()}).next(()=>o)}function cn(n){return Ie(n,"mutations")}function Gr(n){return Ie(n,"documentMutations")}function Bw(n){return Ie(n,"mutationQueues")}var ei=class n{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static kn(){return new n(0)}static Mn(){return new n(-1)}};var Bd=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.$n(e).next(t=>{let r=new ei(t.highestTargetId);return t.highestTargetId=r.next(),this.On(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.$n(e).next(t=>C.fromTimestamp(new X(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.$n(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.$n(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.On(e,i)))}addTargetData(e,t){return this.Fn(e,t).next(()=>this.$n(e).next(r=>(r.targetCount+=1,this.Bn(t,r),this.On(e,r))))}updateTargetData(e,t){return this.Fn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>qr(e).delete(t.targetId)).next(()=>this.$n(e)).next(r=>(A(r.targetCount>0),r.targetCount-=1,this.On(e,r)))}removeTargets(e,t,r){let i=0,s=[];return qr(e).X((o,a)=>{let c=vs(a);c.sequenceNumber<=t&&r.get(c.targetId)===null&&(i++,s.push(this.removeTargetData(e,c)))}).next(()=>p.waitFor(s)).next(()=>i)}forEachTarget(e,t){return qr(e).X((r,i)=>{let s=vs(i);t(s)})}$n(e){return Ev(e).get("targetGlobalKey").next(t=>(A(t!==null),t))}On(e,t){return Ev(e).put("targetGlobalKey",t)}Fn(e,t){return qr(e).put(Lw(this.serializer,t))}Bn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.$n(e).next(t=>t.targetCount)}getTargetData(e,t){let r=ir(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return qr(e).X({range:i,index:"queryTargetsIndex"},(o,a,c)=>{let u=vs(a);Hs(t,u.target)&&(s=u,c.done())}).next(()=>s)}addMatchingKeys(e,t,r){let i=[],s=un(e);return t.forEach(o=>{let a=Pe(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),p.waitFor(i)}removeMatchingKeys(e,t,r){let i=un(e);return p.forEach(t,s=>{let o=Pe(s.path);return p.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){let r=un(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=un(e),s=R();return i.X({range:r,Y:!0},(o,a,c)=>{let u=_t(o[1]),l=new _(u);s=s.add(l)}).next(()=>s)}containsKey(e,t){let r=Pe(t.path),i=IDBKeyRange.bound([r],[qv(r)],!1,!0),s=0;return un(e).X({index:"documentTargetsIndex",Y:!0,range:i},([o,a],c,u)=>{o!==0&&(s++,u.done())}).next(()=>s>0)}le(e,t){return qr(e).get(t).next(r=>r?vs(r):null)}};function qr(n){return Ie(n,"targets")}function Ev(n){return Ie(n,"targetGlobal")}function un(n){return Ie(n,"targetDocuments")}function Tv([n,e],[t,r]){let i=D(n,t);return i===0?D(e,r):i}var qd=class{constructor(e){this.Ln=e,this.buffer=new H(Tv),this.qn=0}Un(){return++this.qn}Kn(e){let t=[e,this.Un()];if(this.buffer.size<this.Ln)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();Tv(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},jd=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Qn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}Qn(e){y("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Gn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){An(t)?y("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t):await Sn(t)}await this.Qn(3e5)})}},zd=class{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.zn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return p.resolve(Re.ct);let r=new qd(t);return this.jn.forEachTarget(e,i=>r.Kn(i.sequenceNumber)).next(()=>this.jn.Wn(e,i=>r.Kn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(y("LruGarbageCollector","Garbage collection skipped; disabled"),p.resolve(Iv)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(y("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Iv):this.Hn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Hn(e,t){let r,i,s,o,a,c,u,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(y("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,t))).next(h=>(s=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),$h()<=P.DEBUG&&y("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${h} documents in `+(u-c)+`ms
Total Duration: ${u-l}ms`),p.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}};function lA(n,e){return new zd(n,e)}var Gd=class{constructor(e,t){this.db=e,this.garbageCollector=lA(this,t)}zn(e){let t=this.Jn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}Jn(e){let t=0;return this.Wn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Wn(e,t){return this.Yn(e,(r,i)=>t(i))}addReference(e,t,r){return ka(e,r)}removeReference(e,t,r){return ka(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return ka(e,t)}Xn(e,t){return function(r,i){let s=!1;return Bw(r).Z(o=>Vw(r,o,i).next(a=>(a&&(s=!0),p.resolve(!a)))).next(()=>s)}(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Yn(e,(o,a)=>{if(a<=t){let c=this.Xn(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,C.min()),un(e).delete([0,Pe(o.path)])))});i.push(c)}}).next(()=>p.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return ka(e,t)}Yn(e,t){let r=un(e),i,s=Re.ct;return r.X({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:u})=>{o===0?(s!==Re.ct&&t(new _(_t(i)),s),s=u,i=c):s=Re.ct}).next(()=>{s!==Re.ct&&t(new _(_t(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function ka(n,e){return un(n).put(function(t,r){return{targetId:0,path:Pe(t.path),sequenceNumber:r}}(e,n.currentSequenceNumber))}var ac=class{constructor(){this.changes=new Ct(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,fe.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?p.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var $d=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Wn(e).put(r)}removeEntry(e,t,r){return Wn(e).delete(function(i,s){let o=i.path.toArray();return[o.slice(0,o.length-2),o[o.length-2],nc(s),o[o.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Zn(e,r)))}getEntry(e,t){let r=fe.newInvalidDocument(t);return Wn(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(ms(t))},(i,s)=>{r=this.ts(t,s)}).next(()=>r)}es(e,t){let r={size:0,document:fe.newInvalidDocument(t)};return Wn(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(ms(t))},(i,s)=>{r={document:this.ts(t,s),size:sc(s)}}).next(()=>r)}getEntries(e,t){let r=Fe();return this.ns(e,t,(i,s)=>{let o=this.ts(i,s);r=r.insert(i,o)}).next(()=>r)}ss(e,t){let r=Fe(),i=new K(_.comparator);return this.ns(e,t,(s,o)=>{let a=this.ts(s,o);r=r.insert(s,a),i=i.insert(s,sc(o))}).next(()=>({documents:r,rs:i}))}ns(e,t,r){if(t.isEmpty())return p.resolve();let i=new H(Av);t.forEach(c=>i=i.add(c));let s=IDBKeyRange.bound(ms(i.first()),ms(i.last())),o=i.getIterator(),a=o.getNext();return Wn(e).X({index:"documentKeyIndex",range:s},(c,u,l)=>{let h=_.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&Av(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?l.G(ms(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i){let s=t.path,o=[s.popLast().toArray(),s.lastSegment(),nc(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Wn(e).j(IDBKeyRange.bound(o,a,!0)).next(c=>{let u=Fe();for(let l of c){let h=this.ts(_.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);h.isFoundDocument()&&(Ys(t,h)||i.has(h.key))&&(u=u.insert(h.key,h))}return u})}getAllFromCollectionGroup(e,t,r,i){let s=Fe(),o=Sv(t,r),a=Sv(t,He.max());return Wn(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,u,l)=>{let h=this.ts(_.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(h.key,h),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new Kd(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return bv(e).get("remoteDocumentGlobalKey").next(t=>(A(!!t),t))}Zn(e,t){return bv(e).put("remoteDocumentGlobalKey",t)}ts(e,t){if(t){let r=aA(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(C.min())))return r}return fe.newInvalidDocument(e)}};function qw(n){return new $d(n)}var Kd=class extends ac{constructor(e,t){super(),this.os=e,this.trackRemovals=t,this.us=new Ct(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let t=[],r=0,i=new H((s,o)=>D(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.us.get(s);if(t.push(this.os.removeEntry(e,s,a.readTime)),o.isValidDocument()){let c=hv(this.os.serializer,o);i=i.add(s.path.popLast());let u=sc(c);r+=u-a.size,t.push(this.os.addEntry(e,s,c))}else if(r-=a.size,this.trackRemovals){let c=hv(this.os.serializer,o.convertToNoDocument(C.min()));t.push(this.os.addEntry(e,s,c))}}),i.forEach(s=>{t.push(this.os.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.os.updateMetadata(e,r)),p.waitFor(t)}getFromCache(e,t){return this.os.es(e,t).next(r=>(this.us.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.os.ss(e,t).next(({documents:r,rs:i})=>(i.forEach((s,o)=>{this.us.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function bv(n){return Ie(n,"remoteDocumentGlobal")}function Wn(n){return Ie(n,"remoteDocumentsV14")}function ms(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Sv(n,e){let t=e.documentKey.path.toArray();return[n,nc(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Av(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=D(t[s],r[s]),i)return i;return i=D(t.length,r.length),i||(i=D(t[t.length-2],r[r.length-2]),i||D(t[t.length-1],r[r.length-1]))}var Wd=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var cc=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Is(r.mutation,i,je.empty(),X.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,R()).next(()=>r))}getLocalViewOfDocuments(e,t,r=R()){let i=It();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=ys();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){let r=It();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,R()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=Fe(),o=_s(),a=_s();return t.forEach((c,u)=>{let l=r.get(u.key);i.has(u.key)&&(l===void 0||l.mutation instanceof st)?s=s.insert(u.key,u):l!==void 0?(o.set(u.key,l.mutation.getFieldMask()),Is(l.mutation,u,l.mutation.getFieldMask(),X.now())):o.set(u.key,je.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((u,l)=>o.set(u,l)),t.forEach((u,l)=>{var h;return a.set(u,new Wd(l,(h=o.get(u))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,t){let r=_s(),i=new K((o,a)=>o-a),s=R();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(let a of o)a.keys().forEach(c=>{let u=t.get(c);if(u===null)return;let l=r.get(c)||je.empty();l=a.applyToLocalView(u,l),r.set(c,l);let h=(i.get(a.batchId)||R()).add(c);i=i.insert(a.batchId,h)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),u=c.key,l=c.value,h=hw();l.forEach(d=>{if(!s.has(d)){let m=ww(t.get(d),r.get(d));m!==null&&h.set(d,m),s=s.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return p.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return function(i){return _.isDocumentKey(i.path)&&i.collectionGroup===null&&i.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Xf(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):p.resolve(It()),a=-1,c=s;return o.next(u=>p.forEach(u,(l,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(l)?p.resolve():this.remoteDocumentCache.getEntry(e,l).next(d=>{c=c.insert(l,d)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,c,u,R())).next(l=>({batchId:a,changes:lw(l)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new _(t)).next(r=>{let i=ys();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){let i=t.collectionGroup,s=ys();return this.indexManager.getCollectionParents(e,i).next(o=>p.forEach(o,a=>{let c=function(u,l){return new it(l,null,u.explicitOrderBy.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt)}(t,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r).next(u=>{u.forEach((l,h)=>{s=s.insert(l,h)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i))).next(s=>{i.forEach((a,c)=>{let u=c.getKey();s.get(u)===null&&(s=s.insert(u,fe.newInvalidDocument(u)))});let o=ys();return s.forEach((a,c)=>{let u=i.get(a);u!==void 0&&Is(u.mutation,c,je.empty(),X.now()),Ys(t,c)&&(o=o.insert(a,c))}),o})}};var Hd=class{constructor(e){this.serializer=e,this.cs=new Map,this.hs=new Map}getBundleMetadata(e,t){return p.resolve(this.cs.get(t))}saveBundleMetadata(e,t){var r;return this.cs.set(t.id,{id:(r=t).id,version:r.version,createTime:se(r.createTime)}),p.resolve()}getNamedQuery(e,t){return p.resolve(this.hs.get(t))}saveNamedQuery(e,t){return this.hs.set(t.name,function(r){return{name:r.name,query:tp(r.bundledQuery),readTime:se(r.readTime)}}(t)),p.resolve()}};var Qd=class{constructor(){this.overlays=new K(_.comparator),this.ls=new Map}getOverlay(e,t){return p.resolve(this.overlays.get(t))}getOverlays(e,t){let r=It();return p.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.we(e,t,s)}),p.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.ls.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.ls.delete(r)),p.resolve()}getOverlaysForCollection(e,t,r){let i=It(),s=t.length+1,o=new _(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,u=c.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return p.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new K((u,l)=>u-l),o=this.overlays.getIterator();for(;o.hasNext();){let u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let l=s.get(u.largestBatchId);l===null&&(l=It(),s=s.insert(u.largestBatchId,l)),l.set(u.getKey(),u)}}let a=It(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,l)=>a.set(u,l)),!(a.size()>=i)););return p.resolve(a)}we(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.ls.get(i.largestBatchId).delete(r.key);this.ls.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Rs(t,r));let s=this.ls.get(t);s===void 0&&(s=R(),this.ls.set(t,s)),this.ls.set(t,s.add(r.key))}};var Us=class{constructor(){this.fs=new H(le.ds),this.ws=new H(le._s)}isEmpty(){return this.fs.isEmpty()}addReference(e,t){let r=new le(e,t);this.fs=this.fs.add(r),this.ws=this.ws.add(r)}gs(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.ys(new le(e,t))}ps(e,t){e.forEach(r=>this.removeReference(r,t))}Is(e){let t=new _(new F([])),r=new le(t,e),i=new le(t,e+1),s=[];return this.ws.forEachInRange([r,i],o=>{this.ys(o),s.push(o.key)}),s}Ts(){this.fs.forEach(e=>this.ys(e))}ys(e){this.fs=this.fs.delete(e),this.ws=this.ws.delete(e)}Es(e){let t=new _(new F([])),r=new le(t,e),i=new le(t,e+1),s=R();return this.ws.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let t=new le(e,0),r=this.fs.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},le=class{constructor(e,t){this.key=e,this.As=t}static ds(e,t){return _.comparator(e.key,t.key)||D(e.As,t.As)}static _s(e,t){return D(e.As,t.As)||_.comparator(e.key,t.key)}};var Yd=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.vs=1,this.Rs=new H(le.ds)}checkEmpty(e){return p.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.vs;this.vs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Ds(s,t,r,i);this.mutationQueue.push(o);for(let a of i)this.Rs=this.Rs.add(new le(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return p.resolve(o)}lookupMutationBatch(e,t){return p.resolve(this.Ps(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.bs(r),s=i<0?0:i;return p.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return p.resolve(this.mutationQueue.length===0?-1:this.vs-1)}getAllMutationBatches(e){return p.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new le(t,0),i=new le(t,Number.POSITIVE_INFINITY),s=[];return this.Rs.forEachInRange([r,i],o=>{let a=this.Ps(o.As);s.push(a)}),p.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new H(D);return t.forEach(i=>{let s=new le(i,0),o=new le(i,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([s,o],a=>{r=r.add(a.As)})}),p.resolve(this.Vs(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;_.isDocumentKey(s)||(s=s.child(""));let o=new le(new _(s),0),a=new H(D);return this.Rs.forEachWhile(c=>{let u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(c.As)),!0)},o),p.resolve(this.Vs(a))}Vs(e){let t=[];return e.forEach(r=>{let i=this.Ps(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){A(this.Ss(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.Rs;return p.forEach(t.mutations,i=>{let s=new le(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Rs=r})}Cn(e){}containsKey(e,t){let r=new le(t,0),i=this.Rs.firstAfterOrEqual(r);return p.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,p.resolve()}Ss(e,t){return this.bs(e)}bs(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Ps(e){let t=this.bs(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Jd=class{constructor(e){this.Ds=e,this.docs=new K(_.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Ds(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return p.resolve(r?r.document.mutableCopy():fe.newInvalidDocument(t))}getEntries(e,t){let r=Fe();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():fe.newInvalidDocument(i))}),p.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Fe(),o=t.path,a=new _(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:u,value:{document:l}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||Wf(zv(l),r)<=0||(i.has(l.key)||Ys(t,l))&&(s=s.insert(l.key,l.mutableCopy()))}return p.resolve(s)}getAllFromCollectionGroup(e,t,r,i){b()}Cs(e,t){return p.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Xd(this)}getSize(e){return p.resolve(this.size)}},Xd=class extends ac{constructor(e){super(),this.os=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.os.addEntry(e,i)):this.os.removeEntry(r)}),p.waitFor(t)}getFromCache(e,t){return this.os.getEntry(e,t)}getAllFromCache(e,t){return this.os.getEntries(e,t)}};var Zd=class{constructor(e){this.persistence=e,this.xs=new Ct(t=>ir(t),Hs),this.lastRemoteSnapshotVersion=C.min(),this.highestTargetId=0,this.Ns=0,this.ks=new Us,this.targetCount=0,this.Ms=ei.kn()}forEachTarget(e,t){return this.xs.forEach((r,i)=>t(i)),p.resolve()}getLastRemoteSnapshotVersion(e){return p.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return p.resolve(this.Ns)}allocateTargetId(e){return this.highestTargetId=this.Ms.next(),p.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Ns&&(this.Ns=t),p.resolve()}Fn(e){this.xs.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.Ms=new ei(t),this.highestTargetId=t),e.sequenceNumber>this.Ns&&(this.Ns=e.sequenceNumber)}addTargetData(e,t){return this.Fn(t),this.targetCount+=1,p.resolve()}updateTargetData(e,t){return this.Fn(t),p.resolve()}removeTargetData(e,t){return this.xs.delete(t.target),this.ks.Is(t.targetId),this.targetCount-=1,p.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.xs.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.xs.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),p.waitFor(s).next(()=>i)}getTargetCount(e){return p.resolve(this.targetCount)}getTargetData(e,t){let r=this.xs.get(t)||null;return p.resolve(r)}addMatchingKeys(e,t,r){return this.ks.gs(t,r),p.resolve()}removeMatchingKeys(e,t,r){this.ks.ps(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),p.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ks.Is(t),p.resolve()}getMatchingKeysForTargetId(e,t){let r=this.ks.Es(t);return p.resolve(r)}containsKey(e,t){return p.resolve(this.ks.containsKey(t))}};var uc=class{constructor(e,t){this.$s={},this.overlays={},this.Os=new Re(0),this.Fs=!1,this.Fs=!0,this.referenceDelegate=e(this),this.Bs=new Zd(this),this.indexManager=new Ud,this.remoteDocumentCache=function(r){return new Jd(r)}(r=>this.referenceDelegate.Ls(r)),this.serializer=new tc(t),this.qs=new Hd(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Fs=!1,Promise.resolve()}get started(){return this.Fs}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Qd,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.$s[e.toKey()];return r||(r=new Yd(t,this.referenceDelegate),this.$s[e.toKey()]=r),r}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.qs}runTransaction(e,t,r){y("MemoryPersistence","Starting transaction:",e);let i=new ef(this.Os.next());return this.referenceDelegate.Us(),r(i).next(s=>this.referenceDelegate.Ks(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gs(e,t){return p.or(Object.values(this.$s).map(r=>()=>r.containsKey(e,t)))}},ef=class extends za{constructor(e){super(),this.currentSequenceNumber=e}},lc=class n{constructor(e){this.persistence=e,this.Qs=new Us,this.js=null}static zs(e){return new n(e)}get Ws(){if(this.js)return this.js;throw b()}addReference(e,t,r){return this.Qs.addReference(r,t),this.Ws.delete(r.toString()),p.resolve()}removeReference(e,t,r){return this.Qs.removeReference(r,t),this.Ws.add(r.toString()),p.resolve()}markPotentiallyOrphaned(e,t){return this.Ws.add(t.toString()),p.resolve()}removeTarget(e,t){this.Qs.Is(t.targetId).forEach(i=>this.Ws.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Ws.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}Us(){this.js=new Set}Ks(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return p.forEach(this.Ws,r=>{let i=_.fromPath(r);return this.Hs(e,i).next(s=>{s||t.removeEntry(i,C.min())})}).next(()=>(this.js=null,t.apply(e)))}updateLimboDocument(e,t){return this.Hs(e,t).next(r=>{r?this.Ws.delete(t.toString()):this.Ws.add(t.toString())})}Ls(e){return 0}Hs(e,t){return p.or([()=>p.resolve(this.Qs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gs(e,t)])}};var tf=class{constructor(e){this.serializer=e}O(e,t,r,i){let s=new Ga("createOrUpgrade",t);r<1&&i>=1&&(function(a){a.createObjectStore("owner")}(e),function(a){a.createObjectStore("mutationQueues",{keyPath:"userId"}),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Gy,{unique:!0}),a.createObjectStore("documentMutations")}(e),Cv(e),function(a){a.createObjectStore("remoteDocuments")}(e));let o=p.resolve();return r<3&&i>=3&&(r!==0&&(function(a){a.deleteObjectStore("targetDocuments"),a.deleteObjectStore("targets"),a.deleteObjectStore("targetGlobal")}(e),Cv(e)),o=o.next(()=>function(a){let c=a.store("targetGlobal"),u={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:C.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",u)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(a,c){return c.store("mutations").j().next(u=>{a.deleteObjectStore("mutations"),a.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Gy,{unique:!0});let l=c.store("mutations"),h=u.map(d=>l.put(d));return p.waitFor(h)})}(e,s))),o=o.next(()=>{(function(a){a.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Ys(s))),r<6&&i>=6&&(o=o.next(()=>(function(a){a.createObjectStore("remoteDocumentGlobal")}(e),this.Xs(s)))),r<7&&i>=7&&(o=o.next(()=>this.Zs(s))),r<8&&i>=8&&(o=o.next(()=>this.ti(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(a){a.objectStoreNames.contains("remoteDocumentChanges")&&a.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ei(s))),r<11&&i>=11&&(o=o.next(()=>{(function(a){a.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(a){a.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(a){let c=a.createObjectStore("documentOverlays",{keyPath:kS});c.createIndex("collectionPathOverlayIndex",DS,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",RS,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(a){let c=a.createObjectStore("remoteDocumentsV14",{keyPath:vS});c.createIndex("documentKeyIndex",wS),c.createIndex("collectionGroupIndex",_S)}(e)).next(()=>this.ni(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(a){a.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),a.createObjectStore("indexState",{keyPath:SS}).createIndex("sequenceNumberIndex",AS,{unique:!1}),a.createObjectStore("indexEntries",{keyPath:CS}).createIndex("documentKeyIndex",NS,{unique:!1})}(e))),o}Xs(e){let t=0;return e.store("remoteDocuments").X((r,i)=>{t+=sc(i)}).next(()=>{let r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Ys(e){let t=e.store("mutationQueues"),r=e.store("mutations");return t.j().next(i=>p.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.j("userMutationsIndex",o).next(a=>p.forEach(a,c=>{A(c.userId===s.userId);let u=Yn(this.serializer,c);return Uw(e,s.userId,u).next(()=>{})}))}))}Zs(e){let t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.X((o,a)=>{let c=new F(o),u=function(l){return[0,Pe(l)]}(c);s.push(t.get(u).next(l=>l?p.resolve():(h=>t.put({targetId:0,path:Pe(h),sequenceNumber:i.highestListenSequenceNumber}))(c)))}).next(()=>p.waitFor(s))})}ti(e,t){e.createObjectStore("collectionParents",{keyPath:bS});let r=t.store("collectionParents"),i=new Fs,s=o=>{if(i.add(o)){let a=o.lastSegment(),c=o.popLast();return r.put({collectionId:a,parent:Pe(c)})}};return t.store("remoteDocuments").X({Y:!0},(o,a)=>{let c=new F(o);return s(c.popLast())}).next(()=>t.store("documentMutations").X({Y:!0},([o,a,c],u)=>{let l=_t(a);return s(l.popLast())}))}ei(e){let t=e.store("targets");return t.X((r,i)=>{let s=vs(i),o=Lw(this.serializer,s);return t.put(o)})}ni(e,t){let r=t.store("remoteDocuments"),i=[];return r.X((s,o)=>{let a=t.store("remoteDocumentsV14"),c=(u=o,u.document?new _(F.fromString(u.document.name).popFirst(5)):u.noDocument?_.fromSegments(u.noDocument.path):u.unknownDocument?_.fromSegments(u.unknownDocument.path):b()).path.toArray();var u;let l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(l))}).next(()=>p.waitFor(i))}si(e,t){let r=t.store("mutations"),i=qw(this.serializer),s=new uc(lc.zs,this.serializer.fe);return r.j().next(o=>{let a=new Map;return o.forEach(c=>{var u;let l=(u=a.get(c.userId))!==null&&u!==void 0?u:R();Yn(this.serializer,c).keys().forEach(h=>l=l.add(h)),a.set(c.userId,l)}),p.forEach(a,(c,u)=>{let l=new he(u),h=rc.de(this.serializer,l),d=s.getIndexManager(l),m=oc.de(l,this.serializer,d,s.referenceDelegate);return new cc(i,m,h,d).recalculateAndSaveOverlaysForDocumentKeys(new Ss(t,Re.ct),c).next()})})}};function Cv(n){n.createObjectStore("targetDocuments",{keyPath:ES}).createIndex("documentTargetsIndex",TS,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",IS,{unique:!0}),n.createObjectStore("targetGlobal")}var jh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",nf=class n{constructor(e,t,r,i,s,o,a,c,u,l,h=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ii=s,this.window=o,this.document=a,this.ri=u,this.oi=l,this.ui=h,this.Os=null,this.Fs=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.ai=null,this.hi=null,this.li=Number.NEGATIVE_INFINITY,this.fi=d=>Promise.resolve(),!n.D())throw new g(f.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Gd(this,i),this.di=t+"main",this.serializer=new tc(c),this.wi=new mn(this.di,this.ui,new tf(this.serializer)),this.Bs=new Bd(this.referenceDelegate,this.serializer),this.remoteDocumentCache=qw(this.serializer),this.qs=new Dd,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,l===!1&&ie("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new g(f.FAILED_PRECONDITION,jh);return this.gi(),this.yi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Bs.getHighestSequenceNumber(e))}).then(e=>{this.Os=new Re(e,this.ri)}).then(()=>{this.Fs=!0}).catch(e=>(this.wi&&this.wi.close(),Promise.reject(e)))}Ii(e){return this.fi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.wi.B(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ii.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Da(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ti(e).next(t=>{t||(this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Ei(e)).next(t=>this.isPrimary&&!t?this.Ai(e).next(()=>!1):!!t&&this.vi(e).next(()=>!0))).catch(e=>{if(An(e))return y("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return y("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ii.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Ti(e){return gs(e).get("owner").next(t=>p.resolve(this.Ri(t)))}Pi(e){return Da(e).delete(this.clientId)}async bi(){if(this.isPrimary&&!this.Vi(this.li,18e5)){this.li=Date.now();let e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{let r=Ie(t,"clientMetadata");return r.j().next(i=>{let s=this.Si(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return p.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this._i)for(let t of e)this._i.removeItem(this.Di(t.clientId))}}pi(){this.hi=this.ii.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.bi()).then(()=>this.pi()))}Ri(e){return!!e&&e.ownerId===this.clientId}Ei(e){return this.oi?p.resolve(!0):gs(e).get("owner").next(t=>{if(t!==null&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)){if(this.Ri(t)&&this.networkEnabled)return!0;if(!this.Ri(t)){if(!t.allowTabSynchronization)throw new g(f.FAILED_PRECONDITION,jh);return!1}}return!(!this.networkEnabled||!this.inForeground)||Da(e).j().next(r=>this.Si(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&y("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.Fs=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Ni(),this.ki(),await this.wi.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new Ss(e,Re.ct);return this.Ai(t).next(()=>this.Pi(t))}),this.wi.close(),this.Mi()}Si(e,t){return e.filter(r=>this.Vi(r.updateTimeMs,t)&&!this.Ci(r.clientId))}$i(){return this.runTransaction("getActiveClients","readonly",e=>Da(e).j().next(t=>this.Si(t,18e5).map(r=>r.clientId)))}get started(){return this.Fs}getMutationQueue(e,t){return oc.de(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Bs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Vd(e,this.serializer.fe.databaseId)}getDocumentOverlayCache(e){return rc.de(this.serializer,e)}getBundleCache(){return this.qs}runTransaction(e,t,r){y("IndexedDbPersistence","Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=(o=this.ui)===15?PS:o===14?Qv:o===13?Hv:o===12?xS:o===11?Wv:void b();var o;let a;return this.wi.runTransaction(e,i,s,c=>(a=new Ss(c,this.Os?this.Os.next():Re.ct),t==="readwrite-primary"?this.Ti(a).next(u=>!!u||this.Ei(a)).next(u=>{if(!u)throw ie(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ii.enqueueRetryable(()=>this.fi(!1)),new g(f.FAILED_PRECONDITION,Gv);return r(a)}).next(u=>this.vi(a).next(()=>u)):this.Oi(a).next(()=>r(a)))).then(c=>(a.raiseOnCommittedEvent(),c))}Oi(e){return gs(e).get("owner").next(t=>{if(t!==null&&this.Vi(t.leaseTimestampMs,5e3)&&!this.Ci(t.ownerId)&&!this.Ri(t)&&!(this.oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new g(f.FAILED_PRECONDITION,jh)})}vi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return gs(e).put("owner",t)}static D(){return mn.D()}Ai(e){let t=gs(e);return t.get("owner").next(r=>this.Ri(r)?(y("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):p.resolve())}Vi(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(ie(`Detected an update time that is in the future: ${e} > ${r}`),!1))}gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ai=()=>{this.ii.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.ai),this.inForeground=this.document.visibilityState==="visible")}Ni(){this.ai&&(this.document.removeEventListener("visibilitychange",this.ai),this.ai=null)}yi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let t=/(?:Version|Mobile)\/1[456]/;Wp()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ii.enterRestrictedMode(!0),this.ii.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}ki(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Ci(e){var t;try{let r=((t=this._i)===null||t===void 0?void 0:t.getItem(this.Di(e)))!==null;return y("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ie("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this._i)try{this._i.setItem(this.Di(this.clientId),String(Date.now()))}catch(e){ie("Failed to set zombie client id.",e)}}Mi(){if(this._i)try{this._i.removeItem(this.Di(this.clientId))}catch{}}Di(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function gs(n){return Ie(n,"owner")}function Da(n){return Ie(n,"clientMetadata")}function rp(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var rf=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Fi=r,this.Bi=i}static Li(e,t){let r=R(),i=R();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var hc=class{constructor(){this.qi=!1}initialize(e,t){this.Ui=e,this.indexManager=t,this.qi=!0}getDocumentsMatchingQuery(e,t,r,i){return this.Ki(e,t).next(s=>s||this.Gi(e,t,i,r)).next(s=>s||this.Qi(e,t))}Ki(e,t){if(tv(t))return p.resolve(null);let r=Ue(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Ja(t,null,"F"),r=Ue(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=R(...s);return this.Ui.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(c=>{let u=this.ji(t,a);return this.zi(t,u,o,c.readTime)?this.Ki(e,Ja(t,null,"F")):this.Wi(e,u,t,c)}))})))}Gi(e,t,r,i){return tv(t)||i.isEqual(C.min())?this.Qi(e,t):this.Ui.getDocuments(e,r).next(s=>{let o=this.ji(t,s);return this.zi(t,o,r,i)?this.Qi(e,t):($h()<=P.DEBUG&&y("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),wd(t)),this.Wi(e,o,t,jv(i,-1)))})}ji(e,t){let r=new H(cw(e));return t.forEach((i,s)=>{Ys(e,s)&&(r=r.add(s))}),r}zi(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Qi(e,t){return $h()<=P.DEBUG&&y("QueryEngine","Using full collection scan to execute query:",wd(t)),this.Ui.getDocumentsMatchingQuery(e,t,He.min())}Wi(e,t,r,i){return this.Ui.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}};var sf=class{constructor(e,t,r,i){this.persistence=e,this.Hi=t,this.serializer=i,this.Ji=new K(D),this.Yi=new Ct(s=>ir(s),Hs),this.Xi=new Map,this.Zi=e.getRemoteDocumentCache(),this.Bs=e.getTargetCache(),this.qs=e.getBundleCache(),this.tr(r)}tr(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cc(this.Zi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Zi.setIndexManager(this.indexManager),this.Hi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ji))}};function jw(n,e,t,r){return new sf(n,e,t,r)}async function zw(n,e){let t=E(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.tr(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],c=R();for(let u of i){o.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}for(let u of s){a.push(u.batchId);for(let l of u.mutations)c=c.add(l.key)}return t.localDocuments.getDocuments(r,c).next(u=>({er:u,removedBatchIds:o,addedBatchIds:a}))})})}function hA(n,e){let t=E(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.Zi.newChangeBuffer({trackRemovals:!0});return function(o,a,c,u){let l=c.batch,h=l.keys(),d=p.resolve();return h.forEach(m=>{d=d.next(()=>u.getEntry(a,m)).next(w=>{let T=c.docVersions.get(m);A(T!==null),w.version.compareTo(T)<0&&(l.applyToRemoteDocument(w,c),w.isValidDocument()&&(w.setReadTime(c.commitVersion),u.addEntry(w)))})}),d.next(()=>o.mutationQueue.removeMutationBatch(a,l))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let a=R();for(let c=0;c<o.mutationResults.length;++c)o.mutationResults[c].transformResults.length>0&&(a=a.add(o.batch.mutations[c].key));return a}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function Gw(n){let e=E(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Bs.getLastRemoteSnapshotVersion(t))}function dA(n,e){let t=E(n),r=e.snapshotVersion,i=t.Ji;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=t.Zi.newChangeBuffer({trackRemovals:!0});i=t.Ji;let a=[];e.targetChanges.forEach((l,h)=>{let d=i.get(h);if(!d)return;a.push(t.Bs.removeMatchingKeys(s,l.removedDocuments,h).next(()=>t.Bs.addMatchingKeys(s,l.addedDocuments,h)));let m=d.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(_e.EMPTY_BYTE_STRING,C.min()).withLastLimboFreeSnapshotVersion(C.min()):l.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(l.resumeToken,r)),i=i.insert(h,m),function(w,T,S){return w.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(d,m,l)&&a.push(t.Bs.updateTargetData(s,m))});let c=Fe(),u=R();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push($w(s,o,e.documentUpdates).next(l=>{c=l.nr,u=l.sr})),!r.isEqual(C.min())){let l=t.Bs.getLastRemoteSnapshotVersion(s).next(h=>t.Bs.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return p.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,u)).next(()=>c)}).then(s=>(t.Ji=i,s))}function $w(n,e,t){let r=R(),i=R();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=Fe();return t.forEach((a,c)=>{let u=s.get(a);c.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),c.isNoDocument()&&c.version.isEqual(C.min())?(e.removeEntry(a,c.readTime),o=o.insert(a,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(a,c)):y("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",c.version)}),{nr:o,sr:i}})}function fA(n,e){let t=E(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ti(n,e){let t=E(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Bs.getTargetData(r,e).next(s=>s?(i=s,p.resolve(i)):t.Bs.allocateTargetId(r).next(o=>(i=new Zr(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Bs.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.Ji.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ji=t.Ji.insert(r.targetId,r),t.Yi.set(e,r.targetId)),r})}async function ni(n,e,t){let r=E(n),i=r.Ji.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!An(o))throw o;y("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ji=r.Ji.remove(e),r.Yi.delete(i.target)}function dc(n,e,t){let r=E(n),i=C.min(),s=R();return r.persistence.runTransaction("Execute query","readonly",o=>function(a,c,u){let l=E(a),h=l.Yi.get(u);return h!==void 0?p.resolve(l.Ji.get(h)):l.Bs.getTargetData(c,u)}(r,o,Ue(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Bs.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>r.Hi.getDocumentsMatchingQuery(o,e,t?i:C.min(),t?s:R())).next(a=>(Hw(r,aw(e),a),{documents:a,ir:s})))}function Kw(n,e){let t=E(n),r=E(t.Bs),i=t.Ji.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.le(s,e).next(o=>o?o.target:null))}function Ww(n,e){let t=E(n),r=t.Xi.get(e)||C.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Zi.getAllFromCollectionGroup(i,e,jv(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(Hw(t,e,i),i))}function Hw(n,e,t){let r=n.Xi.get(e)||C.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Xi.set(e,r)}async function pA(n,e,t,r){let i=E(n),s=R(),o=Fe();for(let u of t){let l=e.rr(u.metadata.name);u.document&&(s=s.add(l));let h=e.ur(u);h.setReadTime(e.cr(u.metadata.readTime)),o=o.insert(l,h)}let a=i.Zi.newChangeBuffer({trackRemovals:!0}),c=await ti(i,function(u){return Ue(ui(F.fromString(`__bundle__/docs/${u}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>$w(u,a,o).next(l=>(a.apply(u),l)).next(l=>i.Bs.removeMatchingKeysForTargetId(u,c.targetId).next(()=>i.Bs.addMatchingKeys(u,s,c.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,l.nr,l.sr)).next(()=>l.nr)))}async function mA(n,e,t=R()){let r=await ti(n,Ue(tp(e.bundledQuery))),i=E(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{let o=se(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.qs.saveNamedQuery(s,e);let a=r.withResumeToken(_e.EMPTY_BYTE_STRING,o);return i.Ji=i.Ji.insert(a.targetId,a),i.Bs.updateTargetData(s,a).next(()=>i.Bs.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Bs.addMatchingKeys(s,t,r.targetId)).next(()=>i.qs.saveNamedQuery(s,e))})}function Nv(n,e){return`firestore_clients_${n}_${e}`}function kv(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function zh(n,e){return`firestore_targets_${n}_${e}`}var fc=class n{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static ar(e,t,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new g(i.error.code,i.error.message))),o?new n(e,t,i.state,s):(ie("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}hr(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Es=class n{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static ar(e,t){let r=JSON.parse(t),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new g(r.error.code,r.error.message))),s?new n(e,r.state,i):(ie("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}hr(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},pc=class n{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static ar(e,t){let r=JSON.parse(t),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Zf();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=$v(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new n(e,s):(ie("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}},of=class n{constructor(e,t){this.clientId=e,this.onlineState=t}static ar(e){let t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new n(t.clientId,t.onlineState):(ie("SharedClientState",`Failed to parse online state: ${e}`),null)}},Vs=class{constructor(){this.activeTargetIds=Zf()}lr(e){this.activeTargetIds=this.activeTargetIds.add(e)}dr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}hr(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Ts=class{constructor(e,t,r,i,s){this.window=e,this.ii=t,this.persistenceKey=r,this.wr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.mr.bind(this),this.gr=new K(D),this.started=!1,this.yr=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.pr=Nv(this.persistenceKey,this.wr),this.Ir=function(a){return`firestore_sequence_number_${a}`}(this.persistenceKey),this.gr=this.gr.insert(this.wr,new Vs),this.Tr=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Er=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ar=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vr=function(a){return`firestore_online_state_${a}`}(this.persistenceKey),this.Rr=function(a){return`firestore_bundle_loaded_v2_${a}`}(this.persistenceKey),this.window.addEventListener("storage",this._r)}static D(e){return!(!e||!e.localStorage)}async start(){let e=await this.syncEngine.$i();for(let r of e){if(r===this.wr)continue;let i=this.getItem(Nv(this.persistenceKey,r));if(i){let s=pc.ar(r,i);s&&(this.gr=this.gr.insert(s.clientId,s))}}this.Pr();let t=this.storage.getItem(this.vr);if(t){let r=this.br(t);r&&this.Vr(r)}for(let r of this.yr)this.mr(r);this.yr=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ir,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Sr(this.gr)}isActiveQueryTarget(e){let t=!1;return this.gr.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Dr(e,"pending")}updateMutationState(e,t,r){this.Dr(e,t,r),this.Cr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(zh(this.persistenceKey,e));if(r){let i=Es.ar(e,r);i&&(t=i.state)}}return this.Nr.lr(e),this.Pr(),t}removeLocalQueryTarget(e){this.Nr.dr(e),this.Pr()}isLocalQueryTarget(e){return this.Nr.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(zh(this.persistenceKey,e))}updateQueryState(e,t,r){this.kr(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Cr(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Mr(e)}notifyBundleLoaded(e){this.$r(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.pr),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return y("SharedClientState","READ",e,t),t}setItem(e,t){y("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){y("SharedClientState","REMOVE",e),this.storage.removeItem(e)}mr(e){let t=e;if(t.storageArea===this.storage){if(y("SharedClientState","EVENT",t.key,t.newValue),t.key===this.pr)return void ie("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ii.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Tr.test(t.key)){if(t.newValue==null){let r=this.Or(t.key);return this.Fr(r,null)}{let r=this.Br(t.key,t.newValue);if(r)return this.Fr(r.clientId,r)}}else if(this.Er.test(t.key)){if(t.newValue!==null){let r=this.Lr(t.key,t.newValue);if(r)return this.qr(r)}}else if(this.Ar.test(t.key)){if(t.newValue!==null){let r=this.Ur(t.key,t.newValue);if(r)return this.Kr(r)}}else if(t.key===this.vr){if(t.newValue!==null){let r=this.br(t.newValue);if(r)return this.Vr(r)}}else if(t.key===this.Ir){let r=function(i){let s=Re.ct;if(i!=null)try{let o=JSON.parse(i);A(typeof o=="number"),s=o}catch(o){ie("SharedClientState","Failed to read sequence number from WebStorage",o)}return s}(t.newValue);r!==Re.ct&&this.sequenceNumberHandler(r)}else if(t.key===this.Rr){let r=this.Gr(t.newValue);await Promise.all(r.map(i=>this.syncEngine.Qr(i)))}}}else this.yr.push(t)})}}get Nr(){return this.gr.get(this.wr)}Pr(){this.setItem(this.pr,this.Nr.hr())}Dr(e,t,r){let i=new fc(this.currentUser,e,t,r),s=kv(this.persistenceKey,this.currentUser,e);this.setItem(s,i.hr())}Cr(e){let t=kv(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Mr(e){let t={clientId:this.wr,onlineState:e};this.storage.setItem(this.vr,JSON.stringify(t))}kr(e,t,r){let i=zh(this.persistenceKey,e),s=new Es(e,t,r);this.setItem(i,s.hr())}$r(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Rr,t)}Or(e){let t=this.Tr.exec(e);return t?t[1]:null}Br(e,t){let r=this.Or(e);return pc.ar(r,t)}Lr(e,t){let r=this.Er.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return fc.ar(new he(s),i,t)}Ur(e,t){let r=this.Ar.exec(e),i=Number(r[1]);return Es.ar(i,t)}br(e){return of.ar(e)}Gr(e){return JSON.parse(e)}async qr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.jr(e.batchId,e.state,e.error);y("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Kr(e){return this.syncEngine.zr(e.targetId,e.state,e.error)}Fr(e,t){let r=t?this.gr.insert(e,t):this.gr.remove(e),i=this.Sr(this.gr),s=this.Sr(r),o=[],a=[];return s.forEach(c=>{i.has(c)||o.push(c)}),i.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.Wr(o,a).then(()=>{this.gr=r})}Vr(e){this.gr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Sr(e){let t=Zf();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}},mc=class{constructor(){this.Hr=new Vs,this.Jr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Hr.lr(e),this.Jr[e]||"not-current"}updateQueryState(e,t,r){this.Jr[e]=t}removeLocalQueryTarget(e){this.Hr.dr(e)}isLocalQueryTarget(e){return this.Hr.activeTargetIds.has(e)}clearQueryState(e){delete this.Jr[e]}getAllActiveQueryTargets(){return this.Hr.activeTargetIds}isActiveQueryTarget(e){return this.Hr.activeTargetIds.has(e)}start(){return this.Hr=new Vs,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var af=class{Yr(e){}shutdown(){}};var gc=class{constructor(){this.Xr=()=>this.Zr(),this.eo=()=>this.no(),this.so=[],this.io()}Yr(e){this.so.push(e)}shutdown(){window.removeEventListener("online",this.Xr),window.removeEventListener("offline",this.eo)}io(){window.addEventListener("online",this.Xr),window.addEventListener("offline",this.eo)}Zr(){y("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.so)e(0)}no(){y("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.so)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ra=null;function Gh(){return Ra===null?Ra=268435456+Math.round(2147483648*Math.random()):Ra++,"0x"+Ra.toString(16)}var gA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var cf=class{constructor(e){this.ro=e.ro,this.oo=e.oo}uo(e){this.co=e}ao(e){this.ho=e}onMessage(e){this.lo=e}close(){this.oo()}send(e){this.ro(e)}fo(){this.co()}wo(e){this.ho(e)}_o(e){this.lo(e)}};var ke="WebChannelConnection",uf=class extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http";this.mo=t+"://"+e.host,this.yo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get po(){return!1}Io(e,t,r,i,s){let o=Gh(),a=this.To(e,t);y("RestConnection",`Sending RPC '${e}' ${o}:`,a,r);let c={};return this.Eo(c,i,s),this.Ao(e,a,c,r).then(u=>(y("RestConnection",`Received RPC '${e}' ${o}: `,u),u),u=>{throw We("RestConnection",`RPC '${e}' ${o} failed with error: `,u,"url: ",a,"request:",r),u})}vo(e,t,r,i,s,o){return this.Io(e,t,r,i,s)}Eo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+ci,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}To(e,t){let r=gA[e];return`${this.mo}/v1/${t}:${r}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Ao(e,t,r,i){let s=Gh();return new Promise((o,a)=>{let c=new Vy;c.setWithCredentials(!0),c.listenOnce(My.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Sa.NO_ERROR:let l=c.getResponseJson();y(ke,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case Sa.TIMEOUT:y(ke,`RPC '${e}' ${s} timed out`),a(new g(f.DEADLINE_EXCEEDED,"Request time out"));break;case Sa.HTTP_ERROR:let h=c.getStatus();if(y(ke,`RPC '${e}' ${s} failed with status:`,h,"response text:",c.getResponseText()),h>0){let d=c.getResponseJson();Array.isArray(d)&&(d=d[0]);let m=d?.error;if(m&&m.status&&m.message){let w=function(T){let S=T.toLowerCase().replace(/_/g,"-");return Object.values(f).indexOf(S)>=0?S:f.UNKNOWN}(m.status);a(new g(w,m.message))}else a(new g(f.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new g(f.UNAVAILABLE,"Connection failed."));break;default:b()}}finally{y(ke,`RPC '${e}' ${s} completed.`)}});let u=JSON.stringify(i);y(ke,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",u,r,15)})}Ro(e,t,r){let i=Gh(),s=[this.mo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Oy(),a=Ly(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.xmlHttpFactory=new Uy({})),this.Eo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let l=s.join("");y(ke,`Creating RPC '${e}' stream ${i}: ${l}`,c);let h=o.createWebChannel(l,c),d=!1,m=!1,w=new cf({ro:S=>{m?y(ke,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(d||(y(ke,`Opening RPC '${e}' stream ${i} transport.`),h.open(),d=!0),y(ke,`RPC '${e}' stream ${i} sending:`,S),h.send(S))},oo:()=>h.close()}),T=(S,U,j)=>{S.listen(U,x=>{try{j(x)}catch(Y){setTimeout(()=>{throw Y},0)}})};return T(h,hs.EventType.OPEN,()=>{m||y(ke,`RPC '${e}' stream ${i} transport opened.`)}),T(h,hs.EventType.CLOSE,()=>{m||(m=!0,y(ke,`RPC '${e}' stream ${i} transport closed`),w.wo())}),T(h,hs.EventType.ERROR,S=>{m||(m=!0,We(ke,`RPC '${e}' stream ${i} transport errored:`,S),w.wo(new g(f.UNAVAILABLE,"The operation could not be completed")))}),T(h,hs.EventType.MESSAGE,S=>{var U;if(!m){let j=S.data[0];A(!!j);let x=j,Y=x.error||((U=x[0])===null||U===void 0?void 0:U.error);if(Y){y(ke,`RPC '${e}' stream ${i} received error:`,Y);let Z=Y.status,q=function(Dt){let wr=ue[Dt];if(wr!==void 0)return Ew(wr)}(Z),Ee=Y.message;q===void 0&&(q=f.INTERNAL,Ee="Unknown error status: "+Z+" with message "+Y.message),m=!0,w.wo(new g(q,Ee)),h.close()}else y(ke,`RPC '${e}' stream ${i} received:`,j),w._o(j)}}),T(a,Fy.STAT_EVENT,S=>{S.stat===Bh.PROXY?y(ke,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===Bh.NOPROXY&&y(ke,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.fo()},0),w}};function Qw(){return typeof window<"u"?window:null}function Ma(){return typeof document<"u"?document:null}function Js(n){return new Ad(n,!0)}var Bs=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ii=e,this.timerId=t,this.Po=r,this.bo=i,this.Vo=s,this.So=0,this.Do=null,this.Co=Date.now(),this.reset()}reset(){this.So=0}xo(){this.So=this.Vo}No(e){this.cancel();let t=Math.floor(this.So+this.ko()),r=Math.max(0,Date.now()-this.Co),i=Math.max(0,t-r);i>0&&y("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.So} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.Do=this.ii.enqueueAfterDelay(this.timerId,i,()=>(this.Co=Date.now(),e())),this.So*=this.bo,this.So<this.Po&&(this.So=this.Po),this.So>this.Vo&&(this.So=this.Vo)}Mo(){this.Do!==null&&(this.Do.skipDelay(),this.Do=null)}cancel(){this.Do!==null&&(this.Do.cancel(),this.Do=null)}ko(){return(Math.random()-.5)*this.So}};var yc=class{constructor(e,t,r,i,s,o,a,c){this.ii=e,this.$o=r,this.Oo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Fo=0,this.Bo=null,this.Lo=null,this.stream=null,this.qo=new Bs(e,t)}Uo(){return this.state===1||this.state===5||this.Ko()}Ko(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Go()}async stop(){this.Uo()&&await this.close(0)}Qo(){this.state=0,this.qo.reset()}jo(){this.Ko()&&this.Bo===null&&(this.Bo=this.ii.enqueueAfterDelay(this.$o,6e4,()=>this.zo()))}Wo(e){this.Ho(),this.stream.send(e)}async zo(){if(this.Ko())return this.close(0)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}Jo(){this.Lo&&(this.Lo.cancel(),this.Lo=null)}async close(e,t){this.Ho(),this.Jo(),this.qo.cancel(),this.Fo++,e!==4?this.qo.reset():t&&t.code===f.RESOURCE_EXHAUSTED?(ie(t.toString()),ie("Using maximum backoff delay to prevent overloading the backend."),this.qo.xo()):t&&t.code===f.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Yo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.ao(t)}Yo(){}auth(){this.state=1;let e=this.Xo(this.Fo),t=this.Fo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Fo===t&&this.Zo(r,i)},r=>{e(()=>{let i=new g(f.UNKNOWN,"Fetching auth token failed: "+r.message);return this.tu(i)})})}Zo(e,t){let r=this.Xo(this.Fo);this.stream=this.eu(e,t),this.stream.uo(()=>{r(()=>(this.state=2,this.Lo=this.ii.enqueueAfterDelay(this.Oo,1e4,()=>(this.Ko()&&(this.state=3),Promise.resolve())),this.listener.uo()))}),this.stream.ao(i=>{r(()=>this.tu(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Go(){this.state=5,this.qo.No(async()=>{this.state=0,this.start()})}tu(e){return y("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Xo(e){return t=>{this.ii.enqueueAndForget(()=>this.Fo===e?t():(y("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},lf=class extends yc{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}eu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.qo.reset();let t=eA(this.serializer,e),r=function(i){if(!("targetChange"in i))return C.min();let s=i.targetChange;return s.targetIds&&s.targetIds.length?C.min():s.readTime?se(s.readTime):C.min()}(e);return this.listener.nu(t,r)}su(e){let t={};t.database=Ls(this.serializer),t.addTarget=function(i,s){let o,a=s.target;if(o=Qa(a)?{documents:kw(i,a)}:{query:Dw(i,a)},o.targetId=s.targetId,s.resumeToken.approximateByteSize()>0){o.resumeToken=bw(i,s.resumeToken);let c=Cd(i,s.expectedCount);c!==null&&(o.expectedCount=c)}else if(s.snapshotVersion.compareTo(C.min())>0){o.readTime=Xr(i,s.snapshotVersion.toTimestamp());let c=Cd(i,s.expectedCount);c!==null&&(o.expectedCount=c)}return o}(this.serializer,e);let r=nA(this.serializer,e);r&&(t.labels=r),this.Wo(t)}iu(e){let t={};t.database=Ls(this.serializer),t.removeTarget=e,this.Wo(t)}},hf=class extends yc{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s,this.ru=!1}get ou(){return this.ru}start(){this.ru=!1,this.lastStreamToken=void 0,super.start()}Yo(){this.ru&&this.uu([])}eu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){if(A(!!e.streamToken),this.lastStreamToken=e.streamToken,this.ru){this.qo.reset();let t=tA(e.writeResults,e.commitTime),r=se(e.commitTime);return this.listener.cu(r,t)}return A(!e.writeResults||e.writeResults.length===0),this.ru=!0,this.listener.au()}hu(){let e={};e.database=Ls(this.serializer),this.Wo(e)}uu(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>Ms(this.serializer,r))};this.Wo(t)}};var df=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.lu=!1}fu(){if(this.lu)throw new g(f.FAILED_PRECONDITION,"The client has already been terminated.")}Io(e,t,r){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Io(e,t,r,i,s)).catch(i=>{throw i.name==="FirebaseError"?(i.code===f.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new g(f.UNKNOWN,i.toString())})}vo(e,t,r,i){return this.fu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.vo(e,t,r,s,o,i)).catch(s=>{throw s.name==="FirebaseError"?(s.code===f.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new g(f.UNKNOWN,s.toString())})}terminate(){this.lu=!0}};var ff=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.wu=0,this._u=null,this.mu=!0}gu(){this.wu===0&&(this.yu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.pu("Backend didn't respond within 10 seconds."),this.yu("Offline"),Promise.resolve())))}Iu(e){this.state==="Online"?this.yu("Unknown"):(this.wu++,this.wu>=1&&(this.Tu(),this.pu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.yu("Offline")))}set(e){this.Tu(),this.wu=0,e==="Online"&&(this.mu=!1),this.yu(e)}yu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}pu(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.mu?(ie(t),this.mu=!1):y("OnlineStateTracker",t)}Tu(){this._u!==null&&(this._u.cancel(),this._u=null)}};var pf=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Eu=[],this.Au=new Map,this.vu=new Set,this.Ru=[],this.Pu=s,this.Pu.Yr(o=>{r.enqueueAndForget(async()=>{Cn(this)&&(y("RemoteStore","Restarting streams for network reachability change."),await async function(a){let c=E(a);c.vu.add(4),await li(c),c.bu.set("Unknown"),c.vu.delete(4),await Xs(c)}(this))})}),this.bu=new ff(r,i)}};async function Xs(n){if(Cn(n))for(let e of n.Ru)await e(!0)}async function li(n){for(let e of n.Ru)await e(!1)}function Fc(n,e){let t=E(n);t.Au.has(e.targetId)||(t.Au.set(e.targetId,e),op(t)?sp(t):di(t).Ko()&&ip(t,e))}function qs(n,e){let t=E(n),r=di(t);t.Au.delete(e),r.Ko()&&Yw(t,e),t.Au.size===0&&(r.Ko()?r.jo():Cn(t)&&t.bu.set("Unknown"))}function ip(n,e){if(n.Vu.qt(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(C.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}di(n).su(e)}function Yw(n,e){n.Vu.qt(e),di(n).iu(e)}function sp(n){n.Vu=new Sd({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),le:e=>n.Au.get(e)||null,ue:()=>n.datastore.serializer.databaseId}),di(n).start(),n.bu.gu()}function op(n){return Cn(n)&&!di(n).Uo()&&n.Au.size>0}function Cn(n){return E(n).vu.size===0}function Jw(n){n.Vu=void 0}async function yA(n){n.Au.forEach((e,t)=>{ip(n,e)})}async function vA(n,e){Jw(n),op(n)?(n.bu.Iu(e),sp(n)):n.bu.set("Unknown")}async function wA(n,e,t){if(n.bu.set("Online"),e instanceof Za&&e.state===2&&e.cause)try{await async function(r,i){let s=i.cause;for(let o of i.targetIds)r.Au.has(o)&&(await r.remoteSyncer.rejectListen(o,s),r.Au.delete(o),r.Vu.removeTarget(o))}(n,e)}catch(r){y("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await vc(n,r)}else if(e instanceof Kr?n.Vu.Ht(e):e instanceof Xa?n.Vu.ne(e):n.Vu.Xt(e),!t.isEqual(C.min()))try{let r=await Gw(n.localStore);t.compareTo(r)>=0&&await function(i,s){let o=i.Vu.ce(s);return o.targetChanges.forEach((a,c)=>{if(a.resumeToken.approximateByteSize()>0){let u=i.Au.get(c);u&&i.Au.set(c,u.withResumeToken(a.resumeToken,s))}}),o.targetMismatches.forEach((a,c)=>{let u=i.Au.get(a);if(!u)return;i.Au.set(a,u.withResumeToken(_e.EMPTY_BYTE_STRING,u.snapshotVersion)),Yw(i,a);let l=new Zr(u.target,a,c,u.sequenceNumber);ip(i,l)}),i.remoteSyncer.applyRemoteEvent(o)}(n,t)}catch(r){y("RemoteStore","Failed to raise snapshot:",r),await vc(n,r)}}async function vc(n,e,t){if(!An(e))throw e;n.vu.add(1),await li(n),n.bu.set("Offline"),t||(t=()=>Gw(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{y("RemoteStore","Retrying IndexedDB access"),await t(),n.vu.delete(1),await Xs(n)})}function Xw(n,e){return e().catch(t=>vc(n,t,e))}async function hi(n){let e=E(n),t=bn(e),r=e.Eu.length>0?e.Eu[e.Eu.length-1].batchId:-1;for(;_A(e);)try{let i=await fA(e.localStore,r);if(i===null){e.Eu.length===0&&t.jo();break}r=i.batchId,IA(e,i)}catch(i){await vc(e,i)}Zw(e)&&e_(e)}function _A(n){return Cn(n)&&n.Eu.length<10}function IA(n,e){n.Eu.push(e);let t=bn(n);t.Ko()&&t.ou&&t.uu(e.mutations)}function Zw(n){return Cn(n)&&!bn(n).Uo()&&n.Eu.length>0}function e_(n){bn(n).start()}async function EA(n){bn(n).hu()}async function TA(n){let e=bn(n);for(let t of n.Eu)e.uu(t.mutations)}async function bA(n,e,t){let r=n.Eu.shift(),i=Id.from(r,e,t);await Xw(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await hi(n)}async function SA(n,e){e&&bn(n).ou&&await async function(t,r){if(i=r.code,Iw(i)&&i!==f.ABORTED){let s=t.Eu.shift();bn(t).Qo(),await Xw(t,()=>t.remoteSyncer.rejectFailedWrite(s.batchId,r)),await hi(t)}var i}(n,e),Zw(n)&&e_(n)}async function Dv(n,e){let t=E(n);t.asyncQueue.verifyOperationInProgress(),y("RemoteStore","RemoteStore received new credentials");let r=Cn(t);t.vu.add(3),await li(t),r&&t.bu.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.vu.delete(3),await Xs(t)}async function mf(n,e){let t=E(n);e?(t.vu.delete(2),await Xs(t)):e||(t.vu.add(2),await li(t),t.bu.set("Unknown"))}function di(n){return n.Su||(n.Su=function(e,t,r){let i=E(e);return i.fu(),new lf(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{uo:yA.bind(null,n),ao:vA.bind(null,n),nu:wA.bind(null,n)}),n.Ru.push(async e=>{e?(n.Su.Qo(),op(n)?sp(n):n.bu.set("Unknown")):(await n.Su.stop(),Jw(n))})),n.Su}function bn(n){return n.Du||(n.Du=function(e,t,r){let i=E(e);return i.fu(),new hf(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(n.datastore,n.asyncQueue,{uo:EA.bind(null,n),ao:SA.bind(null,n),au:TA.bind(null,n),cu:bA.bind(null,n)}),n.Ru.push(async e=>{e?(n.Du.Qo(),await hi(n)):(await n.Du.stop(),n.Eu.length>0&&(y("RemoteStore",`Stopping write stream with ${n.Eu.length} pending writes`),n.Eu=[]))})),n.Du}var gf=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new de,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,a=new n(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new g(f.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function fi(n,e){if(ie("AsyncQueue",`${e}: ${n}`),An(n))return new g(f.UNAVAILABLE,`${e}: ${n}`);throw n}var wc=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||_.comparator(t.key,r.key):(t,r)=>_.comparator(t.key,r.key),this.keyedMap=ys(),this.sortedSet=new K(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var _c=class{constructor(){this.Cu=new K(_.comparator)}track(e){let t=e.doc.key,r=this.Cu.get(t);r?e.type!==0&&r.type===3?this.Cu=this.Cu.insert(t,e):e.type===3&&r.type!==1?this.Cu=this.Cu.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Cu=this.Cu.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Cu=this.Cu.remove(t):e.type===1&&r.type===2?this.Cu=this.Cu.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Cu=this.Cu.insert(t,{type:2,doc:e.doc}):b():this.Cu=this.Cu.insert(t,e)}xu(){let e=[];return this.Cu.inorderTraversal((t,r)=>{e.push(r)}),e}},ri=class n{constructor(e,t,r,i,s,o,a,c,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new n(e,t,wc.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qs(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var yf=class{constructor(){this.Nu=void 0,this.listeners=[]}},vf=class{constructor(){this.queries=new Ct(e=>ow(e),Qs),this.onlineState="Unknown",this.ku=new Set}};async function ap(n,e){let t=E(n),r=e.query,i=!1,s=t.queries.get(r);if(s||(i=!0,s=new yf),i)try{s.Nu=await t.onListen(r)}catch(o){let a=fi(o,`Initialization of query '${wd(e.query)}' failed`);return void e.onError(a)}t.queries.set(r,s),s.listeners.push(e),e.Mu(t.onlineState),s.Nu&&e.$u(s.Nu)&&up(t)}async function cp(n,e){let t=E(n),r=e.query,i=!1,s=t.queries.get(r);if(s){let o=s.listeners.indexOf(e);o>=0&&(s.listeners.splice(o,1),i=s.listeners.length===0)}if(i)return t.queries.delete(r),t.onUnlisten(r)}function AA(n,e){let t=E(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let a of o.listeners)a.$u(i)&&(r=!0);o.Nu=i}}r&&up(t)}function CA(n,e,t){let r=E(n),i=r.queries.get(e);if(i)for(let s of i.listeners)s.onError(t);r.queries.delete(e)}function up(n){n.ku.forEach(e=>{e.next()})}var js=class{constructor(e,t,r){this.query=e,this.Ou=t,this.Fu=!1,this.Bu=null,this.onlineState="Unknown",this.options=r||{}}$u(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new ri(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Fu?this.Lu(e)&&(this.Ou.next(e),t=!0):this.qu(e,this.onlineState)&&(this.Uu(e),t=!0),this.Bu=e,t}onError(e){this.Ou.error(e)}Mu(e){this.onlineState=e;let t=!1;return this.Bu&&!this.Fu&&this.qu(this.Bu,e)&&(this.Uu(this.Bu),t=!0),t}qu(e,t){if(!e.fromCache)return!0;let r=t!=="Offline";return(!this.options.Ku||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Lu(e){if(e.docChanges.length>0)return!0;let t=this.Bu&&this.Bu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Uu(e){e=ri.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Fu=!0,this.Ou.next(e)}};var wf=class{constructor(e,t){this.Gu=e,this.byteLength=t}Qu(){return"metadata"in this.Gu}};var Ic=class{constructor(e){this.serializer=e}rr(e){return Tt(this.serializer,e)}ur(e){return e.metadata.exists?Nw(this.serializer,e.document,!1):fe.newNoDocument(this.rr(e.metadata.name),this.cr(e.metadata.readTime))}cr(e){return se(e)}},_f=class{constructor(e,t,r){this.ju=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=t_(e)}zu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Gu.namedQuery)this.queries.push(e.Gu.namedQuery);else if(e.Gu.documentMetadata){this.documents.push({metadata:e.Gu.documentMetadata}),e.Gu.documentMetadata.exists||++t;let r=F.fromString(e.Gu.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Gu.document&&(this.documents[this.documents.length-1].document=e.Gu.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}Wu(e){let t=new Map,r=new Ic(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.rr(i.metadata.name);for(let o of i.metadata.queries){let a=(t.get(o)||R()).add(s);t.set(o,a)}}return t}async complete(){let e=await pA(this.localStore,new Ic(this.serializer),this.documents,this.ju.id),t=this.Wu(this.documents);for(let r of this.queries)await mA(this.localStore,r,t.get(r.name));return this.progress.taskState="Success",{progress:this.progress,Hu:this.collectionGroups,Ju:e}}};function t_(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var Ec=class{constructor(e){this.key=e}},Tc=class{constructor(e){this.key=e}},bc=class{constructor(e,t){this.query=e,this.Yu=t,this.Xu=null,this.hasCachedResults=!1,this.current=!1,this.Zu=R(),this.mutatedKeys=R(),this.tc=cw(e),this.ec=new wc(this.tc)}get nc(){return this.Yu}sc(e,t){let r=t?t.ic:new _c,i=t?t.ec:this.ec,s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,u=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,h)=>{let d=i.get(l),m=Ys(this.query,h)?h:null,w=!!d&&this.mutatedKeys.has(d.key),T=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations),S=!1;d&&m?d.data.isEqual(m.data)?w!==T&&(r.track({type:3,doc:m}),S=!0):this.rc(d,m)||(r.track({type:2,doc:m}),S=!0,(c&&this.tc(m,c)>0||u&&this.tc(m,u)<0)&&(a=!0)):!d&&m?(r.track({type:0,doc:m}),S=!0):d&&!m&&(r.track({type:1,doc:d}),S=!0,(c||u)&&(a=!0)),S&&(m?(o=o.add(m),s=T?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{ec:o,ic:r,zi:a,mutatedKeys:s}}rc(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){let i=this.ec;this.ec=e.ec,this.mutatedKeys=e.mutatedKeys;let s=e.ic.xu();s.sort((u,l)=>function(h,d){let m=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return b()}};return m(h)-m(d)}(u.type,l.type)||this.tc(u.doc,l.doc)),this.oc(r);let o=t?this.uc():[],a=this.Zu.size===0&&this.current?1:0,c=a!==this.Xu;return this.Xu=a,s.length!==0||c?{snapshot:new ri(this.query,e.ec,i,s,e.mutatedKeys,a===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),cc:o}:{cc:o}}Mu(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ec:this.ec,ic:new _c,mutatedKeys:this.mutatedKeys,zi:!1},!1)):{cc:[]}}ac(e){return!this.Yu.has(e)&&!!this.ec.has(e)&&!this.ec.get(e).hasLocalMutations}oc(e){e&&(e.addedDocuments.forEach(t=>this.Yu=this.Yu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Yu=this.Yu.delete(t)),this.current=e.current)}uc(){if(!this.current)return[];let e=this.Zu;this.Zu=R(),this.ec.forEach(r=>{this.ac(r.key)&&(this.Zu=this.Zu.add(r.key))});let t=[];return e.forEach(r=>{this.Zu.has(r)||t.push(new Tc(r))}),this.Zu.forEach(r=>{e.has(r)||t.push(new Ec(r))}),t}hc(e){this.Yu=e.ir,this.Zu=R();let t=this.sc(e.documents);return this.applyChanges(t,!0)}lc(){return ri.fromInitialDocuments(this.query,this.ec,this.mutatedKeys,this.Xu===0,this.hasCachedResults)}},If=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Ef=class{constructor(e){this.key=e,this.fc=!1}},Tf=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.dc={},this.wc=new Ct(a=>ow(a),Qs),this._c=new Map,this.mc=new Set,this.gc=new K(_.comparator),this.yc=new Map,this.Ic=new Us,this.Tc={},this.Ec=new Map,this.Ac=ei.Mn(),this.onlineState="Unknown",this.vc=void 0}get isPrimaryClient(){return this.vc===!0}};async function NA(n,e){let t=pp(n),r,i,s=t.wc.get(e);if(s)r=s.targetId,t.sharedClientState.addLocalQueryTarget(r),i=s.view.lc();else{let o=await ti(t.localStore,Ue(e)),a=t.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=await lp(t,e,r,a==="current",o.resumeToken),t.isPrimaryClient&&Fc(t.remoteStore,o)}return i}async function lp(n,e,t,r,i){n.Rc=(h,d,m)=>async function(w,T,S,U){let j=T.view.sc(S);j.zi&&(j=await dc(w.localStore,T.query,!1).then(({documents:Z})=>T.view.sc(Z,j)));let x=U&&U.targetChanges.get(T.targetId),Y=T.view.applyChanges(j,w.isPrimaryClient,x);return bf(w,T.targetId,Y.cc),Y.snapshot}(n,h,d,m);let s=await dc(n.localStore,e,!0),o=new bc(e,s.ir),a=o.sc(s.documents),c=Ps.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),u=o.applyChanges(a,n.isPrimaryClient,c);bf(n,t,u.cc);let l=new If(e,t,o);return n.wc.set(e,l),n._c.has(t)?n._c.get(t).push(e):n._c.set(t,[e]),u.snapshot}async function kA(n,e){let t=E(n),r=t.wc.get(e),i=t._c.get(r.targetId);if(i.length>1)return t._c.set(r.targetId,i.filter(s=>!Qs(s,e))),void t.wc.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||await ni(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),qs(t.remoteStore,r.targetId),ii(t,r.targetId)}).catch(Sn)):(ii(t,r.targetId),await ni(t.localStore,r.targetId,!0))}async function DA(n,e,t){let r=mp(n);try{let i=await function(s,o){let a=E(s),c=X.now(),u=o.reduce((d,m)=>d.add(m.key),R()),l,h;return a.persistence.runTransaction("Locally write mutations","readwrite",d=>{let m=Fe(),w=R();return a.Zi.getEntries(d,u).next(T=>{m=T,m.forEach((S,U)=>{U.isValidDocument()||(w=w.add(S))})}).next(()=>a.localDocuments.getOverlayedDocuments(d,m)).next(T=>{l=T;let S=[];for(let U of o){let j=WS(U,l.get(U.key).overlayedDocument);j!=null&&S.push(new st(U.key,j,Zv(j.value.mapValue),re.exists(!0)))}return a.mutationQueue.addMutationBatch(d,c,S,o)}).next(T=>{h=T;let S=T.applyToLocalDocumentSet(l,w);return a.documentOverlayCache.saveOverlays(d,T.batchId,S)})}).then(()=>({batchId:h.batchId,changes:lw(l)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(s,o,a){let c=s.Tc[s.currentUser.toKey()];c||(c=new K(D)),c=c.insert(o,a),s.Tc[s.currentUser.toKey()]=c}(r,i.batchId,t),await zt(r,i.changes),await hi(r.remoteStore)}catch(i){let s=fi(i,"Failed to persist write");t.reject(s)}}async function n_(n,e){let t=E(n);try{let r=await dA(t.localStore,e);e.targetChanges.forEach((i,s)=>{let o=t.yc.get(s);o&&(A(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.fc=!0:i.modifiedDocuments.size>0?A(o.fc):i.removedDocuments.size>0&&(A(o.fc),o.fc=!1))}),await zt(t,r,e)}catch(r){await Sn(r)}}function Rv(n,e,t){let r=E(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.wc.forEach((s,o)=>{let a=o.view.Mu(e);a.snapshot&&i.push(a.snapshot)}),function(s,o){let a=E(s);a.onlineState=o;let c=!1;a.queries.forEach((u,l)=>{for(let h of l.listeners)h.Mu(o)&&(c=!0)}),c&&up(a)}(r.eventManager,e),i.length&&r.dc.nu(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function RA(n,e,t){let r=E(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.yc.get(e),s=i&&i.key;if(s){let o=new K(_.comparator);o=o.insert(s,fe.newNoDocument(s,C.min()));let a=R().add(s),c=new xs(C.min(),new Map,new K(D),o,a);await n_(r,c),r.gc=r.gc.remove(s),r.yc.delete(e),fp(r)}else await ni(r.localStore,e,!1).then(()=>ii(r,e,t)).catch(Sn)}async function xA(n,e){let t=E(n),r=e.batch.batchId;try{let i=await hA(t.localStore,e);dp(t,r,null),hp(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await zt(t,i)}catch(i){await Sn(i)}}async function PA(n,e,t){let r=E(n);try{let i=await function(s,o){let a=E(s);return a.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return a.mutationQueue.lookupMutationBatch(c,o).next(l=>(A(l!==null),u=l.keys(),a.mutationQueue.removeMutationBatch(c,l))).next(()=>a.mutationQueue.performConsistencyCheck(c)).next(()=>a.documentOverlayCache.removeOverlaysForBatchId(c,u,o)).next(()=>a.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>a.localDocuments.getDocuments(c,u))})}(r.localStore,e);dp(r,e,t),hp(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await zt(r,i)}catch(i){await Sn(i)}}async function OA(n,e){let t=E(n);Cn(t.remoteStore)||y("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=await function(s){let o=E(s);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",a=>o.mutationQueue.getHighestUnacknowledgedBatchId(a))}(t.localStore);if(r===-1)return void e.resolve();let i=t.Ec.get(r)||[];i.push(e),t.Ec.set(r,i)}catch(r){let i=fi(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}function hp(n,e){(n.Ec.get(e)||[]).forEach(t=>{t.resolve()}),n.Ec.delete(e)}function dp(n,e,t){let r=E(n),i=r.Tc[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Tc[r.currentUser.toKey()]=i}}function ii(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n._c.get(e))n.wc.delete(r),t&&n.dc.Pc(r,t);n._c.delete(e),n.isPrimaryClient&&n.Ic.Is(e).forEach(r=>{n.Ic.containsKey(r)||r_(n,r)})}function r_(n,e){n.mc.delete(e.path.canonicalString());let t=n.gc.get(e);t!==null&&(qs(n.remoteStore,t),n.gc=n.gc.remove(e),n.yc.delete(t),fp(n))}function bf(n,e,t){for(let r of t)r instanceof Ec?(n.Ic.addReference(r.key,e),LA(n,r)):r instanceof Tc?(y("SyncEngine","Document no longer in limbo: "+r.key),n.Ic.removeReference(r.key,e),n.Ic.containsKey(r.key)||r_(n,r.key)):b()}function LA(n,e){let t=e.key,r=t.path.canonicalString();n.gc.get(t)||n.mc.has(r)||(y("SyncEngine","New document in limbo: "+t),n.mc.add(r),fp(n))}function fp(n){for(;n.mc.size>0&&n.gc.size<n.maxConcurrentLimboResolutions;){let e=n.mc.values().next().value;n.mc.delete(e);let t=new _(F.fromString(e)),r=n.Ac.next();n.yc.set(r,new Ef(t)),n.gc=n.gc.insert(t,r),Fc(n.remoteStore,new Zr(Ue(ui(t.path)),r,"TargetPurposeLimboResolution",Re.ct))}}async function zt(n,e,t){let r=E(n),i=[],s=[],o=[];r.wc.isEmpty()||(r.wc.forEach((a,c)=>{o.push(r.Rc(c,e,t).then(u=>{if((u||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(c.targetId,u?.fromCache?"not-current":"current"),u){i.push(u);let l=rf.Li(c.targetId,u);s.push(l)}}))}),await Promise.all(o),r.dc.nu(i),await async function(a,c){let u=E(a);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",l=>p.forEach(c,h=>p.forEach(h.Fi,d=>u.persistence.referenceDelegate.addReference(l,h.targetId,d)).next(()=>p.forEach(h.Bi,d=>u.persistence.referenceDelegate.removeReference(l,h.targetId,d)))))}catch(l){if(!An(l))throw l;y("LocalStore","Failed to update sequence numbers: "+l)}for(let l of c){let h=l.targetId;if(!l.fromCache){let d=u.Ji.get(h),m=d.snapshotVersion,w=d.withLastLimboFreeSnapshotVersion(m);u.Ji=u.Ji.insert(h,w)}}}(r.localStore,s))}async function MA(n,e){let t=E(n);if(!t.currentUser.isEqual(e)){y("SyncEngine","User change. New user:",e.toKey());let r=await zw(t.localStore,e);t.currentUser=e,function(i,s){i.Ec.forEach(o=>{o.forEach(a=>{a.reject(new g(f.CANCELLED,s))})}),i.Ec.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await zt(t,r.er)}}function FA(n,e){let t=E(n),r=t.yc.get(e);if(r&&r.fc)return R().add(r.key);{let i=R(),s=t._c.get(e);if(!s)return i;for(let o of s){let a=t.wc.get(o);i=i.unionWith(a.view.nc)}return i}}async function UA(n,e){let t=E(n),r=await dc(t.localStore,e.query,!0),i=e.view.hc(r);return t.isPrimaryClient&&bf(t,e.targetId,i.cc),i}async function VA(n,e){let t=E(n);return Ww(t.localStore,e).then(r=>zt(t,r))}async function BA(n,e,t,r){let i=E(n),s=await function(o,a){let c=E(o),u=E(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",l=>u.Sn(l,a).next(h=>h?c.localDocuments.getDocuments(l,h):p.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?await hi(i.remoteStore):t==="acknowledged"||t==="rejected"?(dp(i,e,r||null),hp(i,e),function(o,a){E(E(o).mutationQueue).Cn(a)}(i.localStore,e)):b(),await zt(i,s)):y("SyncEngine","Cannot apply mutation batch with id: "+e)}async function qA(n,e){let t=E(n);if(pp(t),mp(t),e===!0&&t.vc!==!0){let r=t.sharedClientState.getAllActiveQueryTargets(),i=await xv(t,r.toArray());t.vc=!0,await mf(t.remoteStore,!0);for(let s of i)Fc(t.remoteStore,s)}else if(e===!1&&t.vc!==!1){let r=[],i=Promise.resolve();t._c.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(ii(t,o),ni(t.localStore,o,!0))),qs(t.remoteStore,o)}),await i,await xv(t,r),function(s){let o=E(s);o.yc.forEach((a,c)=>{qs(o.remoteStore,c)}),o.Ic.Ts(),o.yc=new Map,o.gc=new K(_.comparator)}(t),t.vc=!1,await mf(t.remoteStore,!1)}}async function xv(n,e,t){let r=E(n),i=[],s=[];for(let o of e){let a,c=r._c.get(o);if(c&&c.length!==0){a=await ti(r.localStore,Ue(c[0]));for(let u of c){let l=r.wc.get(u),h=await UA(r,l);h.snapshot&&s.push(h.snapshot)}}else{let u=await Kw(r.localStore,o);a=await ti(r.localStore,u),await lp(r,i_(u),o,!1,a.resumeToken)}i.push(a)}return r.dc.nu(s),i}function i_(n){return sw(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function jA(n){let e=E(n);return E(E(e.localStore).persistence).$i()}async function zA(n,e,t,r){let i=E(n);if(i.vc)return void y("SyncEngine","Ignoring unexpected query state notification.");let s=i._c.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{let o=await Ww(i.localStore,aw(s[0])),a=xs.createSynthesizedRemoteEventForCurrentChange(e,t==="current",_e.EMPTY_BYTE_STRING);await zt(i,o,a);break}case"rejected":await ni(i.localStore,e,!0),ii(i,e,r);break;default:b()}}async function GA(n,e,t){let r=pp(n);if(r.vc){for(let i of e){if(r._c.has(i)){y("SyncEngine","Adding an already active target "+i);continue}let s=await Kw(r.localStore,i),o=await ti(r.localStore,s);await lp(r,i_(s),o.targetId,!1,o.resumeToken),Fc(r.remoteStore,o)}for(let i of t)r._c.has(i)&&await ni(r.localStore,i,!1).then(()=>{qs(r.remoteStore,i),ii(r,i)}).catch(Sn)}}function pp(n){let e=E(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=n_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=FA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=RA.bind(null,e),e.dc.nu=AA.bind(null,e.eventManager),e.dc.Pc=CA.bind(null,e.eventManager),e}function mp(n){let e=E(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=xA.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=PA.bind(null,e),e}function $A(n,e,t){let r=E(n);(async function(i,s,o){try{let a=await s.getMetadata();if(await function(h,d){let m=E(h),w=se(d.createTime);return m.persistence.runTransaction("hasNewerBundle","readonly",T=>m.qs.getBundleMetadata(T,d.id)).then(T=>!!T&&T.createTime.compareTo(w)>=0)}(i.localStore,a))return await s.close(),o._completeWith(function(h){return{taskState:"Success",documentsLoaded:h.totalDocuments,bytesLoaded:h.totalBytes,totalDocuments:h.totalDocuments,totalBytes:h.totalBytes}}(a)),Promise.resolve(new Set);o._updateProgress(t_(a));let c=new _f(a,i.localStore,s.serializer),u=await s.bc();for(;u;){let h=await c.zu(u);h&&o._updateProgress(h),u=await s.bc()}let l=await c.complete();return await zt(i,l.Ju,void 0),await function(h,d){let m=E(h);return m.persistence.runTransaction("Save bundle","readwrite",w=>m.qs.saveBundleMetadata(w,d))}(i.localStore,a),o._completeWith(l.progress),Promise.resolve(l.Hu)}catch(a){return We("SyncEngine",`Loading bundle failed with ${a}`),o._failWith(a),Promise.resolve(new Set)}})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var zs=class{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Js(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return jw(this.persistence,new hc,e.initialUser,this.serializer)}createPersistence(e){return new uc(lc.zs,this.serializer)}createSharedClientState(e){return new mc}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}};var Sc=class extends zs{constructor(e,t,r){super(),this.Vc=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Vc.initialize(this,e),await mp(this.Vc.syncEngine),await hi(this.Vc.remoteStore),await this.persistence.Ii(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return jw(this.persistence,new hc,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new jd(r,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let r=new id(t,this.persistence);return new rd(e.asyncQueue,r)}createPersistence(e){let t=rp(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Ke.withCacheSize(this.cacheSizeBytes):Ke.DEFAULT;return new nf(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Qw(),Ma(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new mc}},Sf=class extends Sc{constructor(e,t){super(e,t,!1),this.Vc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);let t=this.Vc.syncEngine;this.sharedClientState instanceof Ts&&(this.sharedClientState.syncEngine={jr:BA.bind(null,t),zr:zA.bind(null,t),Wr:GA.bind(null,t),$i:jA.bind(null,t),Qr:VA.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ii(async r=>{await qA(this.Vc.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){let t=Qw();if(!Ts.D(t))throw new g(f.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=rp(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ts(t,e.asyncQueue,r,e.clientId,e.initialUser)}},Gs=class{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Rv(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=MA.bind(null,this.syncEngine),await mf(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new vf}createDatastore(e){let t=Js(e.databaseInfo.databaseId),r=(i=e.databaseInfo,new uf(i));var i;return function(s,o,a,c){return new df(s,o,a,c)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,s=a=>Rv(this.syncEngine,a,0),o=gc.D()?new gc:new af,new pf(t,r,i,s,o);var t,r,i,s,o}createSyncEngine(e,t){return function(r,i,s,o,a,c,u){let l=new Tf(r,i,s,o,a,c);return u&&(l.vc=!0),l}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){let t=E(e);y("RemoteStore","RemoteStore shutting down."),t.vu.add(5),await li(t),t.Pu.shutdown(),t.bu.set("Unknown")}(this.remoteStore)}};function Pv(n,e=10240){let t=0;return{async read(){if(t<n.byteLength){let r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}var si=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Sc(this.observer.next,e)}error(e){this.observer.error?this.Sc(this.observer.error,e):ie("Uncaught Error in snapshot listener:",e.toString())}Dc(){this.muted=!0}Sc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}};var Af=class{constructor(e,t){this.Cc=e,this.serializer=t,this.metadata=new de,this.buffer=new Uint8Array,this.xc=new TextDecoder("utf-8"),this.Nc().then(r=>{r&&r.Qu()?this.metadata.resolve(r.Gu.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.Gu)}`))},r=>this.metadata.reject(r))}close(){return this.Cc.cancel()}async getMetadata(){return this.metadata.promise}async bc(){return await this.getMetadata(),this.Nc()}async Nc(){let e=await this.kc();if(e===null)return null;let t=this.xc.decode(e),r=Number(t);isNaN(r)&&this.Mc(`length string (${t}) is not valid number`);let i=await this.$c(r);return new wf(JSON.parse(i),e.length+r)}Oc(){return this.buffer.findIndex(e=>e===123)}async kc(){for(;this.Oc()<0&&!await this.Fc(););if(this.buffer.length===0)return null;let e=this.Oc();e<0&&this.Mc("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $c(e){for(;this.buffer.length<e;)await this.Fc()&&this.Mc("Reached the end of bundle when more is expected.");let t=this.xc.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Mc(e){throw this.Cc.cancel(),new Error(`Invalid bundle format: ${e}`)}async Fc(){let e=await this.Cc.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}};var Cf=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new g(f.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");let t=await async function(r,i){let s=E(r),o=Ls(s.serializer)+"/documents",a={documents:i.map(h=>Os(s.serializer,h))},c=await s.vo("BatchGetDocuments",o,a,i.length),u=new Map;c.forEach(h=>{let d=ZS(s.serializer,h);u.set(d.key.toString(),d)});let l=[];return i.forEach(h=>{let d=u.get(h.toString());A(!!d),l.push(d)}),l}(this.datastore,e);return t.forEach(r=>this.recordVersion(r)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Tn(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,r)=>{let i=_.fromPath(r);this.mutations.push(new ks(i,this.precondition(i)))}),await async function(t,r){let i=E(t),s=Ls(i.serializer)+"/documents",o={writes:r.map(a=>Ms(i.serializer,a))};await i.Io("Commit",s,o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw b();t=C.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new g(f.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(C.min())?re.exists(!1):re.updateTime(t):re.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(C.min()))throw new g(f.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return re.updateTime(t)}return re.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var Nf=class{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this.Bc=r.maxAttempts,this.qo=new Bs(this.asyncQueue,"transaction_retry")}run(){this.Bc-=1,this.Lc()}Lc(){this.qo.No(async()=>{let e=new Cf(this.datastore),t=this.qc(e);t&&t.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Uc(i)}))}).catch(r=>{this.Uc(r)})})}qc(e){try{let t=this.updateFunction(e);return!Ws(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Uc(e){this.Bc>0&&this.Kc(e)?(this.Bc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Lc(),Promise.resolve()))):this.deferred.reject(e)}Kc(e){if(e.name==="FirebaseError"){let t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Iw(t)}return!1}};var kf=class{constructor(e,t,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=he.UNAUTHENTICATED,this.clientId=Va.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async s=>{y("FirestoreClient","Received user=",s.uid),await this.authCredentialListener(s),this.user=s}),this.appCheckCredentials.start(r,s=>(y("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new g(f.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new de;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=fi(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function Fa(n,e){n.asyncQueue.verifyOperationInProgress(),y("FirestoreClient","Initializing OfflineComponentProvider");let t=await n.getConfiguration();await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await zw(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function Df(n,e){n.asyncQueue.verifyOperationInProgress();let t=await gp(n);y("FirestoreClient","Initializing OnlineComponentProvider");let r=await n.getConfiguration();await e.initialize(t,r),n.setCredentialChangeListener(i=>Dv(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,s)=>Dv(e.remoteStore,s)),n._onlineComponents=e}function s_(n){return n.name==="FirebaseError"?n.code===f.FAILED_PRECONDITION||n.code===f.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function gp(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){y("FirestoreClient","Using user provided OfflineComponentProvider");try{await Fa(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!s_(t))throw t;We("Error using user provided cache. Falling back to memory cache: "+t),await Fa(n,new zs)}}else y("FirestoreClient","Using default OfflineComponentProvider"),await Fa(n,new zs);return n._offlineComponents}async function Uc(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(y("FirestoreClient","Using user provided OnlineComponentProvider"),await Df(n,n._uninitializedComponentsProvider._online)):(y("FirestoreClient","Using default OnlineComponentProvider"),await Df(n,new Gs))),n._onlineComponents}function o_(n){return gp(n).then(e=>e.persistence)}function yp(n){return gp(n).then(e=>e.localStore)}function a_(n){return Uc(n).then(e=>e.remoteStore)}function vp(n){return Uc(n).then(e=>e.syncEngine)}function KA(n){return Uc(n).then(e=>e.datastore)}async function oi(n){let e=await Uc(n),t=e.eventManager;return t.onListen=NA.bind(null,e.syncEngine),t.onUnlisten=kA.bind(null,e.syncEngine),t}function WA(n){return n.asyncQueue.enqueue(async()=>{let e=await o_(n),t=await a_(n);return e.setNetworkEnabled(!0),function(r){let i=E(r);return i.vu.delete(0),Xs(i)}(t)})}function HA(n){return n.asyncQueue.enqueue(async()=>{let e=await o_(n),t=await a_(n);return e.setNetworkEnabled(!1),async function(r){let i=E(r);i.vu.add(0),await li(i),i.bu.set("Offline")}(t)})}function QA(n,e){let t=new de;return n.asyncQueue.enqueueAndForget(async()=>async function(r,i,s){try{let o=await function(a,c){let u=E(a);return u.persistence.runTransaction("read document","readonly",l=>u.localDocuments.getDocument(l,c))}(r,i);o.isFoundDocument()?s.resolve(o):o.isNoDocument()?s.resolve(null):s.reject(new g(f.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(o){let a=fi(o,`Failed to get document '${i} from cache`);s.reject(a)}}(await yp(n),e,t)),t.promise}function c_(n,e,t={}){let r=new de;return n.asyncQueue.enqueueAndForget(async()=>function(i,s,o,a,c){let u=new si({next:h=>{s.enqueueAndForget(()=>cp(i,l));let d=h.docs.has(o);!d&&h.fromCache?c.reject(new g(f.UNAVAILABLE,"Failed to get document because the client is offline.")):d&&h.fromCache&&a&&a.source==="server"?c.reject(new g(f.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),l=new js(ui(o.path),u,{includeMetadataChanges:!0,Ku:!0});return ap(i,l)}(await oi(n),n.asyncQueue,e,t,r)),r.promise}function YA(n,e){let t=new de;return n.asyncQueue.enqueueAndForget(async()=>async function(r,i,s){try{let o=await dc(r,i,!0),a=new bc(i,o.ir),c=a.sc(o.documents),u=a.applyChanges(c,!1);s.resolve(u.snapshot)}catch(o){let a=fi(o,`Failed to execute query '${i} against cache`);s.reject(a)}}(await yp(n),e,t)),t.promise}function u_(n,e,t={}){let r=new de;return n.asyncQueue.enqueueAndForget(async()=>function(i,s,o,a,c){let u=new si({next:h=>{s.enqueueAndForget(()=>cp(i,l)),h.fromCache&&a.source==="server"?c.reject(new g(f.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),l=new js(o,u,{includeMetadataChanges:!0,Ku:!0});return ap(i,l)}(await oi(n),n.asyncQueue,e,t,r)),r.promise}function JA(n,e){let t=new si(e);return n.asyncQueue.enqueueAndForget(async()=>function(r,i){E(r).ku.add(i),i.next()}(await oi(n),t)),()=>{t.Dc(),n.asyncQueue.enqueueAndForget(async()=>function(r,i){E(r).ku.delete(i)}(await oi(n),t))}}function XA(n,e,t,r){let i=function(s,o){let a;return a=typeof s=="string"?Tw().encode(s):s,function(c,u){return new Af(c,u)}(function(c,u){if(c instanceof Uint8Array)return Pv(c,u);if(c instanceof ArrayBuffer)return Pv(new Uint8Array(c),u);if(c instanceof ReadableStream)return c.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(a),o)}(t,Js(e));n.asyncQueue.enqueueAndForget(async()=>{$A(await vp(n),i,r)})}function ZA(n,e){return n.asyncQueue.enqueue(async()=>function(t,r){let i=E(t);return i.persistence.runTransaction("Get named query","readonly",s=>i.qs.getNamedQuery(s,r))}(await yp(n),e))}function l_(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Ov=new Map;function wp(n,e,t){if(!t)throw new g(f.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function _p(n,e,t,r){if(e===!0&&r===!0)throw new g(f.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Lv(n){if(!_.isDocumentKey(n))throw new g(f.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Mv(n){if(_.isDocumentKey(n))throw new g(f.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Vc(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(t){return t.constructor?t.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":b()}function M(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new g(f.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Vc(n);throw new g(f.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function h_(n,e){if(e<=0)throw new g(f.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}var Ac=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new g(f.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new g(f.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}_p("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=l_((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new g(f.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new g(f.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new g(f.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(t=this.experimentalLongPollingOptions,r=e.experimentalLongPollingOptions,t.timeoutSeconds===r.timeoutSeconds)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams;var t,r}},cr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ac({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new g(f.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new g(f.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ac(e),e.credentials!==void 0&&(this._authCredentials=function(t){if(!t)return new Kh;switch(t.type){case"firstParty":return new Yh(t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new g(f.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){let t=Ov.get(e);t&&(y("ComponentProvider","Removing Datastore"),Ov.delete(e),t.terminate())}(this),Promise.resolve()}};function d_(n,e,t,r={}){var i;let s=(n=M(n,cr))._getSettings(),o=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&We("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,c;if(typeof r.mockUserToken=="string")a=r.mockUserToken,c=he.MOCK_USER;else{a=Gp(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new g(f.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new he(u)}n._authCredentials=new Wh(new Ua(a,c))}}var G=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new bt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Se=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},bt=class n extends Se{constructor(e,t,r){super(e,t,ui(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new G(this.firestore,null,new _(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Ip(n,e,...t){if(n=N(n),wp("collection","path",e),n instanceof cr){let r=F.fromString(e,...t);return Mv(r),new bt(n,null,r)}{if(!(n instanceof G||n instanceof bt))throw new g(f.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(F.fromString(e,...t));return Mv(r),new bt(n.firestore,null,r)}}function f_(n,e){if(n=M(n,cr),wp("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new g(f.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Se(n,null,function(t){return new it(F.emptyPath(),t)}(e))}function Zs(n,e,...t){if(n=N(n),arguments.length===1&&(e=Va.A()),wp("doc","path",e),n instanceof cr){let r=F.fromString(e,...t);return Lv(r),new G(n,null,new _(r))}{if(!(n instanceof G||n instanceof bt))throw new g(f.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(F.fromString(e,...t));return Lv(r),new G(n.firestore,n instanceof bt?n.converter:null,new _(r))}}function Ep(n,e){return n=N(n),e=N(e),(n instanceof G||n instanceof bt)&&(e instanceof G||e instanceof bt)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Tp(n,e){return n=N(n),e=N(e),n instanceof Se&&e instanceof Se&&n.firestore===e.firestore&&Qs(n._query,e._query)&&n.converter===e.converter}var Rf=class{constructor(){this.Gc=Promise.resolve(),this.Qc=[],this.jc=!1,this.zc=[],this.Wc=null,this.Hc=!1,this.Jc=!1,this.Yc=[],this.qo=new Bs(this,"async_queue_retry"),this.Xc=()=>{let t=Ma();t&&y("AsyncQueue","Visibility state changed to "+t.visibilityState),this.qo.Mo()};let e=Ma();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Xc)}get isShuttingDown(){return this.jc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Zc(),this.ta(e)}enterRestrictedMode(e){if(!this.jc){this.jc=!0,this.Jc=e||!1;let t=Ma();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Xc)}}enqueue(e){if(this.Zc(),this.jc)return new Promise(()=>{});let t=new de;return this.ta(()=>this.jc&&this.Jc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Qc.push(e),this.ea()))}async ea(){if(this.Qc.length!==0){try{await this.Qc[0](),this.Qc.shift(),this.qo.reset()}catch(e){if(!An(e))throw e;y("AsyncQueue","Operation failed with retryable error: "+e)}this.Qc.length>0&&this.qo.No(()=>this.ea())}}ta(e){let t=this.Gc.then(()=>(this.Hc=!0,e().catch(r=>{this.Wc=r,this.Hc=!1;let i=function(s){let o=s.message||"";return s.stack&&(o=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),o}(r);throw ie("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.Hc=!1,r))));return this.Gc=t,t}enqueueAfterDelay(e,t,r){this.Zc(),this.Yc.indexOf(e)>-1&&(t=0);let i=gf.createAndSchedule(this,e,t,r,s=>this.na(s));return this.zc.push(i),i}Zc(){this.Wc&&b()}verifyOperationInProgress(){}async sa(){let e;do e=this.Gc,await e;while(e!==this.Gc)}ia(e){for(let t of this.zc)if(t.timerId===e)return!0;return!1}ra(e){return this.sa().then(()=>{this.zc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.zc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.sa()})}oa(e){this.Yc.push(e)}na(e){let t=this.zc.indexOf(e);this.zc.splice(t,1)}};function xf(n){return function(e,t){if(typeof e!="object"||e===null)return!1;let r=e;for(let i of t)if(i in r&&typeof r[i]=="function")return!0;return!1}(n,["next","error","complete"])}var Pf=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new de,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var p_=-1,Q=class extends cr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Rf,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||m_(this),this._firestoreClient.terminate()}};function pe(n){return n._firestoreClient||m_(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function m_(n){var e,t,r;let i=n._freezeSettings(),s=function(o,a,c,u){return new sd(o,a,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,l_(u.experimentalLongPollingOptions),u.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._firestoreClient=new kf(n._authCredentials,n._appCheckCredentials,n._queue,s),!((t=i.cache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.cache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.cache.kind,_offline:i.cache._offlineComponentProvider,_online:i.cache._onlineComponentProvider})}function g_(n,e){S_(n=M(n,Q));let t=pe(n);if(t._uninitializedComponentsProvider)throw new g(f.FAILED_PRECONDITION,"SDK cache is already specified.");We("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=n._freezeSettings(),i=new Gs;return v_(t,i,new Sc(i,r.cacheSizeBytes,e?.forceOwnership))}function y_(n){S_(n=M(n,Q));let e=pe(n);if(e._uninitializedComponentsProvider)throw new g(f.FAILED_PRECONDITION,"SDK cache is already specified.");We("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings(),r=new Gs;return v_(e,r,new Sf(r,t.cacheSizeBytes))}function v_(n,e,t){let r=new de;return n.asyncQueue.enqueue(async()=>{try{await Fa(n,t),await Df(n,e),r.resolve()}catch(i){let s=i;if(!s_(s))throw s;We("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}}).then(()=>r.promise)}function w_(n){if(n._initialized&&!n._terminated)throw new g(f.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new de;return n._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(t){if(!mn.D())return Promise.resolve();let r=t+"main";await mn.delete(r)}(rp(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}}),e.promise}function __(n){return function(e){let t=new de;return e.asyncQueue.enqueueAndForget(async()=>OA(await vp(e),t)),t.promise}(pe(n=M(n,Q)))}function I_(n){return WA(pe(n=M(n,Q)))}function E_(n){return HA(pe(n=M(n,Q)))}function T_(n,e){let t=pe(n=M(n,Q)),r=new Pf;return XA(t,n._databaseId,e,r),r}function b_(n,e){return ZA(pe(n=M(n,Q)),e).then(t=>t?new Se(n,null,t.query):null)}function S_(n){if(n._initialized||n._terminated)throw new g(f.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Nt=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(_e.fromBase64String(e))}catch(t){throw new g(f.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(_e.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var ot=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new g(f.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new we(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var qt=class{constructor(e){this._methodName=e}};var ur=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new g(f.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new g(f.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return D(this._lat,e._lat)||D(this._long,e._long)}};var eC=/^__.*__$/,Of=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new st(e,this.data,this.fieldMask,t,this.fieldTransforms):new En(e,this.data,t,this.fieldTransforms)}},Cc=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new st(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function A_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw b()}}var Nc=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.ua(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get ca(){return this.settings.ca}aa(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ha(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.aa({path:r,la:!1});return i.fa(e),i}da(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.aa({path:r,la:!1});return i.ua(),i}wa(e){return this.aa({path:void 0,la:!0})}_a(e){return kc(e,this.settings.methodName,this.settings.ma||!1,this.path,this.settings.ga)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}ua(){if(this.path)for(let e=0;e<this.path.length;e++)this.fa(this.path.get(e))}fa(e){if(e.length===0)throw this._a("Document fields must not be empty");if(A_(this.ca)&&eC.test(e))throw this._a('Document fields cannot begin and end with "__"')}},Lf=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Js(e)}ya(e,t,r,i=!1){return new Nc({ca:e,methodName:t,ga:r,path:we.emptyPath(),la:!1,ma:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function fr(n){let e=n._freezeSettings(),t=Js(n._databaseId);return new Lf(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Bc(n,e,t,r,i,s={}){let o=n.ya(s.merge||s.mergeFields?2:0,e,t,i);Ap("Data must be an object, but it was:",o,r);let a=k_(r,o),c,u;if(s.merge)c=new je(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let h of s.mergeFields){let d=Bf(e,h,t);if(!o.contains(d))throw new g(f.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);R_(l,d)||l.push(d)}c=new je(l),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new Of(new De(a),c,u)}var $s=class n extends qt{_toFieldTransform(e){if(e.ca!==2)throw e.ca===1?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function C_(n,e,t){return new Nc({ca:3,ga:e.settings.ga,methodName:n._methodName,la:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var Mf=class n extends qt{_toFieldTransform(e){return new sr(e.path,new _n)}isEqual(e){return e instanceof n}},Ff=class extends qt{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){let t=C_(this,e,!0),r=this.pa.map(s=>pr(s,t)),i=new Vt(r);return new sr(e.path,i)}isEqual(e){return this===e}},Uf=class extends qt{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){let t=C_(this,e,!0),r=this.pa.map(s=>pr(s,t)),i=new Bt(r);return new sr(e.path,i)}isEqual(e){return this===e}},Vf=class extends qt{constructor(e,t){super(e),this.Ia=t}_toFieldTransform(e){let t=new In(e.serializer,pw(e.serializer,this.Ia));return new sr(e.path,t)}isEqual(e){return this===e}};function bp(n,e,t,r){let i=n.ya(1,e,t);Ap("Data must be an object, but it was:",i,r);let s=[],o=De.empty();dr(r,(c,u)=>{let l=Cp(e,c,t);u=N(u);let h=i.da(l);if(u instanceof $s)s.push(l);else{let d=pr(u,h);d!=null&&(s.push(l),o.set(l,d))}});let a=new je(s);return new Cc(o,a,i.fieldTransforms)}function Sp(n,e,t,r,i,s){let o=n.ya(1,e,t),a=[Bf(e,r,t)],c=[i];if(s.length%2!=0)throw new g(f.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(Bf(e,s[d])),c.push(s[d+1]);let u=[],l=De.empty();for(let d=a.length-1;d>=0;--d)if(!R_(u,a[d])){let m=a[d],w=c[d];w=N(w);let T=o.da(m);if(w instanceof $s)u.push(m);else{let S=pr(w,T);S!=null&&(u.push(m),l.set(m,S))}}let h=new je(u);return new Cc(l,h,o.fieldTransforms)}function N_(n,e,t,r=!1){return pr(t,n.ya(r?4:3,e))}function pr(n,e){if(D_(n=N(n)))return Ap("Unsupported field value:",e,n),k_(n,e);if(n instanceof qt)return function(t,r){if(!A_(r.ca))throw r._a(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r._a(`${t._methodName}() is not currently supported inside arrays`);let i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.la&&e.ca!==4)throw e._a("Nested arrays are not supported");return function(t,r){let i=[],s=0;for(let o of t){let a=pr(o,r.wa(s));a==null&&(a={nullValue:"NULL_VALUE"}),i.push(a),s++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if((t=N(t))===null)return{nullValue:"NULL_VALUE"};if(typeof t=="number")return pw(r.serializer,t);if(typeof t=="boolean")return{booleanValue:t};if(typeof t=="string")return{stringValue:t};if(t instanceof Date){let i=X.fromDate(t);return{timestampValue:Xr(r.serializer,i)}}if(t instanceof X){let i=new X(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Xr(r.serializer,i)}}if(t instanceof ur)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Nt)return{bytesValue:bw(r.serializer,t._byteString)};if(t instanceof G){let i=r.databaseId,s=t.firestore._databaseId;if(!s.isEqual(i))throw r._a(`Document reference is for database ${s.projectId}/${s.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:ep(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r._a(`Unsupported field value: ${Vc(t)}`)}(n,e)}function k_(n,e){let t={};return Yv(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):dr(n,(r,i)=>{let s=pr(i,e.ha(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function D_(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof X||n instanceof ur||n instanceof Nt||n instanceof G||n instanceof qt)}function Ap(n,e,t){if(!D_(t)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(t)){let r=Vc(t);throw r==="an object"?e._a(n+" a custom object"):e._a(n+" "+r)}}function Bf(n,e,t){if((e=N(e))instanceof ot)return e._internalPath;if(typeof e=="string")return Cp(n,e);throw kc("Field path arguments must be of type string or ",n,!1,void 0,t)}var tC=new RegExp("[~\\*/\\[\\]]");function Cp(n,e,t){if(e.search(tC)>=0)throw kc(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new ot(...e.split("."))._internalPath}catch{throw kc(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function kc(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new g(f.INVALID_ARGUMENT,a+n+c)}function R_(n,e){return n.some(t=>t.isEqual(e))}var lr=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new G(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new qf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(qc("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},qf=class extends lr{data(){return super.data()}};function qc(n,e){return typeof e=="string"?Cp(n,e):e instanceof ot?e._internalPath:e._delegate._internalPath}function x_(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new g(f.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ks=class{},hr=class extends Ks{};function Gt(n,e,...t){let r=[];e instanceof Ks&&r.push(e),r=r.concat(t),function(i){let s=i.filter(a=>a instanceof jf).length,o=i.filter(a=>a instanceof Dc).length;if(s>1||s>0&&o>0)throw new g(f.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var Dc=class n extends hr{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return j_(e._query,t),new Se(e.firestore,e.converter,vd(e._query,t))}_parse(e){let t=fr(e.firestore);return function(i,s,o,a,c,u,l){let h;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new g(f.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){Uv(l,u);let d=[];for(let m of l)d.push(Fv(a,i,m));h={arrayValue:{values:d}}}else h=Fv(a,i,l)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||Uv(l,u),h=N_(o,s,l,u==="in"||u==="not-in");return O.create(c,u,h)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};function P_(n,e,t){let r=e,i=qc("where",n);return Dc._create(i,r,t)}var jf=class n extends Ks{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:B.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(r,i){let s=r,o=i.getFlattenedFilters();for(let a of o)j_(s,a),s=vd(s,a)}(e._query,t),new Se(e.firestore,e.converter,vd(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var zf=class n extends hr{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(r,i,s){if(r.startAt!==null)throw new g(f.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new g(f.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");let o=new dn(i,s);return function(a,c){if(Jf(a)===null){let u=Mc(a);u!==null&&z_(a,u,c.field)}}(r,o),o}(e._query,this._field,this._direction);return new Se(e.firestore,e.converter,function(r,i){let s=r.explicitOrderBy.concat([i]);return new it(r.path,r.collectionGroup,s,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}};function O_(n,e="asc"){let t=e,r=qc("orderBy",n);return zf._create(r,t)}var Rc=class n extends hr{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new Se(e.firestore,e.converter,Ja(e._query,this._limit,this._limitType))}};function L_(n){return h_("limit",n),Rc._create("limit",n,"F")}function M_(n){return h_("limitToLast",n),Rc._create("limitToLast",n,"L")}var xc=class n extends hr{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=q_(e,this.type,this._docOrFields,this._inclusive);return new Se(e.firestore,e.converter,function(r,i){return new it(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)}(e._query,t))}};function F_(...n){return xc._create("startAt",n,!0)}function U_(...n){return xc._create("startAfter",n,!1)}var Pc=class n extends hr{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=q_(e,this.type,this._docOrFields,this._inclusive);return new Se(e.firestore,e.converter,function(r,i){return new it(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)}(e._query,t))}};function V_(...n){return Pc._create("endBefore",n,!1)}function B_(...n){return Pc._create("endAt",n,!0)}function q_(n,e,t,r){if(t[0]=N(t[0]),t[0]instanceof lr)return function(i,s,o,a,c){if(!a)throw new g(f.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);let u=[];for(let l of tr(i))if(l.field.isKeyField())u.push(rr(s,a.key));else{let h=a.data.field(l.field);if(Lc(h))throw new g(f.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+l.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let d=l.field.canonicalString();throw new g(f.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${d}' (used as the orderBy) does not exist.`)}u.push(h)}return new At(u,c)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{let i=fr(n.firestore);return function(s,o,a,c,u,l){let h=s.explicitOrderBy;if(u.length>h.length)throw new g(f.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let d=[];for(let m=0;m<u.length;m++){let w=u[m];if(h[m].field.isKeyField()){if(typeof w!="string")throw new g(f.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof w}`);if(!Xf(s)&&w.indexOf("/")!==-1)throw new g(f.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${w}' contains a slash.`);let T=s.path.child(F.fromString(w));if(!_.isDocumentKey(T))throw new g(f.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${T}' is not because it contains an odd number of segments.`);let S=new _(T);d.push(rr(o,S))}else{let T=N_(a,c,w);d.push(T)}}return new At(d,l)}(n._query,n.firestore._databaseId,i,e,t,r)}}function Fv(n,e,t){if(typeof(t=N(t))=="string"){if(t==="")throw new g(f.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Xf(e)&&t.indexOf("/")!==-1)throw new g(f.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(F.fromString(t));if(!_.isDocumentKey(r))throw new g(f.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return rr(n,new _(r))}if(t instanceof G)return rr(n,t._key);throw new g(f.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Vc(t)}.`)}function Uv(n,e){if(!Array.isArray(n)||n.length===0)throw new g(f.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function j_(n,e){if(e.isInequality()){let r=Mc(n),i=e.field;if(r!==null&&!r.isEqual(i))throw new g(f.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${r.toString()}' and '${i.toString()}'`);let s=Jf(n);s!==null&&z_(n,i,s)}let t=function(r,i){for(let s of r)for(let o of s.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new g(f.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new g(f.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}function z_(n,e,t){if(!t.isEqual(e))throw new g(f.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}var ai=class{convertValue(e,t="none"){switch(nr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ne(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(yn(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw b()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return dr(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertGeoPoint(e){return new ur(ne(e.latitude),ne(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Qf(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(As(e));default:return null}}convertTimestamp(e){let t=gn(e);return new X(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=F.fromString(e);A(Ow(r));let i=new vn(r.get(1),r.get(3)),s=new _(r.popFirst(5));return i.isEqual(t)||ie(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function jc(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Gf=class extends ai{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nt(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new G(this.firestore,null,t)}};var Ut=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Qe=class extends lr{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new fn(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(qc("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},fn=class extends Qe{data(e={}){return super.data(e)}},at=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ut(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new fn(this._firestore,this._userDataWriter,r.key,r,new Ut(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new g(f.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let s=0;return r._snapshot.docChanges.map(o=>{let a=new fn(r._firestore,r._userDataWriter,o.doc.key,o.doc,new Ut(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter);return o.doc,{type:"added",doc:a,oldIndex:-1,newIndex:s++}})}{let s=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{let a=new fn(r._firestore,r._userDataWriter,o.doc.key,o.doc,new Ut(r._snapshot.mutatedKeys.has(o.doc.key),r._snapshot.fromCache),r.query.converter),c=-1,u=-1;return o.type!==0&&(c=s.indexOf(o.doc.key),s=s.delete(o.doc.key)),o.type!==1&&(s=s.add(o.doc),u=s.indexOf(o.doc.key)),{type:nC(o.type),doc:a,oldIndex:c,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function nC(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return b()}}function Np(n,e){return n instanceof Qe&&e instanceof Qe?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(n._document===null?e._document===null:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof at&&e instanceof at&&n._firestore===e._firestore&&Tp(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function G_(n){n=M(n,G);let e=M(n.firestore,Q);return c_(pe(e),n._key).then(t=>xp(e,n,t))}var jt=class extends ai{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nt(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new G(this.firestore,null,t)}};function $_(n){n=M(n,G);let e=M(n.firestore,Q),t=pe(e),r=new jt(e);return QA(t,n._key).then(i=>new Qe(e,r,n._key,i,new Ut(i!==null&&i.hasLocalMutations,!0),n.converter))}function K_(n){n=M(n,G);let e=M(n.firestore,Q);return c_(pe(e),n._key,{source:"server"}).then(t=>xp(e,n,t))}function W_(n){n=M(n,Se);let e=M(n.firestore,Q),t=pe(e),r=new jt(e);return x_(n._query),u_(t,n._query).then(i=>new at(e,r,n,i))}function H_(n){n=M(n,Se);let e=M(n.firestore,Q),t=pe(e),r=new jt(e);return YA(t,n._query).then(i=>new at(e,r,n,i))}function Q_(n){n=M(n,Se);let e=M(n.firestore,Q),t=pe(e),r=new jt(e);return u_(t,n._query,{source:"server"}).then(i=>new at(e,r,n,i))}function kp(n,e,t){n=M(n,G);let r=M(n.firestore,Q),i=jc(n.converter,e,t);return pi(r,[Bc(fr(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,re.none())])}function Dp(n,e,t,...r){n=M(n,G);let i=M(n.firestore,Q),s=fr(i),o;return o=typeof(e=N(e))=="string"||e instanceof ot?Sp(s,"updateDoc",n._key,e,t,r):bp(s,"updateDoc",n._key,e),pi(i,[o.toMutation(n._key,re.exists(!0))])}function Y_(n){return pi(M(n.firestore,Q),[new Tn(n._key,re.none())])}function J_(n,e){let t=M(n.firestore,Q),r=Zs(n),i=jc(n.converter,e);return pi(t,[Bc(fr(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,re.exists(!1))]).then(()=>r)}function Rp(n,...e){var t,r,i;n=N(n);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||xf(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges};if(xf(e[o])){let h=e[o];e[o]=(t=h.next)===null||t===void 0?void 0:t.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(i=h.complete)===null||i===void 0?void 0:i.bind(h)}let c,u,l;if(n instanceof G)u=M(n.firestore,Q),l=ui(n._key.path),c={next:h=>{e[o]&&e[o](xp(u,n,h))},error:e[o+1],complete:e[o+2]};else{let h=M(n,Se);u=M(h.firestore,Q),l=h._query;let d=new jt(u);c={next:m=>{e[o]&&e[o](new at(u,d,h,m))},error:e[o+1],complete:e[o+2]},x_(n._query)}return function(h,d,m,w){let T=new si(w),S=new js(d,T,m);return h.asyncQueue.enqueueAndForget(async()=>ap(await oi(h),S)),()=>{T.Dc(),h.asyncQueue.enqueueAndForget(async()=>cp(await oi(h),S))}}(pe(u),l,a,c)}function X_(n,e){return JA(pe(n=M(n,Q)),xf(e)?e:{next:e})}function pi(n,e){return function(t,r){let i=new de;return t.asyncQueue.enqueueAndForget(async()=>DA(await vp(t),r,i)),i.promise}(pe(n),e)}function xp(n,e,t){let r=t.docs.get(e._key),i=new jt(n);return new Qe(n,i,e._key,r,new Ut(t.hasPendingWrites,t.fromCache),e.converter)}var rC={maxAttempts:5};var Oc=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=fr(e)}set(e,t,r){this._verifyNotCommitted();let i=ln(e,this._firestore),s=jc(i.converter,t,r),o=Bc(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,re.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=ln(e,this._firestore),o;return o=typeof(t=N(t))=="string"||t instanceof ot?Sp(this._dataReader,"WriteBatch.update",s._key,t,r,i):bp(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,re.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=ln(e,this._firestore);return this._mutations=this._mutations.concat(new Tn(t._key,re.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new g(f.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function ln(n,e){if((n=N(n)).firestore!==e)throw new g(f.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var $f=class extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=fr(e)}get(e){let t=ln(e,this._firestore),r=new Gf(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||i.length!==1)return b();let s=i[0];if(s.isFoundDocument())return new lr(this._firestore,r,s.key,s,t.converter);if(s.isNoDocument())return new lr(this._firestore,r,t._key,null,t.converter);throw b()})}set(e,t,r){let i=ln(e,this._firestore),s=jc(i.converter,t,r),o=Bc(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,r);return this._transaction.set(i._key,o),this}update(e,t,r,...i){let s=ln(e,this._firestore),o;return o=typeof(t=N(t))=="string"||t instanceof ot?Sp(this._dataReader,"Transaction.update",s._key,t,r,i):bp(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){let t=ln(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=ln(e,this._firestore),r=new jt(this._firestore);return super.get(e).then(i=>new Qe(this._firestore,r,t._key,i._document,new Ut(!1,!1),t.converter))}};function Z_(n,e,t){n=M(n,Q);let r=Object.assign(Object.assign({},rC),t);return function(i){if(i.maxAttempts<1)throw new g(f.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,s,o){let a=new de;return i.asyncQueue.enqueueAndForget(async()=>{let c=await KA(i);new Nf(i.asyncQueue,c,o,s,a).run()}),a.promise}(pe(n),i=>e(new $f(n,i)),r)}function eI(){return new $s("deleteField")}function tI(){return new Mf("serverTimestamp")}function nI(...n){return new Ff("arrayUnion",n)}function rI(...n){return new Uf("arrayRemove",n)}function iI(n){return new Vf("increment",n)}(function(n,e=!0){(function(t){ci=t})(Je),Ye(new me("firestore",(t,{instanceIdentifier:r,options:i})=>{let s=t.getProvider("app").getImmediate(),o=new Q(new Hh(t.getProvider("auth-internal")),new Xh(t.getProvider("app-check-internal")),function(a,c){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new g(f.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new vn(a.options.projectId,c)}(s,r),s);return i=Object.assign({useFetchStreams:e},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Le(qy,"3.13.0",n),Le(qy,"3.13.0","esm2017")})();var iC="@firebase/firestore-compat",sC="0.3.12";function Up(n,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new g("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function sI(){if(typeof Uint8Array>"u")throw new g("unimplemented","Uint8Arrays are not available in this environment.")}function oI(){if(!Jv())throw new g("unimplemented","Blobs are unavailable in Firestore in this environment.")}var zc=class n{constructor(e){this._delegate=e}static fromBase64String(e){return oI(),new n(Nt.fromBase64String(e))}static fromUint8Array(e){return sI(),new n(Nt.fromUint8Array(e))}toBase64(){return oI(),this._delegate.toBase64()}toUint8Array(){return sI(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function Pp(n){return oC(n,["next","error","complete"])}function oC(n,e){if(typeof n!="object"||n===null)return!1;let t=n;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}var Op=class{enableIndexedDbPersistence(e,t){return g_(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return y_(e._delegate)}clearIndexedDbPersistence(e){return w_(e._delegate)}},Gc=class{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof vn||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&We("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,r={}){d_(this._delegate,e,t,r)}enableNetwork(){return I_(this._delegate)}disableNetwork(){return E_(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,_p("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return __(this._delegate)}onSnapshotsInSync(e){return X_(this._delegate,e)}get app(){if(!this._appCompat)throw new g("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new yi(this,Ip(this._delegate,e))}catch(t){throw Oe(t,"collection()","Firestore.collection()")}}doc(e){try{return new kt(this,Zs(this._delegate,e))}catch(t){throw Oe(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new vr(this,f_(this._delegate,e))}catch(t){throw Oe(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Z_(this._delegate,t=>e(new $c(this,t)))}batch(){return pe(this._delegate),new Kc(new Oc(this._delegate,e=>pi(this._delegate,e)))}loadBundle(e){return T_(this._delegate,e)}namedQuery(e){return b_(this._delegate,e).then(t=>t?new vr(this,t):null)}},mi=class extends ai{constructor(e){super(),this.firestore=e}convertBytes(e){return new zc(new Nt(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return kt.forKey(t,this.firestore,null)}};function aC(n){Vv(n)}var $c=class{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new mi(e)}get(e){let t=mr(e);return this._delegate.get(t).then(r=>new gr(this._firestore,new Qe(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){let i=mr(e);return r?(Up("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=mr(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=mr(e);return this._delegate.delete(t),this}},Kc=class{constructor(e){this._delegate=e}set(e,t,r){let i=mr(e);return r?(Up("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){let s=mr(e);return arguments.length===2?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){let t=mr(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}},gi=class n{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){let r=new fn(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new yr(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let r=n.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new n(e,new mi(e),t),i.set(t,s)),s}};gi.INSTANCES=new WeakMap;var kt=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new mi(e)}static forPath(e,t,r){if(e.length%2!==0)throw new g("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new n(t,new G(t._delegate,r,new _(e)))}static forKey(e,t,r){return new n(t,new G(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new yi(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new yi(this.firestore,Ip(this._delegate,e))}catch(t){throw Oe(t,"collection()","DocumentReference.collection()")}}isEqual(e){return e=N(e),e instanceof G?Ep(this._delegate,e):!1}set(e,t){t=Up("DocumentReference.set",t);try{return t?kp(this._delegate,e,t):kp(this._delegate,e)}catch(r){throw Oe(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return arguments.length===1?Dp(this._delegate,e):Dp(this._delegate,e,t,...r)}catch(i){throw Oe(i,"updateDoc()","DocumentReference.update()")}}delete(){return Y_(this._delegate)}onSnapshot(...e){let t=aI(e),r=cI(e,i=>new gr(this.firestore,new Qe(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Rp(this._delegate,t,r)}get(e){let t;return e?.source==="cache"?t=$_(this._delegate):e?.source==="server"?t=K_(this._delegate):t=G_(this._delegate),t.then(r=>new gr(this.firestore,new Qe(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(gi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Oe(n,e,t){return n.message=n.message.replace(e,t),n}function aI(n){for(let e of n)if(typeof e=="object"&&!Pp(e))return e;return{}}function cI(n,e){var t,r;let i;return Pp(n[0])?i=n[0]:Pp(n[1])?i=n[1]:typeof n[0]=="function"?i={next:n[0],error:n[1],complete:n[2]}:i={next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:(t=i.error)===null||t===void 0?void 0:t.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var gr=class{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new kt(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Np(this._delegate,e._delegate)}},yr=class extends gr{data(e){let t=this._delegate.data(e);return Bv(t!==void 0,"Document in a QueryDocumentSnapshot should exist"),t}},vr=class n{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new mi(e)}where(e,t,r){try{return new n(this.firestore,Gt(this._delegate,P_(e,t,r)))}catch(i){throw Oe(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new n(this.firestore,Gt(this._delegate,O_(e,t)))}catch(r){throw Oe(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new n(this.firestore,Gt(this._delegate,L_(e)))}catch(t){throw Oe(t,"limit()","Query.limit()")}}limitToLast(e){try{return new n(this.firestore,Gt(this._delegate,M_(e)))}catch(t){throw Oe(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new n(this.firestore,Gt(this._delegate,F_(...e)))}catch(t){throw Oe(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new n(this.firestore,Gt(this._delegate,U_(...e)))}catch(t){throw Oe(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new n(this.firestore,Gt(this._delegate,V_(...e)))}catch(t){throw Oe(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new n(this.firestore,Gt(this._delegate,B_(...e)))}catch(t){throw Oe(t,"endAt()","Query.endAt()")}}isEqual(e){return Tp(this._delegate,e._delegate)}get(e){let t;return e?.source==="cache"?t=H_(this._delegate):e?.source==="server"?t=Q_(this._delegate):t=W_(this._delegate),t.then(r=>new eo(this.firestore,new at(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let t=aI(e),r=cI(e,i=>new eo(this.firestore,new at(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Rp(this._delegate,t,r)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(gi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},Lp=class{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new yr(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},eo=class{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new vr(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new yr(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Lp(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new yr(this._firestore,r))})}isEqual(e){return Np(this._delegate,e._delegate)}},yi=class n extends vr{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new kt(this.firestore,e):null}doc(e){try{return e===void 0?new kt(this.firestore,Zs(this._delegate)):new kt(this.firestore,Zs(this._delegate,e))}catch(t){throw Oe(t,"doc()","CollectionReference.doc()")}}add(e){return J_(this._delegate,e).then(t=>new kt(this.firestore,t))}isEqual(e){return Ep(this._delegate,e._delegate)}withConverter(e){return new n(this.firestore,e?this._delegate.withConverter(gi.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function mr(n){return M(n,G)}var Mp=class n{constructor(...e){this._delegate=new ot(...e)}static documentId(){return new n(we.keyField().canonicalString())}isEqual(e){return e=N(e),e instanceof ot?this._delegate._internalPath.isEqual(e._internalPath):!1}};var Fp=class n{constructor(e){this._delegate=e}static serverTimestamp(){let e=tI();return e._methodName="FieldValue.serverTimestamp",new n(e)}static delete(){let e=eI();return e._methodName="FieldValue.delete",new n(e)}static arrayUnion(...e){let t=nI(...e);return t._methodName="FieldValue.arrayUnion",new n(t)}static arrayRemove(...e){let t=rI(...e);return t._methodName="FieldValue.arrayRemove",new n(t)}static increment(e){let t=iI(e);return t._methodName="FieldValue.increment",new n(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var cC={Firestore:Gc,GeoPoint:ur,Timestamp:X,Blob:zc,Transaction:$c,WriteBatch:Kc,DocumentReference:kt,DocumentSnapshot:gr,Query:vr,QueryDocumentSnapshot:yr,QuerySnapshot:eo,CollectionReference:yi,FieldPath:Mp,FieldValue:Fp,setLogLevel:aC,CACHE_SIZE_UNLIMITED:p_};function uC(n,e){n.INTERNAL.registerComponent(new me("firestore-compat",t=>{let r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},cC)))}function lC(n){uC(n,(e,t)=>new Gc(e,t,new Op)),n.registerVersion(iC,sC)}lC(Ve);typeof window<"u"&&(window.firebase=Ve);typeof globalThis<"u"&&(globalThis.firebase=Ve);var hC=Ve;return pI(dC);})();
/*! Bundled license information:

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/component/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/logger/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app-compat/dist/esm/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

firebase/compat/app/dist/esm/index.esm.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e3d5d3f4.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e3d5d3f4.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e3d5d3f4.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e3d5d3f4.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e3d5d3f4.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e3d5d3f4.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/index-e3d5d3f4.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm2017/internal.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth-compat/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
  * @license
  * Copyright 2017 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore-compat/dist/index.esm2017.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
*/
